Index: lib/choose_vehicle/choose_vehicle_widget.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/backend/api_requests/api_calls.dart';\nimport '/config.dart' as app_config;\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/index.dart';\nimport 'package:flutter/material.dart';\nimport 'package:google_fonts/google_fonts.dart';\n\nimport 'choose_vehicle_model.dart';\nexport 'choose_vehicle_model.dart';\n\n// âœ… Ensure OnBoardingWidget is accessible\n\nclass ChooseVehicleWidget extends StatefulWidget {\n  const ChooseVehicleWidget({\n    super.key,\n    this.mobile,\n    this.firstname,\n    this.lastname,\n    this.email,\n    this.referalcode,\n  });\n\n  final int? mobile;\n  final String? firstname;\n  final String? lastname;\n  final String? email;\n  final String? referalcode;\n\n  static String routeName = 'Choose_vehicle';\n  static String routePath = '/chooseVehicle';\n\n  @override\n  State<ChooseVehicleWidget> createState() => _ChooseVehicleWidgetState();\n}\n\nclass _ChooseVehicleWidgetState extends State<ChooseVehicleWidget> {\n  late ChooseVehicleModel _model;\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => ChooseVehicleModel());\n  }\n\n  @override\n  void dispose() {\n    _model.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    // \uD83C\uDFA8 APP COLORS\n    const Color brandPrimary = AppColors.primary;\n    const Color brandGradientStart = AppColors.primaryGradientStart;\n    const Color bgOffWhite = AppColors.backgroundAlt;\n\n    return GestureDetector(\n      onTap: () {\n        FocusScope.of(context).unfocus();\n        FocusManager.instance.primaryFocus?.unfocus();\n      },\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: bgOffWhite,\n        body: Column(\n          children: [\n            // ==========================================\n            // 1\uFE0Fâƒ£ VIBRANT HEADER\n            // ==========================================\n            Container(\n              height: 180, // Compact header\n              width: double.infinity,\n              decoration: const BoxDecoration(\n                gradient: LinearGradient(\n                  colors: [brandGradientStart, brandPrimary],\n                  begin: Alignment.topLeft,\n                  end: Alignment.bottomRight,\n                ),\n                borderRadius: BorderRadius.only(\n                  bottomLeft: Radius.circular(30),\n                  bottomRight: Radius.circular(30),\n                ),\n                boxShadow: [\n                  BoxShadow(\n                    color: Colors.black12,\n                    blurRadius: 8,\n                    offset: Offset(0, 4),\n                  )\n                ],\n              ),\n              child: const SafeArea(\n                child: Padding(\n                  padding: EdgeInsets.symmetric(horizontal: 24.0),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      SizedBox(height: 16),\n                      Spacer(),\n                      Center(\n                        child: Text(\n                          'Vehicle Type',\n                          style: TextStyle(\n                            fontSize: 28,\n                            color: Colors.white70,\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                      ),\n                      SizedBox(height: 4),\n                      Text(\n                        'How do you want to earn?',\n                        style: TextStyle(\n                          fontSize: 28,\n                          color: Colors.white,\n                          fontWeight: FontWeight.w600,\n                          height: 1.1,\n                        ),\n                      ),\n                      SizedBox(height: 30),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n\n            // ==========================================\n            // 2\uFE0Fâƒ£ VEHICLE LIST (Floating)\n            // ==========================================\n            Expanded(\n              child: Transform.translate(\n                offset: const Offset(0, -20),\n                child: Container(\n                  width: double.infinity,\n                  margin: const EdgeInsets.symmetric(horizontal: 16),\n                  decoration: BoxDecoration(\n                    color: Colors.white,\n                    borderRadius: BorderRadius.circular(24),\n                    boxShadow: [\n                      BoxShadow(\n                        color: Colors.black.withValues(alpha:0.05),\n                        blurRadius: 15,\n                        offset: const Offset(0, 5),\n                      )\n                    ],\n                  ),\n                  child: FutureBuilder<ApiCallResponse>(\n                    future: ChoosevehicleCall.call(),\n                    builder: (context, snapshot) {\n                      // LOADING\n                      if (!snapshot.hasData) {\n                        return const Center(\n                          child: CircularProgressIndicator(\n                            valueColor: AlwaysStoppedAnimation<Color>(brandPrimary),\n                          ),\n                        );\n                      }\n\n                      // ERROR\n                      if (snapshot.hasError ||\n                          snapshot.data?.statusCode != 200) {\n                        return _buildErrorState(brandPrimary);\n                      }\n\n                      final response = snapshot.data!;\n                      return Builder(\n                        builder: (context) {\n                          final rawList = ChoosevehicleCall.data(response.jsonBody);\n                          final vehicleList = (rawList is List) ? rawList : [];\n\n                          if (vehicleList.isEmpty) {\n                            return Center(\n                              child: Text(\n                                'No vehicles available',\n                                style: GoogleFonts.inter(color: Colors.grey),\n                              ),\n                            );\n                          }\n\n                          return ListView.separated(\n                            padding: const EdgeInsets.all(20),\n                            itemCount: vehicleList.length,\n                            separatorBuilder: (_, __) =>\n                            const SizedBox(height: 16),\n                            itemBuilder: (context, index) {\n                              final item = vehicleList[index];\n\n                              // Safe Name and ID extraction\n                              String vehicleName = '';\n                              int vehicleId = 0;\n                              String? imagePath;\n                              if (item is Map) {\n                                vehicleName = item['name']?.toString() ?? '';\n                                vehicleId = castToType<int>(item['id']) ?? 0;\n                                imagePath = item['image']?.toString();\n                              } else {\n                                vehicleName = getJsonField(item, r'$[\"name\"]')?.toString() ?? '';\n                                vehicleId = castToType<int>(getJsonField(item, r'$[\"id\"]')) ?? 0;\n                                imagePath = getJsonField(item, r'$[\"image\"]')?.toString();\n                              }\n\n                              if (vehicleName.isEmpty) vehicleName = 'Unknown';\n\n                              // Build full image URL (API returns relative path like /uploads/...)\n                              final imageUrl = (imagePath != null &&\n                                      imagePath.isNotEmpty &&\n                                      imagePath != 'null')\n                                  ? (imagePath.startsWith('http')\n                                      ? imagePath\n                                      : '${app_config.Config.baseUrl}$imagePath')\n                                  : null;\n\n                              final isSelected =\n                                  FFAppState().selectvehicle == vehicleName;\n\n                              return _buildVehicleCard(\n                                vehicleName,\n                                vehicleId,\n                                imageUrl,\n                                isSelected,\n                                brandPrimary,\n                              );\n                            },\n                          );\n                        },\n                      );\n                    },\n                  ),\n                ),\n              ),\n            ),\n\n            // ==========================================\n            // 3\uFE0Fâƒ£ CONTINUE BUTTON (Fixed Bottom)\n            // ==========================================\n            Container(\n              padding: const EdgeInsets.all(24),\n              decoration: BoxDecoration(\n                color: Colors.white,\n                boxShadow: [\n                  BoxShadow(\n                    color: Colors.black.withValues(alpha:0.05),\n                    blurRadius: 10,\n                    offset: const Offset(0, -5),\n                  )\n                ],\n              ),\n              child: SizedBox(\n                width: double.infinity,\n                height: 56,\n                child: ElevatedButton(\n                  onPressed: FFAppState().selectvehicle.isEmpty\n                      ? null\n                      : () {\n                    context.pushNamed(\n                      OnBoardingWidget.routeName,\n                      queryParameters: {\n                        'mobile': serializeParam(\n                            widget.mobile, ParamType.int),\n                        'firstname': serializeParam(\n                            widget.firstname, ParamType.String),\n                        'lastname': serializeParam(\n                            widget.lastname, ParamType.String),\n                        'email': serializeParam(\n                            widget.email, ParamType.String),\n                        'referalcode': serializeParam(\n                            widget.referalcode, ParamType.String),\n                        'vehicletype': serializeParam(\n                            FFAppState().selectvehicle, ParamType.String),\n                      }.withoutNulls,\n                    );\n                  },\n                  style: ElevatedButton.styleFrom(\n                    backgroundColor: brandPrimary,\n                    foregroundColor: Colors.white,\n                    elevation: 2,\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(16),\n                    ),\n                    disabledBackgroundColor: Colors.grey[300],\n                  ),\n                  child: Text(\n                    'Continue',\n                    style: GoogleFonts.interTight(\n                      fontSize: 18,\n                      fontWeight: FontWeight.bold,\n                      letterSpacing: 0.5,\n                    ),\n                  ),\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  // \uD83D\uDD39 Custom Vehicle Card Widget\n  Widget _buildVehicleCard(String name, int vehicleId, String? imageUrl, bool isSelected, Color brandColor) {\n    return InkWell(\n      onTap: () {\n        setState(() {\n          FFAppState().selectvehicle = name;\n          FFAppState().adminVehicleId = vehicleId;\n        });\n      },\n      borderRadius: BorderRadius.circular(16),\n      child: Container(\n        padding: const EdgeInsets.all(16),\n        decoration: BoxDecoration(\n          color: isSelected ? brandColor.withValues(alpha:0.08) : Colors.white,\n          borderRadius: BorderRadius.circular(16),\n          border: Border.all(\n            color: isSelected ? brandColor : Colors.grey.shade200,\n            width: isSelected ? 2 : 1.5,\n          ),\n        ),\n        child: Row(\n          children: [\n            // Image or Icon Box\n            ClipRRect(\n              borderRadius: BorderRadius.circular(12),\n              child: Container(\n                width: 56,\n                height: 56,\n                decoration: BoxDecoration(\n                  color: isSelected ? brandColor.withValues(alpha:0.2) : Colors.grey.shade100,\n                  borderRadius: BorderRadius.circular(12),\n                ),\n              child: imageUrl != null\n                  ? Image.network(\n                      imageUrl,\n                      fit: BoxFit.cover,\n                      errorBuilder: (_, __, ___) => Icon(\n                        _getVehicleIcon(name),\n                        size: 32,\n                        color: isSelected ? brandColor : Colors.grey.shade500,\n                      ),\n                    )\n                  : Icon(\n                      _getVehicleIcon(name),\n                      size: 32,\n                      color: isSelected ? brandColor : Colors.grey.shade500,\n                    ),\n              ),\n            ),\n            const SizedBox(width: 16),\n\n            // Name\n            Expanded(\n              child: Text(\n                name.toUpperCase(),\n                style: GoogleFonts.inter(\n                  fontSize: 16,\n                  fontWeight: isSelected ? FontWeight.bold : FontWeight.w600,\n                  color: isSelected ? Colors.black87 : Colors.grey.shade700,\n                ),\n              ),\n            ),\n\n            // Checkmark\n            if (isSelected)\n              Icon(Icons.check_circle, color: brandColor, size: 28)\n            else\n              Icon(Icons.radio_button_unchecked, color: Colors.grey.shade300, size: 28),\n          ],\n        ),\n      ),\n    );\n  }\n\n  // \uD83D\uDD39 Error State Widget\n  Widget _buildErrorState(Color color) {\n    return Center(\n      child: Column(\n        mainAxisAlignment: MainAxisAlignment.center,\n        children: [\n          Icon(Icons.cloud_off, size: 48, color: Colors.grey[400]),\n          const SizedBox(height: 16),\n          Text(\n            'Failed to load vehicles',\n            style: GoogleFonts.inter(color: Colors.grey[600]),\n          ),\n          const SizedBox(height: 16),\n          TextButton(\n            onPressed: () => setState(() {}),\n            child: Text(\n              'Retry',\n              style: TextStyle(color: color, fontWeight: FontWeight.bold),\n            ),\n          )\n        ],\n      ),\n    );\n  }\n\n  // \uD83D\uDD39 Icon Mapping Logic\n  IconData _getVehicleIcon(String vehicleName) {\n    final name = vehicleName.toLowerCase();\n    if (name.contains('auto')) return Icons.local_taxi; // Or use FontAwesomeIcons.taxi\n    if (name.contains('bike') || name.contains('motorcycle')) return Icons.two_wheeler;\n    if (name.contains('car') || name.contains('sedan') || name.contains('suv')) return Icons.directions_car;\n    if (name.contains('truck')) return Icons.local_shipping;\n    return Icons.directions_car_rounded;\n  }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/choose_vehicle/choose_vehicle_widget.dart b/lib/choose_vehicle/choose_vehicle_widget.dart
--- a/lib/choose_vehicle/choose_vehicle_widget.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/choose_vehicle/choose_vehicle_widget.dart	(date 1771590977860)
@@ -1,5 +1,6 @@
 import '/backend/api_requests/api_calls.dart';
 import '/config.dart' as app_config;
+import '/constants/app_colors.dart';
 import '/flutter_flow/flutter_flow_util.dart';
 import '/index.dart';
 import 'package:flutter/material.dart';
@@ -51,7 +52,6 @@
 
   @override
   Widget build(BuildContext context) {
-    // ðŸŽ¨ APP COLORS
     const Color brandPrimary = AppColors.primary;
     const Color brandGradientStart = AppColors.primaryGradientStart;
     const Color bgOffWhite = AppColors.backgroundAlt;
@@ -297,74 +297,72 @@
     );
   }
 
-  // ðŸ”¹ Custom Vehicle Card Widget
+  // Uber-style vehicle type card (matches vehicle details screen)
   Widget _buildVehicleCard(String name, int vehicleId, String? imageUrl, bool isSelected, Color brandColor) {
     return InkWell(
       onTap: () {
         setState(() {
           FFAppState().selectvehicle = name;
           FFAppState().adminVehicleId = vehicleId;
+          FFAppState().vehicleType = name;
+          FFAppState().update(() {});
         });
       },
       borderRadius: BorderRadius.circular(16),
       child: Container(
         padding: const EdgeInsets.all(16),
         decoration: BoxDecoration(
-          color: isSelected ? brandColor.withValues(alpha:0.08) : Colors.white,
+          color: isSelected ? brandColor.withValues(alpha: 0.08) : Colors.white,
           borderRadius: BorderRadius.circular(16),
           border: Border.all(
-            color: isSelected ? brandColor : Colors.grey.shade200,
+            color: isSelected ? brandColor : AppColors.greyBorder,
             width: isSelected ? 2 : 1.5,
           ),
         ),
         child: Row(
           children: [
-            // Image or Icon Box
             ClipRRect(
               borderRadius: BorderRadius.circular(12),
               child: Container(
                 width: 56,
                 height: 56,
                 decoration: BoxDecoration(
-                  color: isSelected ? brandColor.withValues(alpha:0.2) : Colors.grey.shade100,
+                  color: isSelected ? brandColor.withValues(alpha: 0.2) : Colors.grey.shade100,
                   borderRadius: BorderRadius.circular(12),
                 ),
-              child: imageUrl != null
-                  ? Image.network(
-                      imageUrl,
-                      fit: BoxFit.cover,
-                      errorBuilder: (_, __, ___) => Icon(
-                        _getVehicleIcon(name),
-                        size: 32,
-                        color: isSelected ? brandColor : Colors.grey.shade500,
-                      ),
-                    )
-                  : Icon(
-                      _getVehicleIcon(name),
-                      size: 32,
-                      color: isSelected ? brandColor : Colors.grey.shade500,
-                    ),
+                child: imageUrl != null
+                    ? Image.network(
+                        imageUrl,
+                        fit: BoxFit.cover,
+                        errorBuilder: (_, __, ___) => Icon(
+                          _getVehicleIcon(name),
+                          size: 28,
+                          color: isSelected ? brandColor : Colors.grey.shade500,
+                        ),
+                      )
+                    : Icon(
+                        _getVehicleIcon(name),
+                        size: 28,
+                        color: isSelected ? brandColor : Colors.grey.shade500,
+                      ),
               ),
             ),
             const SizedBox(width: 16),
-
-            // Name
             Expanded(
               child: Text(
-                name.toUpperCase(),
+                name,
                 style: GoogleFonts.inter(
                   fontSize: 16,
                   fontWeight: isSelected ? FontWeight.bold : FontWeight.w600,
-                  color: isSelected ? Colors.black87 : Colors.grey.shade700,
+                  color: isSelected ? AppColors.textDark : Colors.grey.shade700,
                 ),
               ),
             ),
-
-            // Checkmark
-            if (isSelected)
-              Icon(Icons.check_circle, color: brandColor, size: 28)
-            else
-              Icon(Icons.radio_button_unchecked, color: Colors.grey.shade300, size: 28),
+            Icon(
+              isSelected ? Icons.check_circle : Icons.radio_button_unchecked,
+              color: isSelected ? brandColor : Colors.grey.shade300,
+              size: 26,
+            ),
           ],
         ),
       ),
Index: lib/backend/api_requests/api_calls.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import 'dart:convert';\nimport 'package:flutter/foundation.dart';\n\nimport '/flutter_flow/flutter_flow_util.dart';\nimport 'api_manager.dart';\nimport '../../config.dart';\n\nexport 'api_manager.dart' show ApiCallResponse;\n\n// \uD83C\uDF10 API Base URL Configuration (dynamic via dart-define or config)\nString get _baseUrl => Config.baseUrl;\n\nclass LoginCall {\n  static Future<ApiCallResponse> call({\n    int? mobile,\n    String? fcmToken,\n  }) async {\n    final body = <String, dynamic>{\n      'mobile_number': mobile?.toString() ?? '',\n      if (fcmToken != null && fcmToken.isNotEmpty) 'fcm_token': fcmToken,\n    };\n    final ffApiRequestBody = json.encode(body);\n    return ApiManager.instance.makeApiCall(\n      callName: 'login',\n      apiUrl: '$_baseUrl/api/drivers/login',\n      callType: ApiCallType.POST,\n      headers: {},\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static dynamic vehicleimage(dynamic response) => getJsonField(\n        response,\n        r'''$.data[*].vehicle_images''',\n      );\n  static dynamic id(dynamic response) => getJsonField(\n        response,\n        r'''$.data[*].id''',\n      );\n  static dynamic type(dynamic response) => getJsonField(\n        response,\n        r'''$.data[*].vehicle_type''',\n      );\n  static dynamic vehiclename(dynamic response) => getJsonField(\n        response,\n        r'''$.data[*].vehicle_name''',\n      );\n}\n\nclass ChoosevehicleCall {\n  static Future<ApiCallResponse> call() async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'choosevehicle',\n      apiUrl: '$_baseUrl/api/vehicle-types/getall-vehicle',\n      callType: ApiCallType.GET,\n      headers: {}, // âœ… Clear that no auth needed\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  // Keep all your existing response parsers\n  static List<dynamic>? data(dynamic response) => getJsonField(\n        response,\n        r'$.data',\n        true,\n      ) as List?;\n\n  static List<String>? vehiclename(dynamic response) => (getJsonField(\n        response,\n        r'$.data[:].name',\n        true,\n      ) as List?)\n          ?.withoutNulls\n          .map((x) => castToType<String>(x))\n          .withoutNulls\n          .toList();\n\n  static List<int>? vehicleId(dynamic response) => (getJsonField(\n        response,\n        r'$.data[:].id',\n        true,\n      ) as List?)\n          ?.withoutNulls\n          .map((x) => castToType<int>(x))\n          .withoutNulls\n          .toList();\n\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static List<String>? createdAt(dynamic response) => (getJsonField(\n        response,\n        r'$.data[:].createdAt',\n        true,\n      ) as List?)\n          ?.withoutNulls\n          .map((x) => castToType<String>(x))\n          .withoutNulls\n          .toList();\n\n  static List<String>? updatedAt(dynamic response) => (getJsonField(\n        response,\n        r'$.data[:].updatedAt',\n        true,\n      ) as List?)\n          ?.withoutNulls\n          .map((x) => castToType<String>(x))\n          .withoutNulls\n          .toList();\n}\n\n/// Get all drivers - used for showing available captains (like Rapido).\n/// Filters by is_online & is_active for \"available drivers\".\nclass GetAllDriversCall {\n  static Future<ApiCallResponse> call({String? token}) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'getAllDrivers',\n      apiUrl: '$_baseUrl/api/drivers/getall',\n      callType: ApiCallType.GET,\n      headers: {\n        if (token != null && token.isNotEmpty) 'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static List<dynamic>? data(dynamic response) =>\n      getJsonField(response, r'$.data', true) as List?;\n\n  static bool? success(dynamic response) =>\n      castToType<bool>(getJsonField(response, r'$.success'));\n\n  /// Returns drivers that are online and active (available for rides)\n  static List<dynamic> availableDrivers(dynamic response) {\n    final list = data(response) ?? [];\n    return list\n        .where((d) =>\n            (d is Map && d['is_online'] == true && d['is_active'] == true))\n        .toList();\n  }\n}\n\nclass CreateDriverCall {\n  static Future<ApiCallResponse> call({\n    FFUploadedFile? profileimage,\n    FFUploadedFile? licenseimage,\n    FFUploadedFile? licenseFrontImage,\n    FFUploadedFile? licenseBackImage,\n    FFUploadedFile? aadhaarimage,\n    FFUploadedFile? aadhaarFrontImage,\n    FFUploadedFile? aadhaarBackImage,\n    FFUploadedFile? panimage,\n    FFUploadedFile? rcFrontImage,\n    FFUploadedFile? rcBackImage,\n    dynamic driverJson,\n    dynamic vehicleJson,\n    FFUploadedFile? vehicleImage,\n    FFUploadedFile? registrationImage,\n    FFUploadedFile? insuranceImage,\n    FFUploadedFile? pollutionCertificateImage,\n    String? fcmToken = '',\n  }) async {\n    final driver = _serializeJson(driverJson);\n\n    final vehicle = _serializeJson(vehicleJson);\n\n    // Do not log request body - may contain PII (driver, vehicle, tokens)\n    return ApiManager.instance.makeApiCall(\n      callName: 'createDriver',\n      apiUrl: '$_baseUrl/api/drivers/signup-with-vehicle',\n      callType: ApiCallType.POST,\n      headers: {},\n      params: {\n        'profile_image': profileimage,\n        'license_image': licenseimage,\n        'license_front_image': licenseFrontImage,\n        'license_back_image': licenseBackImage,\n        'aadhaar_image': aadhaarimage,\n        'aadhaar_front_image': aadhaarFrontImage,\n        'aadhaar_back_image': aadhaarBackImage,\n        'pan_image': panimage,\n        'rc_front_image': rcFrontImage,\n        'rc_back_image': rcBackImage,\n        'driver': driver,\n        'vehicle': vehicle,\n        'vehicle_image': vehicleImage,\n        'registration_image': registrationImage,\n        'insurance_image': insuranceImage,\n        'pollution_certificate_image': pollutionCertificateImage,\n        'fcm_token': fcmToken,\n      },\n      bodyType: BodyType.MULTIPART,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.message''',\n      ));\n}\n\nclass DeleteDriverCall {\n  static Future<ApiCallResponse> call({\n    required String token,\n    required int id,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'deleteDriver',\n      apiUrl: '$_baseUrl/api/drivers/$id',\n      callType: ApiCallType.DELETE,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n}\n\nclass CancelRideCall {\n  static Future<ApiCallResponse> call({\n    required int rideId,\n    String? cancellationReason,\n    String? token = '',\n    String? cancelledBy = 'driver',\n  }) async {\n    final ffApiRequestBody = '''\n{\n  \"ride_id\": $rideId,\n  \"cancellation_reason\": \"${escapeStringForJson(cancellationReason ?? '')}\",\n  \"cancelled_by\": \"${escapeStringForJson(cancelledBy ?? 'driver')}\"\n}''';\n    return ApiManager.instance.makeApiCall(\n      callName: 'cancelRide',\n      apiUrl: '$_baseUrl/api/rides/rides/cancel',\n      callType: ApiCallType.PATCH,\n      headers: {\n        'Authorization': 'Bearer $token',\n        'Content-Type': 'application/json',\n      },\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static bool? success(dynamic response) =>\n      castToType<bool>(getJsonField(response, r'$.success'));\n  static String? message(dynamic response) =>\n      castToType<String>(getJsonField(response, r'$.message'));\n}\n\nclass CompleteRideCall {\n  static Future<ApiCallResponse> call({\n    required int rideId,\n    required int driverId,\n    required int userId,\n    String? token = '',\n  }) async {\n    final ffApiRequestBody = '''\n{\n  \"ride_id\": $rideId,\n  \"driver_id\": $driverId,\n  \"user_id\": $userId\n}''';\n    return ApiManager.instance.makeApiCall(\n      callName: 'completeRide',\n      apiUrl: '$_baseUrl/api/drivers/complete-ride',\n      callType: ApiCallType.POST,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.message''',\n      ));\n  static dynamic data(dynamic response) => getJsonField(response, r'$.data');\n  static double? finalFare(dynamic response) {\n    final d = data(response);\n    if (d is Map) {\n      final v = d['final_fare'] ?? d['ride_amount'] ?? d['amount'] ?? d['fare'];\n      if (v != null && v is num) return v.toDouble();\n      if (v is String) return double.tryParse(v);\n    }\n    return null;\n  }\n  static String? paymentMode(dynamic response) {\n    final d = data(response);\n    if (d is Map) {\n      final v = d['payment_mode'] ?? d['payment_method'] ?? d['payment_type'];\n      return v?.toString();\n    }\n    return null;\n  }\n}\n\nclass UpdateDriverCall {\n  static Future<ApiCallResponse> call({\n    int? id,\n    String? token = '',\n    bool? isonline,\n    double? latitude,\n    double? longitude,\n    String? fcmToken,\n    String? firstName,\n    String? lastName,\n    FFUploadedFile? profileimage,\n    FFUploadedFile? licenseimage,\n    FFUploadedFile? licenseFrontImage,\n    FFUploadedFile? licenseBackImage,\n    FFUploadedFile? aadhaarimage,\n    FFUploadedFile? panimage,\n    FFUploadedFile? vehicleImage,\n    FFUploadedFile? registrationImage,\n    FFUploadedFile? insuranceImage,\n    FFUploadedFile? pollutionCertificateImage,\n    \n  }) async {\n    // Build params dynamically - only include non-null values\n    final Map<String, dynamic> params = {};\n\n    // âœ… CRITICAL FIX: Backend expects \"is_online\" not \"isonline\"\n    if (isonline != null) {\n      params['is_online'] = isonline; // Changed from 'isonline' to 'is_online'\n    }\n\n    if (latitude != null) {\n      params['current_location_latitude'] = latitude.toString();\n    }\n\n    if (longitude != null) {\n      params['current_location_longitude'] = longitude.toString();\n    }\n\n    if (fcmToken != null && fcmToken.isNotEmpty) {\n      params['fcm_token'] = fcmToken;\n    }\n    \n    if (profileimage != null) {\n      params['profile_image'] = profileimage;\n    }\n    \n    if (firstName != null) {\n      params['first_name'] = firstName;\n    }\n    \n    if (lastName != null) {\n      params['last_name'] = lastName;\n    }\n    \n    // if (email != null) {\n    //   params['email'] = email;\n    // }\n\n    if (licenseimage != null) {\n      params['license_image'] = licenseimage;\n    }\n    if (licenseFrontImage != null) {\n      params['license_front_image'] = licenseFrontImage;\n    }\n    if (licenseBackImage != null) {\n      params['license_back_image'] = licenseBackImage;\n    }\n\n    if (aadhaarimage != null) {\n      params['aadhaar_image'] = aadhaarimage;\n    }\n\n    if (panimage != null) {\n      params['pan_image'] = panimage;\n    }\n\n    if (vehicleImage != null) {\n      params['vehicle_image'] = vehicleImage;\n    }\n\n    if (registrationImage != null) {\n      params['registration_image'] = registrationImage;\n    }\n\n    if (insuranceImage != null) {\n      params['insurance_image'] = insuranceImage;\n    }\n\n    if (pollutionCertificateImage != null) {\n      params['pollution_certificate_image'] = pollutionCertificateImage;\n    }\n\n    print('\uD83D\uDE80 UpdateDriver API Request:');\n    print('   URL: $_baseUrl/api/drivers/$id');\n    print('   Token: ${token?.substring(0, 20)}...');\n    print('   Params: $params');\n\n    final response = await ApiManager.instance.makeApiCall(\n      callName: 'updateDriver',\n      apiUrl: '$_baseUrl/api/drivers/$id',\n      callType: ApiCallType.PUT,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: params,\n      bodyType: BodyType.MULTIPART,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n\n    return response;\n  }\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.message''',\n      ));\n\n  static bool? isOnline(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'''$.data.is_online''',\n      ));\n}\n\nclass DriverIdfetchCall {\n  static Future<ApiCallResponse> call({\n    String? token = '',\n    int? id,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'driverIdfetch',\n      apiUrl: '$_baseUrl/api/drivers/$id',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static bool? isonline(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'''$.data.is_online''',\n      ));\n  static String? kycstatus(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.kyc_status''',\n      ));\n  static dynamic driverData(dynamic response) => getJsonField(\n        response,\n        r'''$.data''',\n      );\n  static String? referralCode(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.referral_code''',\n      ));\n\n  /// Get profile image URL\n  static String? profileImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.profile_image''',\n      ));\n\n  /// Get license image URL (legacy; prefer licenseFrontImage/licenseBackImage)\n  static String? licenseImage(dynamic response) {\n    final v = castToType<String>(getJsonField(response, r'''$.data.license_image'''));\n    if (v != null && v.isNotEmpty) return v;\n    return castToType<String>(getJsonField(response, r'''$.data.license_front_image'''));\n  }\n\n  /// Get license front image URL\n  static String? licenseFrontImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.license_front_image''',\n      ));\n\n  /// Get license back image URL\n  static String? licenseBackImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.license_back_image''',\n      ));\n\n  /// Get license number\n  static String? licenseNumber(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.license_number''',\n      ));\n\n  /// Get license expiry date\n  static String? licenseExpiryDate(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.license_expiry_date''',\n      ));\n\n  /// Get aadhaar image URL (legacy; prefer aadhaarFrontImage/aadhaarBackImage)\n  static String? aadhaarImage(dynamic response) {\n    final v = castToType<String>(getJsonField(response, r'''$.data.aadhaar_image'''));\n    if (v != null && v.isNotEmpty) return v;\n    return castToType<String>(getJsonField(response, r'''$.data.aadhaar_front_image'''));\n  }\n\n  /// Get aadhaar front image URL\n  static String? aadhaarFrontImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.aadhaar_front_image''',\n      ));\n\n  /// Get aadhaar back image URL\n  static String? aadhaarBackImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.aadhaar_back_image''',\n      ));\n\n  /// Get PAN image URL\n  static String? panImage(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.pan_image''',\n      ));\n\n  /// Get vehicle image URL\n  static String? vehicleImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.vehicle_image''',\n      ));\n\n  /// Get RC image URL (legacy; prefer rcFrontImage/rcBackImage)\n  static String? rcImage(dynamic response) {\n    final v = castToType<String>(getJsonField(response, r'''$.data.rc_image'''));\n    if (v != null && v.isNotEmpty) return v;\n    return castToType<String>(getJsonField(response, r'''$.data.rc_front_image'''));\n  }\n\n  /// Get RC front image URL\n  static String? rcFrontImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.rc_front_image''',\n      ));\n\n  /// Get RC back image URL\n  static String? rcBackImage(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.rc_back_image''',\n      ));\n\n  /// Get address proof image URL\n  static String? addressProof(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.address_proof''',\n      ));\n\n  /// Get driver first name\n  static String? firstName(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.first_name''',\n      ));\n\n  /// Get driver last name\n  static String? lastName(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.last_name''',\n      ));\n\n  /// Get driver email\n  static String? email(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.email''',\n      ));\n\n  /// Get driver mobile number\n  static String? mobileNumber(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.mobile_number''',\n      ));\n\n  /// Get wallet balance\n  static String? walletBalance(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.wallet_balance''',\n      ));\n\n  /// Get driver rating\n  static String? driverRating(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.driver_rating''',\n      ));\n\n  /// Get total rides completed\n  static int? totalRidesCompleted(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'''$.data.total_rides_completed''',\n      ));\n\n  /// Get total earnings\n  static String? totalEarnings(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.total_earnings''',\n      ));\n\n  /// Check if driver is active\n  static bool? isActive(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'''$.data.is_active''',\n      ));\n\n  /// Get account status\n  static String? accountStatus(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.account_status''',\n      ));\n}\n\nclass GetWalletCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    required String token,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'getWallet',\n      apiUrl: '$_baseUrl/api/wallets/driver/$driverId',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static dynamic data(dynamic response) => getJsonField(\n        response,\n        r'''$.data''',\n      );\n\n  static dynamic walletBalance(dynamic response) => getJsonField(\n        response,\n        r'''$.data.wallet_balance''',\n      );\n}\n\nclass PostQRcodeCall {\n  static Future<ApiCallResponse> call({\n    int? driverId,\n    String? token = '',\n  }) async {\n    final ffApiRequestBody = '''\n{\n  \"driver_id\":$driverId\n}''';\n    return ApiManager.instance.makeApiCall(\n      callName: 'postQRcode',\n      apiUrl: '$_baseUrl/api/qr-codes/generate',\n      callType: ApiCallType.POST,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static String? qrimage(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'''$.data.qr_code_image''',\n      ));\n}\n\nclass GetDriverIncentivesCall {\n  static Future<ApiCallResponse> call({\n    required String token,\n    required int driverId,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'getDriverIncentives',\n      apiUrl: '$_baseUrl/api/driver-incentives/get-incentives/$driverId',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n        'Content-Type': 'application/json',\n      },\n      returnBody: true,\n      cache: false,\n    );\n  }\n\n  static int? currentRides(dynamic response) => castToType<int>(getJsonField(\n        response,\n        r'''$.data.current_rides''',\n      ));\n\n  static double? totalEarned(dynamic response) =>\n      castToType<double>(getJsonField(\n        response,\n        r'''$.data.total_earned''',\n      ));\n\n  static List? incentiveTiers(dynamic response) => getJsonField(\n        response,\n        r'''$.data.incentive_tiers''',\n        true,\n      ) as List?;\n}\n\nclass ReferralDashboardCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    String? token = '',\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'referralDashboard',\n      apiUrl: '$_baseUrl/api/referral-dashboard/$driverId/referral-dashboard',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static dynamic data(dynamic response) => getJsonField(\n        response,\n        r'$.data',\n      );\n\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'$.message',\n      ));\n\n  static dynamic totalEarnings(dynamic response) => getJsonField(\n        response,\n        r'$.data.total_earnings',\n      );\n\n  static dynamic totalRides(dynamic response) => getJsonField(\n        response,\n        r'$.data.total_rides',\n      );\n\n  static String? driverName(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'$.driver_info.name',\n      ));\n\n  static int? totalProRides(dynamic response) => castToType<int>(getJsonField(\n        response,\n        r'$.data.my_ride_statistics.total_pro_rides',\n      ));\n\n  static int? totalNormalRides(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'$.data.my_ride_statistics.total_normal_rides',\n      ));\n\n  static dynamic totalRideEarnings(dynamic response) => getJsonField(\n        response,\n        r'$.data.my_ride_statistics.total_ride_earnings',\n      );\n\n  static int? totalReferredDrivers(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'$.data.referral_summary.total_referred_drivers',\n      ));\n\n  static dynamic totalReferralEarnings(dynamic response) => getJsonField(\n        response,\n        r'$.data.referral_summary.total_referral_earnings',\n      );\n\n  static List? referredDriversDetailed(dynamic response) => getJsonField(\n        response,\n        r'$.data.referred_drivers_detailed',\n        true,\n      ) as List?;\n}\n\nclass YesterdayStatisticsCall {\n  static Future<ApiCallResponse> call({\n    String? driverId = '',\n    String? token = '',\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'YesterdayStatistics',\n      apiUrl: '$_baseUrl/api/referral-dashboard/$driverId/yesterday-statistics',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static String? driverName(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'$.driver.name',\n      ));\n\n  static String? referredByName(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'$.driver.referred_by.name',\n      ));\n\n  static int? referredByDriverId(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'$.driver.referred_by.driver_id',\n      ));\n\n  static int? proRidesCompleted(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'$.yesterday_statistics.my_performance.pro_rides_completed',\n      ));\n\n  static int? normalRidesCompleted(dynamic response) =>\n      castToType<int>(getJsonField(\n        response,\n        r'$.yesterday_statistics.my_performance.normal_rides_completed',\n      ));\n\n  static dynamic rideEarnings(dynamic response) => getJsonField(\n        response,\n        r'$.yesterday_statistics.my_performance.ride_earnings',\n      );\n\n  static List? referrals(dynamic response) => getJsonField(\n        response,\n        r'$.yesterday_statistics.referrals',\n        true,\n      ) as List?;\n\n  static dynamic totalCommissionEarnedYesterday(dynamic response) =>\n      getJsonField(\n        response,\n        r'$.yesterday_statistics.total_commission_earned_yesterday',\n      );\n}\n\nclass NotificationHistoryCall {\n  static Future<ApiCallResponse> call({\n    String? token = '',\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'notificationHistory',\n      apiUrl: '$_baseUrl/api/notifications/getall',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static List? notifications(dynamic response) => getJsonField(\n        response,\n        r'$.data.notifications',\n        true,\n      ) as List?;\n\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static int? total(dynamic response) => castToType<int>(getJsonField(\n        response,\n        r'$.data.total',\n      ));\n\n  static int? page(dynamic response) => castToType<int>(getJsonField(\n        response,\n        r'$.data.page',\n      ));\n}\n\nclass ApiPagingParams {\n  int nextPageNumber = 0;\n  int numItems = 0;\n  dynamic lastResponse;\n\n  ApiPagingParams({\n    required this.nextPageNumber,\n    required this.numItems,\n    required this.lastResponse,\n  });\n\n  @override\n  String toString() =>\n      'PagingParams(nextPageNumber: $nextPageNumber, numItems: $numItems, lastResponse: $lastResponse,)';\n}\n\nString _toEncodable(dynamic item) {\n  return item;\n}\n\nString _serializeJson(dynamic jsonVar, [bool isList = false]) {\n  jsonVar ??= (isList ? [] : {});\n  try {\n    return json.encode(jsonVar, toEncodable: _toEncodable);\n  } catch (_) {\n    if (kDebugMode) {\n      print('Json serialization failed. Returning empty json.');\n    }\n    return isList ? '[]' : '{}';\n  }\n}\n\n// \uD83C\uDFE6 Bank Account API Call\nclass BankAccountCall {\n  static Future<ApiCallResponse> call({\n    required String driverId,\n    required String token,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'getBankAccount',\n      apiUrl: '$_baseUrl/api/drivers/bank-account/$driverId',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  // Response parsers\n  static String? bankAccountNumber(dynamic response) {\n    final value = getJsonField(response, r'$.data.bank_account_number');\n    return value?.toString();\n  }\n\n  static String? ifscCode(dynamic response) {\n    final value = getJsonField(response, r'$.data.bank_ifsc_code');\n    return value?.toString();\n  }\n\n  static String? bankName(dynamic response) {\n    final value = getJsonField(response, r'$.data.bank_name');\n    return value?.toString();\n  }\n\n  static String? accountHolderName(dynamic response) {\n    final value = getJsonField(response, r'$.data.bank_holder_name');\n    return value?.toString();\n  }\n\n  static String? fundAccountId(dynamic response) {\n    final value = getJsonField(response, r'$.data.fund_account_id');\n    return value?.toString();\n  }\n\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'$.message',\n      ));\n}\n\n// \uD83D\uDCB8 Razorpay Payout (Withdraw) API Call\nclass RazorpayPayoutCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    required num amount,\n    String? fundAccountId,\n    required String token,\n  }) async {\n    final body = <String, dynamic>{\n      'driver_id': driverId,\n      'amount': amount,\n      if (fundAccountId != null && fundAccountId.isNotEmpty)\n        'fund_account_id': fundAccountId,\n    };\n    final ffApiRequestBody = json.encode(body);\n\n    return ApiManager.instance.makeApiCall(\n      callName: 'razorpayPayout',\n      apiUrl: '$_baseUrl/api/payments/payout',\n      callType: ApiCallType.POST,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'$.message',\n      ));\n}\nclass DriverEarningsCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    required String token,\n    required String period,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'DriverEarnings',\n      apiUrl:\n          '$_baseUrl/api/drivers/earnings/driver/$driverId?period=$period',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      returnBody: true,\n      cache: false,\n    );\n  }\n\n  /// \uD83D\uDD39 Extract full data object\n  static Map<String, dynamic>? data(dynamic response) =>\n      getJsonField(response, r'$.data') as Map<String, dynamic>?;\n\n  /// \uD83D\uDD39 Extract individual keys\n  static int? totalEarnings(dynamic response) =>\n      getJsonField(response, r'$.data.totalEarnings');\n\n  static int? walletEarnings(dynamic response) =>\n      getJsonField(response, r'$.data.walletEarnings');\n\n  static int? totalRides(dynamic response) =>\n      getJsonField(response, r'$.data.totalRides');\n\n  static int? cashEarnings(dynamic response) =>\n      getJsonField(response, r'$.data.cashEarnings');\n\n  static int? onlineEarnings(dynamic response) =>\n      getJsonField(response, r'$.data.onlineEarnings');\n\n  static List<dynamic>? rides(dynamic response) =>\n      getJsonField(response, r'$.data.rides', true) as List<dynamic>?;\n}\n\n\n\n// \uD83C\uDFE6 Add Bank Account API Call (POST)\nclass AddBankAccountCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    required String bankAccountNumber,\n    required String bankIfscCode,\n    required String bankHolderName,\n  }) async {\n    final ffApiRequestBody = '''\n{\n  \"driver_id\": $driverId,\n  \"bank_account_number\": \"$bankAccountNumber\",\n  \"bank_ifsc_code\": \"$bankIfscCode\",\n  \"bank_holder_name\": \"$bankHolderName\"\n}''';\n\n    // Do not log body - contains bank account details\n    return ApiManager.instance.makeApiCall(\n      callName: 'addBankAccount',\n      apiUrl: '$_baseUrl/api/drivers/bank-account',\n      callType: ApiCallType.POST,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      params: {},\n      body: ffApiRequestBody,\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  // Response parsers\n  static bool? success(dynamic response) => castToType<bool>(getJsonField(\n        response,\n        r'$.success',\n      ));\n\n  static String? message(dynamic response) => castToType<String>(getJsonField(\n        response,\n        r'$.message',\n      ));\n\n  static dynamic bankAccountNumber(dynamic response) => getJsonField(\n        response,\n        r'$.data.bank_account_number',\n      );\n\n  static dynamic ifscCode(dynamic response) => getJsonField(\n        response,\n        r'$.data.bank_ifsc_code',\n      );\n\n  static dynamic bankHolderName(dynamic response) => getJsonField(\n        response,\n        r'$.data.bank_holder_name',\n      );\n}\n\n// Razorpay Bank Account Validation (IFSC lookup - no auth needed)\nclass RazorpayBankValidationCall {\n  static Future<ApiCallResponse> call({\n    String? ifscCode,\n    String? accountNumber,\n    String? razorpayKeyId,\n    String? razorpayKeySecret,\n  }) async {\n    // Validate IFSC using free Razorpay IFSC API (no auth needed)\n    // This will return bank details from the IFSC code\n    final ifscResponse = await ApiManager.instance.makeApiCall(\n      callName: 'razorpay_ifsc_lookup',\n      apiUrl: 'https://ifsc.razorpay.com/${ifscCode?.toUpperCase()}',\n      callType: ApiCallType.GET,\n      headers: {},\n      params: {},\n      bodyType: BodyType.JSON,\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n\n    // Return the IFSC validation result\n    // The account number is validated locally in the widget\n    return ifscResponse;\n  }\n\n  static dynamic bankName(dynamic response) =>\n      getJsonField(response, r'$.BANK') ??\n      getJsonField(response, r'$.bank_name') ??\n      'Unknown Bank';\n  static dynamic branchName(dynamic response) =>\n      getJsonField(response, r'$.BRANCH');\n  static dynamic ifsc(dynamic response) =>\n      getJsonField(response, r'$.IFSC') ?? getJsonField(response, r'$.ifsc');\n  static dynamic address(dynamic response) =>\n      getJsonField(response, r'$.ADDRESS');\n  static dynamic city(dynamic response) => getJsonField(response, r'$.CITY');\n  static dynamic state(dynamic response) => getJsonField(response, r'$.STATE');\n}\n\nString? escapeStringForJson(String? input) {\n  if (input == null) {\n    return null;\n  }\n  return input\n      .replaceAll('\\\\', '\\\\\\\\')\n      .replaceAll('\"', '\\\\\"')\n      .replaceAll('\\n', '\\\\n')\n      .replaceAll('\\t', '\\\\t');\n}\n\nclass DriverRideHistoryCall {\n  static Future<ApiCallResponse> call({\n    String? token = '',\n    int? id,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'driverRideHistory',\n      apiUrl: '$_baseUrl/api/drivers/ride-history/$id',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n      },\n      params: {},\n      returnBody: true,\n      cache: false,\n    );\n  }\n\n  static dynamic data(dynamic response) =>\n      getJsonField(response, r'''$.data''');\n\n  /// Full data.tabs object\n  static dynamic tabs(dynamic response) =>\n      getJsonField(response, r'''$.data.tabs''');\n\n  /// Completed rides: data.tabs.completed.rides\n  static List<dynamic> completedRides(dynamic response) {\n    final list = getJsonField(response, r'''$.data.tabs.completed.rides''');\n    return list is List ? List<dynamic>.from(list) : [];\n  }\n\n  /// Cancelled rides: data.tabs.cancelled.rides\n  static List<dynamic> cancelledRides(dynamic response) {\n    final list = getJsonField(response, r'''$.data.tabs.cancelled.rides''');\n    return list is List ? List<dynamic>.from(list) : [];\n  }\n\n  /// Missed rides: data.tabs.missed.rides\n  static List<dynamic> missedRides(dynamic response) {\n    final list = getJsonField(response, r'''$.data.tabs.missed.rides''');\n    return list is List ? List<dynamic>.from(list) : [];\n  }\n\n  /// Summary: data.summary (totalCompletedRides, totalEarnings, etc.)\n  static Map<String, dynamic>? summary(dynamic response) =>\n      getJsonField(response, r'''$.data.summary''') as Map<String, dynamic>?;\n\n  /// Total earnings from summary (INR)\n  static int? totalEarnings(dynamic response) {\n    final s = summary(response);\n    if (s != null && s['totalEarnings'] != null) {\n      final v = s['totalEarnings'];\n      if (v is int) return v;\n      if (v is num) return v.toInt();\n      return int.tryParse(v.toString());\n    }\n    return null;\n  }\n\n  /// All rides combined (completed + cancelled + missed) - for backwards compat\n  static List rides(dynamic response) {\n    final completed = completedRides(response);\n    final cancelled = cancelledRides(response);\n    final missed = missedRides(response);\n    return [...completed, ...cancelled, ...missed];\n  }\n}\n\n// \uD83D\uDCC5 DAILY INCENTIVES\n// GET /api/driver-incentives/daily-incentives?driver_id=X&date=YYYY-MM-DD\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n// ============================================================\n// ADD THIS CLASS TO YOUR api_calls.dart FILE\n// ============================================================\n// Single unified incentives API\n// Base: /api/driver-incentives/daily-incentives/{driverId}\n//\n//   ?date=2026-02-11              â†’ particular date\n//   ?type=weekly                  â†’ current week\n//   ?type=monthly                 â†’ current month\n//   ?from=2026-02-01&to=2026-02-20 â†’ custom range\n// ============================================================\n\nclass DriverIncentivesCall {\n  static Future<ApiCallResponse> call({\n    required String token,\n    required int driverId,\n    String? date,   // particular date  \"2026-02-11\"\n    String? type,   // \"weekly\" | \"monthly\"\n    String? from,   // range start      \"2026-02-01\"\n    String? to,     // range end        \"2026-02-20\"\n  }) async {\n    final Map<String, String> queryParams = {};\n    if (date != null) queryParams['date'] = date;\n    if (type != null) queryParams['type'] = type;\n    if (from != null) queryParams['from'] = from;\n    if (to != null) queryParams['to'] = to;\n\n    final queryString = Uri(queryParameters: queryParams).query;\n    final url =\n        '$_baseUrl/api/driver-incentives/daily-incentives/$driverId'\n        '${queryString.isNotEmpty ? '?$queryString' : ''}';\n\n    debugPrint('\uD83D\uDCE1 DriverIncentivesCall â†’ $url');\n\n    return ApiManager.instance.makeApiCall(\n      callName: 'DriverIncentives',\n      apiUrl: url,\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n        'Content-Type': 'application/json',\n      },\n      params: {},\n      returnBody: true,\n      encodeBodyUtf8: false,\n      decodeUtf8: false,\n      cache: false,\n      isStreamingApi: false,\n      alwaysAllowBody: false,\n    );\n  }\n\n  // â”€â”€ Response Parsers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n  static List<dynamic> incentiveList(dynamic response) =>\n      (getJsonField(response, r'$.data', true) as List?) ?? [];\n\n  static bool? success(dynamic response) =>\n      castToType<bool>(getJsonField(response, r'$.success'));\n\n  static String? message(dynamic response) =>\n      castToType<String>(getJsonField(response, r'$.message'));\n\n  static String? filterStartDate(dynamic response) =>\n      castToType<String>(getJsonField(response, r'$.filter.startDate'));\n\n  static String? filterEndDate(dynamic response) =>\n      castToType<String>(getJsonField(response, r'$.filter.endDate'));\n\n  // â”€â”€ Per-item Helpers (use when iterating incentiveList) â”€â”€\n\n  static int itemTargetRides(dynamic item) =>\n      castToType<int>(getJsonField(item, r'$.target_rides')) ?? 0;\n\n  static int itemCompletedRides(dynamic item) =>\n      castToType<int>(getJsonField(item, r'$.completed_rides')) ?? 0;\n\n  static double itemRewardAmount(dynamic item) =>\n      double.tryParse(\n          getJsonField(item, r'$.reward_amount')?.toString() ?? '0') ?? 0.0;\n\n  static String itemProgressStatus(dynamic item) =>\n      castToType<String>(getJsonField(item, r'$.progress_status')) ?? 'ongoing';\n\n  static bool itemIsCompleted(dynamic item) =>\n      itemProgressStatus(item) == 'completed';\n\n  static String itemIncentiveName(dynamic item) =>\n      castToType<String>(getJsonField(item, r'$.incentive.name')) ?? 'Incentive';\n\n  static String itemRecurrenceType(dynamic item) =>\n      castToType<String>(\n          getJsonField(item, r'$.incentive.recurrence_type')) ?? '';\n\n  static String itemStartTime(dynamic item) =>\n      castToType<String>(getJsonField(item, r'$.incentive.start_time')) ?? '';\n\n  static String itemEndTime(dynamic item) =>\n      castToType<String>(getJsonField(item, r'$.incentive.end_time')) ?? '';\n}\n\nclass VehiclePricingCall {\n  static Future<ApiCallResponse> call({\n    required int driverId,\n    required String token,\n  }) async {\n    return ApiManager.instance.makeApiCall(\n      callName: 'vehiclePricing',\n      apiUrl:\n          '$_baseUrl/api/vehicle-types/drivers/$driverId/vehicle-pricing',\n      callType: ApiCallType.GET,\n      headers: {\n        'Authorization': 'Bearer $token',\n        'Content-Type': 'application/json',\n      },\n      params: {},\n      returnBody: true,\n      cache: false,\n    );\n  }\n\n  /// Full pricing object\n  static dynamic pricing(dynamic response) =>\n      getJsonField(response, r'''$.data.pricing''');\n\n  /// Normal Ride\n  static dynamic normal(dynamic response) =>\n      getJsonField(response, r'''$.data.pricing.normal''');\n\n  /// Pro Ride\n  static dynamic pro(dynamic response) =>\n      getJsonField(response, r'''$.data.pricing.pro''');\n\n  /// Vehicle Name\n  static String? vehicleName(dynamic response) =>\n      castToType<String>(getJsonField(\n        response,\n        r'''$.data.vehicle_type.name''',\n      ));\n\n  /// Vehicle Image\n  static String? vehicleImage(dynamic response) {\n    final path = castToType<String>(getJsonField(\n      response,\n      r'''$.data.vehicle_type.image''',\n    ));\n\n    if (path == null) return null;\n\n    if (path.startsWith('/')) {\n      return '$_baseUrl$path';\n    }\n\n    return path;\n  }\n\n\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/backend/api_requests/api_calls.dart b/lib/backend/api_requests/api_calls.dart
--- a/lib/backend/api_requests/api_calls.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/backend/api_requests/api_calls.dart	(date 1771596404062)
@@ -125,6 +125,78 @@
           .toList();
 }
 
+/// Vehicle makes (brands) - e.g. Toyota, Honda, Maruti
+/// API: GET /api/vehicle-makes or /api/vehicles/makes
+class GetVehicleMakesCall {
+  static Future<ApiCallResponse> call() async {
+    return ApiManager.instance.makeApiCall(
+      callName: 'getVehicleMakes',
+      apiUrl: '$_baseUrl/api/vehicle-makes',
+      callType: ApiCallType.GET,
+      headers: {},
+      params: {},
+      returnBody: true,
+      encodeBodyUtf8: false,
+      decodeUtf8: false,
+      cache: true,
+      isStreamingApi: false,
+      alwaysAllowBody: false,
+    );
+  }
+
+  static List<String>? names(dynamic response) {
+    final data = getJsonField(response, r'$.data', true);
+    if (data is List) {
+      return data
+          .map((e) => e is Map ? (e['name'] ?? e['make'] ?? e['vehicle_make'])?.toString() : e?.toString())
+          .whereType<String>()
+          .where((s) => s.isNotEmpty)
+          .toList();
+    }
+    final arr = getJsonField(response, r'$.data[:].name', true) as List?;
+    return arr?.withoutNulls.map((x) => castToType<String>(x)).withoutNulls.toList();
+  }
+}
+
+/// Vehicle models - e.g. Camry, Civic, Swift
+/// API: GET /api/vehicle-models or /api/vehicle-models?make_id=X
+class GetVehicleModelsCall {
+  static Future<ApiCallResponse> call({int? makeId, String? makeName}) async {
+    var url = '$_baseUrl/api/vehicle-models';
+    if (makeId != null && makeId > 0) {
+      url += '?make_id=$makeId';
+    } else if (makeName != null && makeName.isNotEmpty) {
+      url += '?make=$makeName';
+    }
+    return ApiManager.instance.makeApiCall(
+      callName: 'getVehicleModels',
+      apiUrl: url,
+      callType: ApiCallType.GET,
+      headers: {},
+      params: {},
+      returnBody: true,
+      encodeBodyUtf8: false,
+      decodeUtf8: false,
+      cache: true,
+      isStreamingApi: false,
+      alwaysAllowBody: false,
+    );
+  }
+
+  static List<String>? names(dynamic response) {
+    final data = getJsonField(response, r'$.data', true);
+    if (data is List) {
+      return data
+          .map((e) => e is Map ? (e['name'] ?? e['model'] ?? e['vehicle_model'])?.toString() : e?.toString())
+          .whereType<String>()
+          .where((s) => s.isNotEmpty)
+          .toList();
+    }
+    final arr = getJsonField(response, r'$.data[:].name', true) as List?;
+    return arr?.withoutNulls.map((x) => castToType<String>(x)).withoutNulls.toList();
+  }
+}
+
 /// Get all drivers - used for showing available captains (like Rapido).
 /// Filters by is_online & is_active for "available drivers".
 class GetAllDriversCall {
@@ -365,7 +437,16 @@
     FFUploadedFile? registrationImage,
     FFUploadedFile? insuranceImage,
     FFUploadedFile? pollutionCertificateImage,
-    
+    String? vehicleName,
+    String? vehicleModel,
+    String? vehicleColor,
+    String? licensePlate,
+    String? registrationNumber,
+    String? registrationDate,
+    String? insuranceNumber,
+    String? insuranceExpiryDate,
+    String? pollutionExpiryDate,
+    int? vehicleTypeId,
   }) async {
     // Build params dynamically - only include non-null values
     final Map<String, dynamic> params = {};
@@ -437,6 +518,17 @@
       params['pollution_certificate_image'] = pollutionCertificateImage;
     }
 
+    if (vehicleName != null && vehicleName.isNotEmpty) params['vehicle_name'] = vehicleName;
+    if (vehicleModel != null && vehicleModel.isNotEmpty) params['vehicle_model'] = vehicleModel;
+    if (vehicleColor != null && vehicleColor.isNotEmpty) params['vehicle_color'] = vehicleColor;
+    if (licensePlate != null && licensePlate.isNotEmpty) params['license_plate'] = licensePlate;
+    if (registrationNumber != null && registrationNumber.isNotEmpty) params['registration_number'] = registrationNumber;
+    if (registrationDate != null && registrationDate.isNotEmpty) params['registration_date'] = registrationDate;
+    if (insuranceNumber != null && insuranceNumber.isNotEmpty) params['insurance_number'] = insuranceNumber;
+    if (insuranceExpiryDate != null && insuranceExpiryDate.isNotEmpty) params['insurance_expiry_date'] = insuranceExpiryDate;
+    if (pollutionExpiryDate != null && pollutionExpiryDate.isNotEmpty) params['pollution_expiry_date'] = pollutionExpiryDate;
+    if (vehicleTypeId != null && vehicleTypeId > 0) params['vehicle_type_id'] = vehicleTypeId;
+
     print('ðŸš€ UpdateDriver API Request:');
     print('   URL: $_baseUrl/api/drivers/$id');
     print('   Token: ${token?.substring(0, 20)}...');
Index: lib/vehicle_image/vehicle_image_update.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/constants/app_colors.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/flutter_flow/upload_data.dart';\nimport 'package:flutter/material.dart';\nimport 'dart:convert';\nimport 'vehicle_image_model.dart';\nexport 'vehicle_image_model.dart';\n\nclass VehicleImageUpdateWidget extends StatefulWidget {\n  const VehicleImageUpdateWidget({super.key});\n\n  static String routeName = 'vehicleImageUpdate';\nstatic String routePath = '/vehicleImageUpdate';\n\n  @override\n  State<VehicleImageUpdateWidget> createState() => _VehicleImageUpdateWidgetState();\n}\n\nclass _VehicleImageUpdateWidgetState extends State<VehicleImageUpdateWidget>\n    with SingleTickerProviderStateMixin {\n  late VehicleImageModel _model;\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n\n  FFUploadedFile? _vehicleImage;\n  bool _isVehicleImageValid = false;\n\n  String? _selectedVehicleType;\n  String? _selectedColor;\n\n  final TextEditingController _makeController = TextEditingController();\n  final TextEditingController _modelController = TextEditingController();\n  final TextEditingController _yearController = TextEditingController();\n\n  late AnimationController _animationController;\n  late Animation<double> _fadeAnimation;\n\n  final List<Map<String, dynamic>> vehicleTypes = [\n    {'name': 'Car', 'icon': '\uD83D\uDE97', 'color': AppColors.accentIndigo},\n    {'name': 'Bike', 'icon': '\uD83C\uDFCD\uFE0F', 'color': AppColors.accentPink},\n    {'name': 'Truck', 'icon': '\uD83D\uDE9A', 'color': AppColors.accentEmerald},\n    {'name': 'SUV', 'icon': '\uD83D\uDE99', 'color': AppColors.accentAmber},\n  ];\n\n  final List<Map<String, dynamic>> vehicleColors = [\n    {'name': 'White', 'color': AppColors.white, 'border': Colors.grey[300]},\n    {'name': 'Black', 'color': AppColors.black, 'border': Colors.black},\n    {'name': 'Silver', 'color': AppColors.silver, 'border': Colors.grey[400]},\n    {'name': 'Red', 'color': AppColors.accentRed, 'border': AppColors.accentRed},\n    {'name': 'Blue', 'color': AppColors.accentBlue, 'border': AppColors.accentBlue},\n    {'name': 'Grey', 'color': AppColors.greyVehicle, 'border': AppColors.greyVehicle},\n  ];\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => VehicleImageModel());\n\n    _animationController = AnimationController(\n      duration: const Duration(milliseconds: 800),\n      vsync: this,\n    );\n\n    _fadeAnimation = CurvedAnimation(\n      parent: _animationController,\n      curve: Curves.easeInOut,\n    );\n\n    _animationController.forward();\n    _loadSavedData();\n  }\n\n  void _loadSavedData() {\n    if (FFAppState().vehicleBase64.isNotEmpty) {\n      try {\n        Uint8List bytes = base64Decode(FFAppState().vehicleBase64);\n        setState(() {\n          _vehicleImage = FFUploadedFile(bytes: bytes, name: 'vehicle.jpg');\n          _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n          _isVehicleImageValid = true;\n        });\n      } catch (e) {\n        print('âŒ Error: $e');\n      }\n    } else if (FFAppState().vehicleImage?.bytes != null) {\n      setState(() {\n        _vehicleImage = FFAppState().vehicleImage;\n        _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n        _isVehicleImageValid = true;\n      });\n    }\n\n    if (FFAppState().vehicleType.isNotEmpty) {\n      setState(() => _selectedVehicleType = FFAppState().vehicleType);\n    }\n    if (FFAppState().vehicleMake.isNotEmpty) {\n      _makeController.text = FFAppState().vehicleMake;\n    }\n    if (FFAppState().vehicleModel.isNotEmpty) {\n      _modelController.text = FFAppState().vehicleModel;\n    }\n    if (FFAppState().vehicleYear.isNotEmpty) {\n      _yearController.text = FFAppState().vehicleYear;\n    }\n    if (FFAppState().vehicleColor.isNotEmpty) {\n      setState(() => _selectedColor = FFAppState().vehicleColor);\n    }\n  }\n\n  @override\n  void dispose() {\n    _model.dispose();\n    _animationController.dispose();\n    _makeController.dispose();\n    _modelController.dispose();\n    _yearController.dispose();\n    super.dispose();\n  }\n\n  void _showSnackBar(String message, {bool isError = false}) {\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Row(\n          children: [\n            Icon(\n              isError ? Icons.error_outline : Icons.check_circle,\n              color: Colors.white,\n              size: 20,\n            ),\n            const SizedBox(width: 10),\n            Expanded(\n              child: Text(message, style: const TextStyle(fontSize: 14)),\n            ),\n          ],\n        ),\n        backgroundColor: isError ? Colors.red[400] : Colors.green[500],\n        behavior: SnackBarBehavior.floating,\n        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),\n        margin: const EdgeInsets.all(16),\n        duration: const Duration(seconds: 3),\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    bool hasImage = (_vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty);\n\n    return GestureDetector(\n      onTap: () => FocusScope.of(context).unfocus(),\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: AppColors.backgroundLight,\n        appBar: AppBar(\n          backgroundColor: Colors.white,\n          elevation: 0,\n          leading: IconButton(\n            icon: const Icon(Icons.arrow_back, color: AppColors.textDark),\n            onPressed: () => context.pop(),\n          ),\n          title: const Text(\n            'Vehicle Details',\n            style: TextStyle(\n              color: AppColors.textDark,\n              fontSize: 18,\n              fontWeight: FontWeight.w600,\n            ),\n          ),\n          centerTitle: true,\n        ),\n        body: SafeArea(\n          child: FadeTransition(\n            opacity: _fadeAnimation,\n            child: SingleChildScrollView(\n              physics: const BouncingScrollPhysics(),\n              child: Padding(\n                padding: const EdgeInsets.all(20.0),\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    // Vehicle Type\n                    const Text(\n                      'Vehicle Type',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildVehicleTypeGrid(),\n\n                    const SizedBox(height: 24),\n\n                    // Make\n                    _buildSimpleTextField(\n                      controller: _makeController,\n                      label: 'Vehicle Make',\n                      hint: 'e.g., Toyota, Honda',\n                      icon: Icons.directions_car,\n                    ),\n\n                    const SizedBox(height: 20),\n\n                    // Model\n                    _buildSimpleTextField(\n                      controller: _modelController,\n                      label: 'Vehicle Model',\n                      hint: 'e.g., Camry, Civic',\n                      icon: Icons.car_rental,\n                    ),\n\n                    const SizedBox(height: 20),\n\n                    // Year\n                    _buildSimpleTextField(\n                      controller: _yearController,\n                      label: 'Year',\n                      hint: 'e.g., 2023',\n                      icon: Icons.calendar_today,\n                      keyboardType: TextInputType.number,\n                    ),\n\n                    const SizedBox(height: 24),\n\n                    // Color\n                    const Text(\n                      'Vehicle Color',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildColorGrid(),\n\n                    const SizedBox(height: 24),\n\n                    // Photo Upload\n                    const Text(\n                      'Vehicle Photo',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildPhotoUpload(hasImage),\n\n                    const SizedBox(height: 32),\n\n                    // Submit Button\n                    _buildSubmitButton(hasImage),\n\n                    const SizedBox(height: 20),\n                  ],\n                ),\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n\n  Widget _buildVehicleTypeGrid() {\n    return GridView.builder(\n      shrinkWrap: true,\n      physics: const NeverScrollableScrollPhysics(),\n      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(\n        crossAxisCount: 4,\n        crossAxisSpacing: 12,\n        mainAxisSpacing: 12,\n        childAspectRatio: 1,\n      ),\n      itemCount: vehicleTypes.length,\n      itemBuilder: (context, index) {\n        final type = vehicleTypes[index];\n        bool isSelected = _selectedVehicleType == type['name'];\n\n        return GestureDetector(\n          onTap: () {\n            setState(() => _selectedVehicleType = type['name']);\n            FFAppState().vehicleType = type['name'];\n            FFAppState().update(() {});\n          },\n          child: AnimatedContainer(\n            duration: const Duration(milliseconds: 200),\n            decoration: BoxDecoration(\n              color: isSelected ? type['color'] : Colors.white,\n              borderRadius: BorderRadius.circular(16),\n              border: Border.all(\n                color: isSelected ? type['color'] : AppColors.greyBorder,\n                width: 2,\n              ),\n              boxShadow: [\n                if (isSelected)\n                  BoxShadow(\n                    color: type['color'].withValues(alpha:0.3),\n                    blurRadius: 8,\n                    offset: const Offset(0, 4),\n                  ),\n              ],\n            ),\n            child: Column(\n              mainAxisAlignment: MainAxisAlignment.center,\n              children: [\n                Text(\n                  type['icon'],\n                  style: const TextStyle(fontSize: 32),\n                ),\n                const SizedBox(height: 4),\n                Text(\n                  type['name'],\n                  style: TextStyle(\n                    fontSize: 11,\n                    fontWeight: FontWeight.w600,\n                    color: isSelected ? Colors.white : AppColors.greySlate,\n                  ),\n                ),\n              ],\n            ),\n          ),\n        );\n      },\n    );\n  }\n\n  Widget _buildSimpleTextField({\n    required TextEditingController controller,\n    required String label,\n    required String hint,\n    required IconData icon,\n    TextInputType keyboardType = TextInputType.text,\n  }) {\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        Text(\n          label,\n          style: const TextStyle(\n            fontSize: 16,\n            fontWeight: FontWeight.w600,\n            color: AppColors.textDark,\n          ),\n        ),\n        const SizedBox(height: 8),\n        Container(\n          decoration: BoxDecoration(\n            color: Colors.white,\n            borderRadius: BorderRadius.circular(12),\n            border: Border.all(\n              color: controller.text.isNotEmpty ? AppColors.accentIndigo : AppColors.greyBorder,\n              width: 2,\n            ),\n          ),\n          child: TextField(\n            controller: controller,\n            keyboardType: keyboardType,\n            style: const TextStyle(\n              fontSize: 15,\n              fontWeight: FontWeight.w500,\n              color: AppColors.textDark,\n            ),\n            decoration: InputDecoration(\n              hintText: hint,\n              hintStyle: const TextStyle(\n                color: AppColors.greyLight,\n                fontSize: 15,\n              ),\n              prefixIcon: Icon(icon, color: AppColors.accentIndigo, size: 20),\n              suffixIcon: controller.text.isNotEmpty\n                  ? const Icon(Icons.check_circle, color: AppColors.accentEmerald, size: 20)\n                  : null,\n              border: InputBorder.none,\n              contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 16),\n            ),\n            onChanged: (value) {\n              setState(() {});\n              if (label == 'Vehicle Make') {\n                FFAppState().vehicleMake = value;\n              } else if (label == 'Vehicle Model') {\n                FFAppState().vehicleModel = value;\n              } else if (label == 'Year') {\n                FFAppState().vehicleYear = value;\n              }\n              FFAppState().update(() {});\n            },\n          ),\n        ),\n      ],\n    );\n  }\n\n  Widget _buildColorGrid() {\n    return Wrap(\n      spacing: 12,\n      runSpacing: 12,\n      children: vehicleColors.map((colorData) {\n        bool isSelected = _selectedColor == colorData['name'];\n        return GestureDetector(\n          onTap: () {\n            setState(() => _selectedColor = colorData['name']);\n            FFAppState().vehicleColor = colorData['name'];\n            FFAppState().update(() {});\n          },\n          child: AnimatedContainer(\n            duration: const Duration(milliseconds: 200),\n            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),\n            decoration: BoxDecoration(\n              color: isSelected ? AppColors.accentIndigo.withValues(alpha:0.1) : Colors.white,\n              borderRadius: BorderRadius.circular(12),\n              border: Border.all(\n                color: isSelected ? AppColors.accentIndigo : AppColors.greyBorder,\n                width: 2,\n              ),\n            ),\n            child: Row(\n              mainAxisSize: MainAxisSize.min,\n              children: [\n                Container(\n                  width: 24,\n                  height: 24,\n                  decoration: BoxDecoration(\n                    color: colorData['color'],\n                    shape: BoxShape.circle,\n                    border: Border.all(\n                      color: colorData['border'],\n                      width: 2,\n                    ),\n                  ),\n                ),\n                const SizedBox(width: 8),\n                Text(\n                  colorData['name'],\n                  style: TextStyle(\n                    fontSize: 14,\n                    fontWeight: FontWeight.w500,\n                    color: isSelected ? AppColors.accentIndigo : AppColors.greySlate,\n                  ),\n                ),\n                if (isSelected) ...[\n                  const SizedBox(width: 6),\n                  const Icon(Icons.check, size: 16, color: AppColors.accentIndigo),\n                ],\n              ],\n            ),\n          ),\n        );\n      }).toList(),\n    );\n  }\n\n  Widget _buildPhotoUpload(bool hasImage) {\n    return GestureDetector(\n      onTap: () async {\n        final selectedMedia = await selectMediaWithSourceBottomSheet(\n          context: context,\n          allowPhoto: true,\n        );\n        if (selectedMedia != null &&\n            selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {\n          var selectedUploadedFiles = <FFUploadedFile>[];\n          try {\n            selectedUploadedFiles = selectedMedia\n                .map((m) => FFUploadedFile(\n              name: m.storagePath.split('/').last,\n              bytes: m.bytes,\n              height: m.dimensions?.height,\n              width: m.dimensions?.width,\n              blurHash: m.blurHash,\n              originalFilename: m.originalFilename,\n            ))\n                .toList();\n          } catch (e) {\n            print('âŒ Error: $e');\n          }\n          if (selectedUploadedFiles.isNotEmpty) {\n            setState(() {\n              _vehicleImage = selectedUploadedFiles.first;\n              _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n              _isVehicleImageValid = true;\n            });\n\n            FFAppState().vehicleImage = _vehicleImage;\n            if (_vehicleImage?.bytes != null) {\n              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);\n            }\n            FFAppState().update(() {});\n            _showSnackBar('Photo uploaded successfully! âœ“');\n          }\n        }\n      },\n      child: AnimatedContainer(\n        duration: const Duration(milliseconds: 300),\n        width: double.infinity,\n        height: 200,\n        decoration: BoxDecoration(\n          color: hasImage ? null : Colors.white,\n          borderRadius: BorderRadius.circular(16),\n          border: Border.all(\n            color: hasImage ? AppColors.accentEmerald : AppColors.greyBorder,\n            width: 2,\n          ),\n        ),\n        child: Stack(\n          children: [\n            ClipRRect(\n              borderRadius: BorderRadius.circular(14),\n              child: _vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty\n                  ? Image.memory(\n                _vehicleImage!.bytes!,\n                width: double.infinity,\n                height: double.infinity,\n                fit: BoxFit.cover,\n              )\n                  : Center(\n                child: Column(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    Container(\n                      padding: const EdgeInsets.all(16),\n                      decoration: BoxDecoration(\n                        color: AppColors.accentIndigo.withValues(alpha:0.1),\n                        shape: BoxShape.circle,\n                      ),\n                      child: const Icon(\n                        Icons.add_photo_alternate,\n                        size: 40,\n                        color: AppColors.accentIndigo,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    const Text(\n                      'Tap to upload photo',\n                      style: TextStyle(\n                        fontSize: 15,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.greySlate,\n                      ),\n                    ),\n                    const SizedBox(height: 4),\n                    const Text(\n                      'Camera or Gallery',\n                      style: TextStyle(\n                        fontSize: 13,\n                        color: AppColors.greyLight,\n                      ),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n\n            if (hasImage)\n              Positioned(\n                top: 8,\n                right: 8,\n                child: GestureDetector(\n                  onTap: () {\n                    setState(() {\n                      _vehicleImage = null;\n                      _isVehicleImageValid = false;\n                    });\n                    FFAppState().vehicleImage = null;\n                    FFAppState().vehicleBase64 = '';\n                    FFAppState().update(() {});\n                    _showSnackBar('Photo removed', isError: true);\n                  },\n                  child: Container(\n                    padding: const EdgeInsets.all(8),\n                    decoration: BoxDecoration(\n                      color: Colors.red[400],\n                      shape: BoxShape.circle,\n                      boxShadow: const [\n                        BoxShadow(\n                          color: Colors.black26,\n                          blurRadius: 4,\n                          offset: Offset(0, 2),\n                        ),\n                      ],\n                    ),\n                    child: const Icon(Icons.close, color: Colors.white, size: 18),\n                  ),\n                ),\n              ),\n\n            if (hasImage && _isVehicleImageValid)\n              Positioned(\n                top: 8,\n                left: 8,\n                child: Container(\n                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),\n                  decoration: BoxDecoration(\n                    color: AppColors.accentEmerald,\n                    borderRadius: BorderRadius.circular(20),\n                    boxShadow: const [\n                      BoxShadow(\n                        color: Colors.black26,\n                        blurRadius: 4,\n                        offset: Offset(0, 2),\n                      ),\n                    ],\n                  ),\n                  child: const Row(\n                    mainAxisSize: MainAxisSize.min,\n                    children: [\n                      Icon(Icons.check_circle, color: Colors.white, size: 16),\n                      SizedBox(width: 4),\n                      Text(\n                        'Uploaded',\n                        style: TextStyle(\n                          color: Colors.white,\n                          fontSize: 12,\n                          fontWeight: FontWeight.w600,\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildSubmitButton(bool hasImage) {\n    bool isFormValid = _selectedVehicleType != null &&\n        _makeController.text.isNotEmpty &&\n        _modelController.text.isNotEmpty &&\n        _yearController.text.isNotEmpty &&\n        _selectedColor != null &&\n        hasImage;\n\n    return Container(\n      width: double.infinity,\n      height: 56,\n      decoration: BoxDecoration(\n        gradient: isFormValid\n            ? const LinearGradient(\n          colors: [AppColors.accentIndigo, AppColors.accentPurple],\n          begin: Alignment.centerLeft,\n          end: Alignment.centerRight,\n        )\n            : null,\n        color: isFormValid ? null : AppColors.greyBorder,\n        borderRadius: BorderRadius.circular(12),\n        boxShadow: isFormValid\n            ? [\n          BoxShadow(\n            color: AppColors.accentIndigo.withValues(alpha:0.4),\n            blurRadius: 12,\n            offset: const Offset(0, 6),\n          ),\n        ]\n            : [],\n      ),\n      child: Material(\n        color: Colors.transparent,\n        child: InkWell(\n          borderRadius: BorderRadius.circular(12),\n          onTap: isFormValid\n              ? () async {\n            FFAppState().vehicleType = _selectedVehicleType!;\n            FFAppState().vehicleYear = _yearController.text;\n            FFAppState().vehicleMake = _makeController.text;\n            FFAppState().vehicleModel = _modelController.text;\n            FFAppState().vehicleColor = _selectedColor!;\n            FFAppState().vehicleImage = _vehicleImage;\n\n            if (_vehicleImage?.bytes != null) {\n              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);\n            }\n\n            FFAppState().update(() {});\n\n            _showSnackBar('âœ“ Vehicle details saved successfully!');\n\n            await Future.delayed(const Duration(milliseconds: 600));\n            context.pop();\n          }\n              : () {\n            if (_selectedVehicleType == null) {\n              _showSnackBar('Please select vehicle type', isError: true);\n            } else if (_makeController.text.isEmpty) {\n              _showSnackBar('Please enter vehicle make', isError: true);\n            } else if (_modelController.text.isEmpty) {\n              _showSnackBar('Please enter vehicle model', isError: true);\n            } else if (_yearController.text.isEmpty) {\n              _showSnackBar('Please enter year', isError: true);\n            } else if (_selectedColor == null) {\n              _showSnackBar('Please select color', isError: true);\n            } else if (!hasImage) {\n              _showSnackBar('Please upload vehicle photo', isError: true);\n            }\n          },\n          child: Center(\n            child: Text(\n              'Save Vehicle Details',\n              style: TextStyle(\n                color: isFormValid ? Colors.white : AppColors.greyLight,\n                fontSize: 16,\n                fontWeight: FontWeight.w600,\n                letterSpacing: 0.3,\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/vehicle_image/vehicle_image_update.dart b/lib/vehicle_image/vehicle_image_update.dart
--- a/lib/vehicle_image/vehicle_image_update.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/vehicle_image/vehicle_image_update.dart	(date 1771596528854)
@@ -1,8 +1,12 @@
+import '/backend/api_requests/api_calls.dart';
+import '/config.dart' as app_config;
 import '/constants/app_colors.dart';
+import '/constants/vehicle_data.dart';
 import '/flutter_flow/flutter_flow_util.dart';
 import '/flutter_flow/upload_data.dart';
 import 'package:flutter/material.dart';
 import 'dart:convert';
+import 'dart:typed_data';
 import 'vehicle_image_model.dart';
 export 'vehicle_image_model.dart';
 
@@ -10,7 +14,7 @@
   const VehicleImageUpdateWidget({super.key});
 
   static String routeName = 'vehicleImageUpdate';
-static String routePath = '/vehicleImageUpdate';
+  static String routePath = '/vehicleImageUpdate';
 
   @override
   State<VehicleImageUpdateWidget> createState() => _VehicleImageUpdateWidgetState();
@@ -23,48 +27,57 @@
 
   FFUploadedFile? _vehicleImage;
   bool _isVehicleImageValid = false;
+  FFUploadedFile? _pollutionImage;
+  FFUploadedFile? _insuranceImage;
+  bool _isPollutionValid = false;
+  bool _isInsuranceValid = false;
 
   String? _selectedVehicleType;
+  int _selectedVehicleTypeId = 0;
   String? _selectedColor;
 
   final TextEditingController _makeController = TextEditingController();
   final TextEditingController _modelController = TextEditingController();
   final TextEditingController _yearController = TextEditingController();
+  final TextEditingController _licensePlateController = TextEditingController();
+  final TextEditingController _regNumberController = TextEditingController();
+  final TextEditingController _regDateController = TextEditingController();
+  final TextEditingController _insuranceNumberController = TextEditingController();
+  final TextEditingController _insuranceExpiryController = TextEditingController();
+  final TextEditingController _pollutionExpiryController = TextEditingController();
+  final TextEditingController _vehicleNameController = TextEditingController();
 
   late AnimationController _animationController;
   late Animation<double> _fadeAnimation;
 
-  final List<Map<String, dynamic>> vehicleTypes = [
-    {'name': 'Car', 'icon': 'ðŸš—', 'color': AppColors.accentIndigo},
-    {'name': 'Bike', 'icon': 'ðŸï¸', 'color': AppColors.accentPink},
-    {'name': 'Truck', 'icon': 'ðŸšš', 'color': AppColors.accentEmerald},
-    {'name': 'SUV', 'icon': 'ðŸš™', 'color': AppColors.accentAmber},
-  ];
+  static const Color _primary = AppColors.primary;
+  static const Color _textWhite = AppColors.white;
+  static const Color _textMuted = AppColors.greySlate;
+  static const Color _cardBg = AppColors.backgroundCard;
 
   final List<Map<String, dynamic>> vehicleColors = [
-    {'name': 'White', 'color': AppColors.white, 'border': Colors.grey[300]},
-    {'name': 'Black', 'color': AppColors.black, 'border': Colors.black},
-    {'name': 'Silver', 'color': AppColors.silver, 'border': Colors.grey[400]},
+    {'name': 'White', 'color': AppColors.white, 'border': AppColors.greyBorder},
+    {'name': 'Black', 'color': AppColors.black, 'border': AppColors.black},
+    {'name': 'Silver', 'color': AppColors.silver, 'border': AppColors.greyMid},
     {'name': 'Red', 'color': AppColors.accentRed, 'border': AppColors.accentRed},
     {'name': 'Blue', 'color': AppColors.accentBlue, 'border': AppColors.accentBlue},
     {'name': 'Grey', 'color': AppColors.greyVehicle, 'border': AppColors.greyVehicle},
+    {'name': 'Yellow', 'color': AppColors.teamEarningsYellow, 'border': AppColors.teamEarningsYellow},
+    {'name': 'Green', 'color': AppColors.success, 'border': AppColors.success},
   ];
 
   @override
   void initState() {
     super.initState();
     _model = createModel(context, () => VehicleImageModel());
-
     _animationController = AnimationController(
-      duration: const Duration(milliseconds: 800),
+      duration: const Duration(milliseconds: 900),
       vsync: this,
     );
-
     _fadeAnimation = CurvedAnimation(
       parent: _animationController,
       curve: Curves.easeInOut,
     );
-
     _animationController.forward();
     _loadSavedData();
   }
@@ -79,7 +92,7 @@
           _isVehicleImageValid = true;
         });
       } catch (e) {
-        print('âŒ Error: $e');
+        print('Error: $e');
       }
     } else if (FFAppState().vehicleImage?.bytes != null) {
       setState(() {
@@ -89,20 +102,68 @@
       });
     }
 
-    if (FFAppState().vehicleType.isNotEmpty) {
-      setState(() => _selectedVehicleType = FFAppState().vehicleType);
+    // Load vehicle type driver already selected (from Choose Vehicle or saved)
+    if (FFAppState().selectvehicle.isNotEmpty) {
+      setState(() {
+        _selectedVehicleType = FFAppState().selectvehicle;
+        _selectedVehicleTypeId = FFAppState().adminVehicleId;
+      });
+    } else if (FFAppState().vehicleType.isNotEmpty) {
+      setState(() {
+        _selectedVehicleType = FFAppState().vehicleType;
+        _selectedVehicleTypeId = FFAppState().adminVehicleId;
+      });
     }
     if (FFAppState().vehicleMake.isNotEmpty) {
       _makeController.text = FFAppState().vehicleMake;
+      _vehicleNameController.text = FFAppState().vehicleMake;
+    } else if (FFAppState().vehicleName.isNotEmpty) {
+      _makeController.text = FFAppState().vehicleName;
+      _vehicleNameController.text = FFAppState().vehicleName;
     }
-    if (FFAppState().vehicleModel.isNotEmpty) {
-      _modelController.text = FFAppState().vehicleModel;
+    if (FFAppState().vehicleModel.isNotEmpty) _modelController.text = FFAppState().vehicleModel;
+    if (FFAppState().vehicleYear.isNotEmpty) _yearController.text = FFAppState().vehicleYear;
+    if (FFAppState().vehicleColor.isNotEmpty) setState(() => _selectedColor = FFAppState().vehicleColor);
+    if (FFAppState().licensePlate.isNotEmpty) _licensePlateController.text = FFAppState().licensePlate;
+    if (FFAppState().registrationNumber.isNotEmpty) _regNumberController.text = FFAppState().registrationNumber;
+    if (FFAppState().registrationDate.isNotEmpty) _regDateController.text = FFAppState().registrationDate;
+    if (FFAppState().insuranceNumber.isNotEmpty) _insuranceNumberController.text = FFAppState().insuranceNumber;
+    if (FFAppState().insuranceExpiryDate.isNotEmpty) _insuranceExpiryController.text = FFAppState().insuranceExpiryDate;
+    if (FFAppState().pollutionExpiryDate.isNotEmpty) _pollutionExpiryController.text = FFAppState().pollutionExpiryDate;
+    if (FFAppState().vehicleName.isNotEmpty) _vehicleNameController.text = FFAppState().vehicleName;
+
+    // Pollution Image
+    if (FFAppState().pollutionBase64.isNotEmpty) {
+      try {
+        Uint8List bytes = base64Decode(FFAppState().pollutionBase64);
+        setState(() {
+          _pollutionImage = FFUploadedFile(bytes: bytes, name: 'pollution.jpg');
+          _isPollutionValid = true;
+        });
+      } catch (e) { print('Pollution decode error: $e'); }
+    } else if (FFAppState().pollutioncertificateImage?.bytes != null &&
+        FFAppState().pollutioncertificateImage!.bytes!.isNotEmpty) {
+      setState(() {
+        _pollutionImage = FFAppState().pollutioncertificateImage;
+        _isPollutionValid = true;
+      });
     }
-    if (FFAppState().vehicleYear.isNotEmpty) {
-      _yearController.text = FFAppState().vehicleYear;
-    }
-    if (FFAppState().vehicleColor.isNotEmpty) {
-      setState(() => _selectedColor = FFAppState().vehicleColor);
+
+    // Insurance Image
+    if (FFAppState().insuranceBase64.isNotEmpty) {
+      try {
+        Uint8List bytes = base64Decode(FFAppState().insuranceBase64);
+        setState(() {
+          _insuranceImage = FFUploadedFile(bytes: bytes, name: 'insurance.jpg');
+          _isInsuranceValid = true;
+        });
+      } catch (e) { print('Insurance decode error: $e'); }
+    } else if (FFAppState().insuranceImage?.bytes != null &&
+        FFAppState().insuranceImage!.bytes!.isNotEmpty) {
+      setState(() {
+        _insuranceImage = FFAppState().insuranceImage;
+        _isInsuranceValid = true;
+      });
     }
   }
 
@@ -113,34 +174,34 @@
     _makeController.dispose();
     _modelController.dispose();
     _yearController.dispose();
+    _licensePlateController.dispose();
+    _regNumberController.dispose();
+    _regDateController.dispose();
+    _insuranceNumberController.dispose();
+    _insuranceExpiryController.dispose();
+    _pollutionExpiryController.dispose();
+    _vehicleNameController.dispose();
     super.dispose();
   }
 
   void _showSnackBar(String message, {bool isError = false}) {
-    ScaffoldMessenger.of(context).showSnackBar(
-      SnackBar(
-        content: Row(
-          children: [
-            Icon(
-              isError ? Icons.error_outline : Icons.check_circle,
-              color: Colors.white,
-              size: 20,
-            ),
-            const SizedBox(width: 10),
-            Expanded(
-              child: Text(message, style: const TextStyle(fontSize: 14)),
-            ),
-          ],
-        ),
-        backgroundColor: isError ? Colors.red[400] : Colors.green[500],
-        behavior: SnackBarBehavior.floating,
-        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
-        margin: const EdgeInsets.all(16),
-        duration: const Duration(seconds: 3),
-      ),
-    );
+    ScaffoldMessenger.of(context).showSnackBar(SnackBar(
+      content: Row(children: [
+        Icon(isError ? Icons.error_outline : Icons.check_circle, color: AppColors.white, size: 20),
+        const SizedBox(width: 10),
+        Expanded(child: Text(message, style: const TextStyle(fontSize: 14, fontWeight: FontWeight.w500))),
+      ]),
+      backgroundColor: isError ? AppColors.error : AppColors.success,
+      behavior: SnackBarBehavior.floating,
+      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
+      margin: const EdgeInsets.all(16),
+      duration: const Duration(seconds: 3),
+    ));
   }
 
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  BUILD
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   @override
   Widget build(BuildContext context) {
     bool hasImage = (_vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty);
@@ -149,9 +210,9 @@
       onTap: () => FocusScope.of(context).unfocus(),
       child: Scaffold(
         key: scaffoldKey,
-        backgroundColor: AppColors.backgroundLight,
+          backgroundColor: AppColors.backgroundLight,
         appBar: AppBar(
-          backgroundColor: Colors.white,
+          backgroundColor: AppColors.white,
           elevation: 0,
           leading: IconButton(
             icon: const Icon(Icons.arrow_back, color: AppColors.textDark),
@@ -177,82 +238,39 @@
                 child: Column(
                   crossAxisAlignment: CrossAxisAlignment.start,
                   children: [
-                    // Vehicle Type
-                    const Text(
-                      'Vehicle Type',
-                      style: TextStyle(
-                        fontSize: 16,
-                        fontWeight: FontWeight.w600,
-                        color: AppColors.textDark,
-                      ),
-                    ),
-                    const SizedBox(height: 12),
-                    _buildVehicleTypeGrid(),
-
-                    const SizedBox(height: 24),
-
-                    // Make
-                    _buildSimpleTextField(
-                      controller: _makeController,
-                      label: 'Vehicle Make',
-                      hint: 'e.g., Toyota, Honda',
-                      icon: Icons.directions_car,
-                    ),
-
+                    _buildVehicleMakeDropdown(),
+                    const SizedBox(height: 20),
+                    _buildVehicleModelDropdown(),
+                    const SizedBox(height: 20),
+                    const Text('Vehicle Color', style: TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
+                    const SizedBox(height: 8),
+                    _buildColorGrid(),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _licensePlateController, label: 'License Plate', hint: 'e.g., AP01AB1234', icon: Icons.badge, stateKey: 'licensePlate'),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _regNumberController, label: 'Registration Number', hint: 'RC number', icon: Icons.description, stateKey: 'registrationNumber'),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _regDateController, label: 'Registration Date', hint: 'YYYY-MM-DD', icon: Icons.calendar_today, stateKey: 'registrationDate', keyboardType: TextInputType.datetime),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _insuranceNumberController, label: 'Insurance Number', hint: 'Policy number', icon: Icons.security, stateKey: 'insuranceNumber'),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _insuranceExpiryController, label: 'Insurance Expiry', hint: 'YYYY-MM-DD', icon: Icons.event, stateKey: 'insuranceExpiryDate', keyboardType: TextInputType.datetime),
                     const SizedBox(height: 20),
-
-                    // Model
-                    _buildSimpleTextField(
-                      controller: _modelController,
-                      label: 'Vehicle Model',
-                      hint: 'e.g., Camry, Civic',
-                      icon: Icons.car_rental,
-                    ),
-
+                    _buildSimpleTextField(controller: _pollutionExpiryController, label: 'Pollution Certificate Expiry', hint: 'YYYY-MM-DD', icon: Icons.eco, stateKey: 'pollutionExpiryDate', keyboardType: TextInputType.datetime),
                     const SizedBox(height: 20),
-
-                    // Year
-                    _buildSimpleTextField(
-                      controller: _yearController,
-                      label: 'Year',
-                      hint: 'e.g., 2023',
-                      icon: Icons.calendar_today,
-                      keyboardType: TextInputType.number,
-                    ),
-
+                    const Text('Vehicle Photo', style: TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
+                    const SizedBox(height: 12),
+                    _buildPhotoUpload(hasImage),
                     const SizedBox(height: 24),
-
-                    // Color
-                    const Text(
-                      'Vehicle Color',
-                      style: TextStyle(
-                        fontSize: 16,
-                        fontWeight: FontWeight.w600,
-                        color: AppColors.textDark,
-                      ),
-                    ),
+                    const Text('Pollution Certificate', style: TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
                     const SizedBox(height: 12),
-                    _buildColorGrid(),
-
+                    _buildExtraImageUpload(image: _pollutionImage, isValid: _isPollutionValid, onImageSelected: _onPollutionSelected),
                     const SizedBox(height: 24),
-
-                    // Photo Upload
-                    const Text(
-                      'Vehicle Photo',
-                      style: TextStyle(
-                        fontSize: 16,
-                        fontWeight: FontWeight.w600,
-                        color: AppColors.textDark,
-                      ),
-                    ),
+                    const Text('Insurance Document', style: TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
                     const SizedBox(height: 12),
-                    _buildPhotoUpload(hasImage),
-
+                    _buildExtraImageUpload(image: _insuranceImage, isValid: _isInsuranceValid, onImageSelected: _onInsuranceSelected),
                     const SizedBox(height: 32),
-
-                    // Submit Button
                     _buildSubmitButton(hasImage),
-
                     const SizedBox(height: 20),
                   ],
                 ),
@@ -264,128 +282,230 @@
     );
   }
 
-  Widget _buildVehicleTypeGrid() {
-    return GridView.builder(
-      shrinkWrap: true,
-      physics: const NeverScrollableScrollPhysics(),
-      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
-        crossAxisCount: 4,
-        crossAxisSpacing: 12,
-        mainAxisSpacing: 12,
-        childAspectRatio: 1,
-      ),
-      itemCount: vehicleTypes.length,
-      itemBuilder: (context, index) {
-        final type = vehicleTypes[index];
-        bool isSelected = _selectedVehicleType == type['name'];
-
-        return GestureDetector(
-          onTap: () {
-            setState(() => _selectedVehicleType = type['name']);
-            FFAppState().vehicleType = type['name'];
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  HERO PHOTO SECTION
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildHeroPhotoSection(bool hasImage) {
+    return GestureDetector(
+      onTap: () async {
+        final selectedMedia = await selectMediaWithSourceBottomSheet(context: context, allowPhoto: true);
+        if (selectedMedia != null && selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {
+          var files = <FFUploadedFile>[];
+          try {
+            files = selectedMedia.map((m) => FFUploadedFile(
+              name: m.storagePath.split('/').last,
+              bytes: m.bytes,
+              height: m.dimensions?.height,
+              width: m.dimensions?.width,
+              blurHash: m.blurHash,
+              originalFilename: m.originalFilename,
+            )).toList();
+          } catch (e) { print('Error: $e'); }
+          if (files.isNotEmpty) {
+            setState(() {
+              _vehicleImage = files.first;
+              _model.uploadedLocalFile_uploadData69q = _vehicleImage!;
+              _isVehicleImageValid = true;
+            });
+            FFAppState().vehicleImage = _vehicleImage;
+            if (_vehicleImage?.bytes != null) FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);
             FFAppState().update(() {});
-          },
-          child: AnimatedContainer(
-            duration: const Duration(milliseconds: 200),
-            decoration: BoxDecoration(
-              color: isSelected ? type['color'] : Colors.white,
-              borderRadius: BorderRadius.circular(16),
-              border: Border.all(
-                color: isSelected ? type['color'] : AppColors.greyBorder,
-                width: 2,
-              ),
-              boxShadow: [
-                if (isSelected)
-                  BoxShadow(
-                    color: type['color'].withValues(alpha:0.3),
-                    blurRadius: 8,
-                    offset: const Offset(0, 4),
-                  ),
-              ],
-            ),
-            child: Column(
-              mainAxisAlignment: MainAxisAlignment.center,
-              children: [
-                Text(
-                  type['icon'],
-                  style: const TextStyle(fontSize: 32),
-                ),
-                const SizedBox(height: 4),
-                Text(
-                  type['name'],
-                  style: TextStyle(
-                    fontSize: 11,
-                    fontWeight: FontWeight.w600,
-                    color: isSelected ? Colors.white : AppColors.greySlate,
+            _showSnackBar('Vehicle photo uploaded!');
+          }
+        }
+      },
+      child: AnimatedContainer(
+        duration: const Duration(milliseconds: 400),
+        margin: const EdgeInsets.fromLTRB(20, 16, 20, 0),
+        height: 220,
+        decoration: BoxDecoration(
+          borderRadius: BorderRadius.circular(24),
+          border: Border.all(
+            color: hasImage ? AppColors.primary : AppColors.greyBorder,
+            width: hasImage ? 2.5 : 1,
+          ),
+          boxShadow: [
+            BoxShadow(
+              color: hasImage ? AppColors.primary.withOpacity(0.35) : AppColors.black.withOpacity(0.38),
+              blurRadius: 24,
+              offset: const Offset(0, 10),
+            ),
+          ],
+        ),
+        child: Stack(
+          children: [
+            // Image or placeholder
+            ClipRRect(
+              borderRadius: BorderRadius.circular(22),
+              child: hasImage
+                  ? Image.memory(_vehicleImage!.bytes!, fit: BoxFit.cover, width: double.infinity, height: double.infinity)
+                  : Center(
+                child: Column(
+                  mainAxisAlignment: MainAxisAlignment.center,
+                  children: [
+                    Container(
+                      padding: const EdgeInsets.all(22),
+                      decoration: BoxDecoration(
+                        color: AppColors.primary.withOpacity(0.15),
+                        shape: BoxShape.circle,
+                        border: Border.all(color: AppColors.primary.withOpacity(0.4), width: 2),
+                      ),
+                      child: const Icon(Icons.camera_alt_rounded, size: 48, color: AppColors.primary),
+                    ),
+                    const SizedBox(height: 14),
+                    const Text('Upload Vehicle Photo',
+                        style: TextStyle(color: AppColors.textDark, fontWeight: FontWeight.w700, fontSize: 16)),
+                    const SizedBox(height: 4),
+                    Text('Camera or Gallery',
+                        style: TextStyle(color: _textMuted, fontSize: 13)),
+                  ],
+                ),
+              ),
+            ),
+
+            // Gradient overlay on image
+            if (hasImage)
+              Positioned(
+                bottom: 0, left: 0, right: 0,
+                child: Container(
+                  height: 70,
+                  decoration: BoxDecoration(
+                    borderRadius: const BorderRadius.vertical(bottom: Radius.circular(22)),
+                    gradient: LinearGradient(
+                      colors: [Colors.transparent, AppColors.black.withOpacity(0.6)],
+                      begin: Alignment.topCenter,
+                      end: Alignment.bottomCenter,
+                    ),
                   ),
+                  child: Align(
+                    alignment: Alignment.bottomLeft,
+                    child: Padding(
+                      padding: const EdgeInsets.all(12),
+                      child: Row(children: [
+                        Icon(Icons.edit_rounded, color: AppColors.white.withOpacity(0.9), size: 16),
+                        const SizedBox(width: 4),
+                        Text('Tap to change', style: TextStyle(color: AppColors.white.withOpacity(0.9), fontSize: 12)),
+                      ]),
+                    ),
+                  ),
                 ),
-              ],
-            ),
-          ),
-        );
-      },
+              ),
+
+            // Uploaded badge
+            if (hasImage && _isVehicleImageValid)
+              Positioned(
+                top: 12, left: 12,
+                child: Container(
+                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
+                  decoration: BoxDecoration(
+                    color: _primary,
+                    borderRadius: BorderRadius.circular(20),
+                    boxShadow: [BoxShadow(color: _primary.withOpacity(0.5), blurRadius: 8)],
+                  ),
+                  child: const Row(
+                    mainAxisSize: MainAxisSize.min,
+                    children: [
+                      Icon(Icons.check_circle, color: AppColors.white, size: 14),
+                      SizedBox(width: 4),
+                      Text('Uploaded', style: TextStyle(color: AppColors.white, fontSize: 11, fontWeight: FontWeight.w700)),
+                    ],
+                  ),
+                ),
+              ),
+
+            // Remove button
+            if (hasImage)
+              Positioned(
+                top: 12, right: 12,
+                child: GestureDetector(
+                  onTap: () {
+                    setState(() { _vehicleImage = null; _isVehicleImageValid = false; });
+                    FFAppState().vehicleImage = null;
+                    FFAppState().vehicleBase64 = '';
+                    FFAppState().update(() {});
+                    _showSnackBar('Photo removed', isError: true);
+                  },
+                  child: Container(
+                    padding: const EdgeInsets.all(8),
+                    decoration: BoxDecoration(
+                      color: AppColors.error,
+                      shape: BoxShape.circle,
+                      boxShadow: [BoxShadow(color: AppColors.black.withOpacity(0.2), blurRadius: 8)],
+                    ),
+                    child: const Icon(Icons.close, color: AppColors.white, size: 18),
+                  ),
+                ),
+              ),
+          ],
+        ),
+      ),
     );
   }
+
+  void _onPollutionSelected(FFUploadedFile? file) {
+    setState(() { _pollutionImage = file; _isPollutionValid = file != null; });
+    FFAppState().pollutionImage = file;
+    if (file?.bytes != null) FFAppState().pollutionBase64 = base64Encode(file!.bytes!);
+    else FFAppState().pollutionBase64 = '';
+    FFAppState().update(() {});
+  }
+
+  void _onInsuranceSelected(FFUploadedFile? file) {
+    setState(() { _insuranceImage = file; _isInsuranceValid = file != null; });
+    FFAppState().insuranceImage = file;
+    if (file?.bytes != null) FFAppState().insuranceBase64 = base64Encode(file!.bytes!);
+    else FFAppState().insuranceBase64 = '';
+    FFAppState().update(() {});
+  }
 
   Widget _buildSimpleTextField({
     required TextEditingController controller,
     required String label,
     required String hint,
     required IconData icon,
+    String? stateKey,
     TextInputType keyboardType = TextInputType.text,
   }) {
     return Column(
       crossAxisAlignment: CrossAxisAlignment.start,
       children: [
-        Text(
-          label,
-          style: const TextStyle(
-            fontSize: 16,
-            fontWeight: FontWeight.w600,
-            color: AppColors.textDark,
-          ),
-        ),
+        Text(label, style: const TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
         const SizedBox(height: 8),
         Container(
           decoration: BoxDecoration(
-            color: Colors.white,
+            color: AppColors.white,
             borderRadius: BorderRadius.circular(12),
             border: Border.all(
-              color: controller.text.isNotEmpty ? AppColors.accentIndigo : AppColors.greyBorder,
-              width: 2,
+              color: controller.text.isNotEmpty ? _primary : AppColors.greyBorder,
+              width: 1.5,
             ),
           ),
           child: TextField(
             controller: controller,
             keyboardType: keyboardType,
-            style: const TextStyle(
-              fontSize: 15,
-              fontWeight: FontWeight.w500,
-              color: AppColors.textDark,
-            ),
+            style: const TextStyle(fontSize: 15, fontWeight: FontWeight.w500, color: AppColors.textDark),
             decoration: InputDecoration(
               hintText: hint,
-              hintStyle: const TextStyle(
-                color: AppColors.greyLight,
-                fontSize: 15,
-              ),
-              prefixIcon: Icon(icon, color: AppColors.accentIndigo, size: 20),
-              suffixIcon: controller.text.isNotEmpty
-                  ? const Icon(Icons.check_circle, color: AppColors.accentEmerald, size: 20)
-                  : null,
+              hintStyle: TextStyle(color: AppColors.greyLight, fontSize: 15),
+              prefixIcon: Icon(icon, color: _primary, size: 20),
+              suffixIcon: controller.text.isNotEmpty ? Icon(Icons.check_circle, color: AppColors.success, size: 20) : null,
               border: InputBorder.none,
               contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 16),
             ),
             onChanged: (value) {
               setState(() {});
-              if (label == 'Vehicle Make') {
-                FFAppState().vehicleMake = value;
-              } else if (label == 'Vehicle Model') {
-                FFAppState().vehicleModel = value;
-              } else if (label == 'Year') {
-                FFAppState().vehicleYear = value;
-              }
-              FFAppState().update(() {});
+              if (stateKey != null) {
+                switch (stateKey) {
+                  case 'vehicleName':
+                    FFAppState().vehicleName = value;
+                    FFAppState().vehicleMake = value;
+                    break;
+                  case 'vehicleModel':
+                    FFAppState().vehicleModel = value;
+                    break;
+                }
+                FFAppState().update(() {});
+              }
             },
           ),
         ),
@@ -393,103 +513,132 @@
     );
   }
 
-  Widget _buildColorGrid() {
-    return Wrap(
-      spacing: 12,
-      runSpacing: 12,
-      children: vehicleColors.map((colorData) {
-        bool isSelected = _selectedColor == colorData['name'];
-        return GestureDetector(
-          onTap: () {
-            setState(() => _selectedColor = colorData['name']);
-            FFAppState().vehicleColor = colorData['name'];
-            FFAppState().update(() {});
+  Widget _buildVehicleMakeDropdown() {
+    return FutureBuilder<ApiCallResponse>(
+      future: GetVehicleMakesCall.call(),
+      builder: (context, snapshot) {
+        List<String> options = VehicleData.defaultMakes;
+        if (snapshot.hasData &&
+            snapshot.data?.statusCode == 200 &&
+            GetVehicleMakesCall.names(snapshot.data!.jsonBody) != null) {
+          final apiList = GetVehicleMakesCall.names(snapshot.data!.jsonBody)!;
+          if (apiList.isNotEmpty) options = apiList;
+        }
+        final value = _makeController.text;
+        if (value.isNotEmpty && !options.contains(value)) options = [value, ...options];
+        return _buildDropdownField(
+          label: 'Vehicle Name',
+          hint: 'Select make (e.g., Toyota, Honda)',
+          icon: Icons.directions_car,
+          value: value.isEmpty ? null : value,
+          items: options,
+          onChanged: (v) {
+            setState(() {
+              _makeController.text = v ?? '';
+              _vehicleNameController.text = _makeController.text;
+              FFAppState().vehicleMake = _makeController.text;
+              FFAppState().vehicleName = _makeController.text;
+              FFAppState().update(() {});
+            });
+          },
+        );
+      },
+    );
+  }
+
+  Widget _buildVehicleModelDropdown() {
+    return FutureBuilder<ApiCallResponse>(
+      key: ValueKey(_makeController.text),
+      future: GetVehicleModelsCall.call(makeName: _makeController.text),
+      builder: (context, snapshot) {
+        List<String> options = VehicleData.defaultModels;
+        if (snapshot.hasData &&
+            snapshot.data?.statusCode == 200 &&
+            GetVehicleModelsCall.names(snapshot.data!.jsonBody) != null) {
+          final apiList = GetVehicleModelsCall.names(snapshot.data!.jsonBody)!;
+          if (apiList.isNotEmpty) options = apiList;
+        }
+        final value = _modelController.text;
+        if (value.isNotEmpty && !options.contains(value)) options = [value, ...options];
+        return _buildDropdownField(
+          label: 'Vehicle Model',
+          hint: 'Select model (e.g., Camry, Civic)',
+          icon: Icons.car_rental,
+          value: value.isEmpty ? null : value,
+          items: options,
+          onChanged: (v) {
+            setState(() {
+              _modelController.text = v ?? '';
+              FFAppState().vehicleModel = _modelController.text;
+              FFAppState().update(() {});
+            });
           },
-          child: AnimatedContainer(
-            duration: const Duration(milliseconds: 200),
-            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),
-            decoration: BoxDecoration(
-              color: isSelected ? AppColors.accentIndigo.withValues(alpha:0.1) : Colors.white,
-              borderRadius: BorderRadius.circular(12),
-              border: Border.all(
-                color: isSelected ? AppColors.accentIndigo : AppColors.greyBorder,
-                width: 2,
-              ),
-            ),
-            child: Row(
-              mainAxisSize: MainAxisSize.min,
-              children: [
-                Container(
-                  width: 24,
-                  height: 24,
-                  decoration: BoxDecoration(
-                    color: colorData['color'],
-                    shape: BoxShape.circle,
-                    border: Border.all(
-                      color: colorData['border'],
-                      width: 2,
-                    ),
-                  ),
-                ),
-                const SizedBox(width: 8),
-                Text(
-                  colorData['name'],
-                  style: TextStyle(
-                    fontSize: 14,
-                    fontWeight: FontWeight.w500,
-                    color: isSelected ? AppColors.accentIndigo : AppColors.greySlate,
-                  ),
-                ),
-                if (isSelected) ...[
-                  const SizedBox(width: 6),
-                  const Icon(Icons.check, size: 16, color: AppColors.accentIndigo),
-                ],
-              ],
-            ),
-          ),
-        );
-      }).toList(),
+        );
+      },
+    );
+  }
+
+  Widget _buildDropdownField({
+    required String label,
+    required String hint,
+    required IconData icon,
+    required String? value,
+    required List<String> items,
+    required ValueChanged<String?> onChanged,
+  }) {
+    return Column(
+      crossAxisAlignment: CrossAxisAlignment.start,
+      children: [
+        Text(label, style: const TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
+        const SizedBox(height: 8),
+        Container(
+          decoration: BoxDecoration(
+            color: AppColors.white,
+            borderRadius: BorderRadius.circular(12),
+            border: Border.all(
+              color: (value != null && value.isNotEmpty) ? _primary : AppColors.greyBorder,
+              width: 1.5,
+            ),
+          ),
+          child: DropdownButtonFormField<String>(
+            value: (value != null && value.isNotEmpty && items.contains(value)) ? value : null,
+            decoration: InputDecoration(
+              hintText: hint,
+              hintStyle: const TextStyle(color: AppColors.greyLight, fontSize: 15),
+              prefixIcon: Icon(icon, color: _primary, size: 20),
+              suffixIcon: (value != null && value.isNotEmpty) ? const Icon(Icons.check_circle, color: AppColors.success, size: 20) : null,
+              border: InputBorder.none,
+              contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
+            ),
+            icon: const Icon(Icons.keyboard_arrow_down, color: AppColors.greySlate),
+            dropdownColor: AppColors.white,
+            isExpanded: true,
+            items: items.map((s) => DropdownMenuItem<String>(value: s, child: Text(s, style: const TextStyle(fontSize: 15, color: AppColors.textDark)))).toList(),
+            onChanged: onChanged,
+          ),
+        ),
+      ],
     );
   }
 
   Widget _buildPhotoUpload(bool hasImage) {
     return GestureDetector(
       onTap: () async {
-        final selectedMedia = await selectMediaWithSourceBottomSheet(
-          context: context,
-          allowPhoto: true,
-        );
-        if (selectedMedia != null &&
-            selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {
-          var selectedUploadedFiles = <FFUploadedFile>[];
+        final selectedMedia = await selectMediaWithSourceBottomSheet(context: context, allowPhoto: true);
+        if (selectedMedia != null && selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {
           try {
-            selectedUploadedFiles = selectedMedia
-                .map((m) => FFUploadedFile(
-              name: m.storagePath.split('/').last,
-              bytes: m.bytes,
-              height: m.dimensions?.height,
-              width: m.dimensions?.width,
-              blurHash: m.blurHash,
-              originalFilename: m.originalFilename,
-            ))
-                .toList();
-          } catch (e) {
-            print('âŒ Error: $e');
-          }
-          if (selectedUploadedFiles.isNotEmpty) {
-            setState(() {
-              _vehicleImage = selectedUploadedFiles.first;
-              _model.uploadedLocalFile_uploadData69q = _vehicleImage!;
-              _isVehicleImageValid = true;
-            });
-
-            FFAppState().vehicleImage = _vehicleImage;
-            if (_vehicleImage?.bytes != null) {
-              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);
-            }
+            final file = FFUploadedFile(
+              name: selectedMedia.first.storagePath.split('/').last,
+              bytes: selectedMedia.first.bytes,
+              height: selectedMedia.first.dimensions?.height,
+              width: selectedMedia.first.dimensions?.width,
+            );
+            setState(() { _vehicleImage = file; _isVehicleImageValid = true; _model.uploadedLocalFile_uploadData69q = file; });
+            FFAppState().vehicleImage = file;
+            if (file.bytes != null) FFAppState().vehicleBase64 = base64Encode(file.bytes!);
             FFAppState().update(() {});
             _showSnackBar('Photo uploaded successfully! âœ“');
-          }
+          } catch (e) { print('Error: $e'); }
         }
       },
       child: AnimatedContainer(
@@ -497,72 +646,52 @@
         width: double.infinity,
         height: 200,
         decoration: BoxDecoration(
-          color: hasImage ? null : Colors.white,
+          color: AppColors.white,
           borderRadius: BorderRadius.circular(16),
-          border: Border.all(
-            color: hasImage ? AppColors.accentEmerald : AppColors.greyBorder,
-            width: 2,
-          ),
+          border: Border.all(color: hasImage ? _primary : AppColors.greyBorder, width: 1.5),
         ),
         child: Stack(
           children: [
             ClipRRect(
               borderRadius: BorderRadius.circular(14),
               child: _vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty
-                  ? Image.memory(
-                _vehicleImage!.bytes!,
-                width: double.infinity,
-                height: double.infinity,
-                fit: BoxFit.cover,
-              )
+                  ? Image.memory(_vehicleImage!.bytes!, fit: BoxFit.cover, width: double.infinity, height: double.infinity)
                   : Center(
                 child: Column(
                   mainAxisAlignment: MainAxisAlignment.center,
                   children: [
                     Container(
                       padding: const EdgeInsets.all(16),
-                      decoration: BoxDecoration(
-                        color: AppColors.accentIndigo.withValues(alpha:0.1),
-                        shape: BoxShape.circle,
-                      ),
-                      child: const Icon(
-                        Icons.add_photo_alternate,
-                        size: 40,
-                        color: AppColors.accentIndigo,
-                      ),
+                      decoration: BoxDecoration(color: AppColors.sectionOrangeLight, shape: BoxShape.circle),
+                      child: Icon(Icons.add_photo_alternate, size: 40, color: _primary),
                     ),
                     const SizedBox(height: 12),
-                    const Text(
-                      'Tap to upload photo',
-                      style: TextStyle(
-                        fontSize: 15,
-                        fontWeight: FontWeight.w600,
-                        color: AppColors.greySlate,
-                      ),
-                    ),
+                    Text('Tap to upload photo', style: TextStyle(fontSize: 15, fontWeight: FontWeight.w600, color: AppColors.greySlate)),
                     const SizedBox(height: 4),
-                    const Text(
-                      'Camera or Gallery',
-                      style: TextStyle(
-                        fontSize: 13,
-                        color: AppColors.greyLight,
-                      ),
-                    ),
-                  ],
-                ),
-              ),
-            ),
-
+                    Text('Camera or Gallery', style: TextStyle(fontSize: 13, color: AppColors.greyLight)),
+                  ],
+                ),
+              ),
+            ),
+            if (hasImage && _isVehicleImageValid)
+              Positioned(
+                top: 12, left: 12,
+                child: Container(
+                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
+                  decoration: BoxDecoration(color: _primary, borderRadius: BorderRadius.circular(20)),
+                  child: Row(mainAxisSize: MainAxisSize.min, children: [
+                    Icon(Icons.check_circle, color: AppColors.white, size: 14),
+                    SizedBox(width: 4),
+                    Text('Uploaded', style: TextStyle(color: AppColors.white, fontSize: 11, fontWeight: FontWeight.w700)),
+                  ]),
+                ),
+              ),
             if (hasImage)
               Positioned(
-                top: 8,
-                right: 8,
+                top: 12, right: 12,
                 child: GestureDetector(
                   onTap: () {
-                    setState(() {
-                      _vehicleImage = null;
-                      _isVehicleImageValid = false;
-                    });
+                    setState(() { _vehicleImage = null; _isVehicleImageValid = false; });
                     FFAppState().vehicleImage = null;
                     FFAppState().vehicleBase64 = '';
                     FFAppState().update(() {});
@@ -570,141 +699,638 @@
                   },
                   child: Container(
                     padding: const EdgeInsets.all(8),
-                    decoration: BoxDecoration(
-                      color: Colors.red[400],
-                      shape: BoxShape.circle,
-                      boxShadow: const [
-                        BoxShadow(
-                          color: Colors.black26,
-                          blurRadius: 4,
-                          offset: Offset(0, 2),
-                        ),
-                      ],
-                    ),
-                    child: const Icon(Icons.close, color: Colors.white, size: 18),
-                  ),
-                ),
+                    decoration: BoxDecoration(color: AppColors.error, shape: BoxShape.circle),
+                    child: const Icon(Icons.close, color: AppColors.white, size: 18),
+                  ),
+                ),
+              ),
+          ],
+        ),
+      ),
+    );
+  }
+
+  Widget _buildExtraImageUpload({
+    required FFUploadedFile? image,
+    required bool isValid,
+    required Function(FFUploadedFile?) onImageSelected,
+  }) {
+    bool hasImage = (image?.bytes != null && image!.bytes!.isNotEmpty);
+    return GestureDetector(
+      onTap: () async {
+        final selectedMedia = await selectMediaWithSourceBottomSheet(context: context, allowPhoto: true);
+        if (selectedMedia != null && selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {
+          final file = FFUploadedFile(name: selectedMedia.first.storagePath.split('/').last, bytes: selectedMedia.first.bytes);
+          onImageSelected(file);
+          _showSnackBar('Photo uploaded successfully! âœ“');
+        }
+      },
+      child: Container(
+        width: double.infinity,
+        height: 180,
+        decoration: BoxDecoration(
+          color: AppColors.white,
+          borderRadius: BorderRadius.circular(16),
+          border: Border.all(color: hasImage ? _primary : AppColors.greyBorder, width: 1.5),
+        ),
+        child: hasImage
+            ? ClipRRect(
+                borderRadius: BorderRadius.circular(14),
+                child: Image.memory(image!.bytes!, fit: BoxFit.cover, width: double.infinity, height: double.infinity),
+              )
+            : Center(
+                child: Column(
+                  mainAxisAlignment: MainAxisAlignment.center,
+                  children: [
+                    Container(
+                      padding: const EdgeInsets.all(16),
+                      decoration: BoxDecoration(color: AppColors.sectionOrangeLight, shape: BoxShape.circle),
+                      child: Icon(Icons.add_photo_alternate, size: 40, color: _primary),
+                    ),
+                    SizedBox(height: 12),
+                    Text('Tap to upload', style: TextStyle(fontWeight: FontWeight.w600, color: AppColors.greySlate, fontSize: 15)),
+                  ],
+                ),
+              ),
+      ),
+    );
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  SECTION LABEL
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _sectionLabel(String title, IconData icon) {
+    return Row(children: [
+      Container(
+        padding: const EdgeInsets.all(8),
+        decoration: BoxDecoration(
+          color: AppColors.sectionOrangeLight,
+          borderRadius: BorderRadius.circular(10),
+        ),
+        child: Icon(icon, color: _primary, size: 18),
+      ),
+      const SizedBox(width: 10),
+      Text(title, style: const TextStyle(
+        color: AppColors.textDark, fontSize: 18, fontWeight: FontWeight.w700, letterSpacing: 0.2,
+      )),
+    ]);
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  GLASSMORPHISM CARD
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildCard({
+    required String title,
+    required IconData icon,
+    required List<Widget> children,
+    Color accentColor = _primary,
+  }) {
+    return Container(
+      decoration: BoxDecoration(
+        color: AppColors.white,
+        borderRadius: BorderRadius.circular(24),
+        border: Border.all(color: AppColors.greyBorder, width: 1),
+        boxShadow: [
+          BoxShadow(color: AppColors.black.withOpacity(0.06), blurRadius: 12, offset: const Offset(0, 4)),
+        ],
+      ),
+      child: Column(
+        crossAxisAlignment: CrossAxisAlignment.start,
+        children: [
+          // Card Header
+          Container(
+            padding: const EdgeInsets.fromLTRB(20, 18, 20, 14),
+            decoration: BoxDecoration(
+              color: AppColors.sectionOrangeLight.withOpacity(0.3),
+              borderRadius: const BorderRadius.vertical(top: Radius.circular(24)),
+              border: Border(bottom: BorderSide(color: AppColors.greyBorder)),
+            ),
+            child: Row(children: [
+              Container(
+                padding: const EdgeInsets.all(8),
+                decoration: BoxDecoration(
+                  color: AppColors.sectionOrangeLight,
+                  borderRadius: BorderRadius.circular(10),
+                ),
+                child: Icon(icon, color: accentColor, size: 18),
+              ),
+              const SizedBox(width: 10),
+              Text(title, style: const TextStyle(
+                color: AppColors.textDark, fontSize: 16, fontWeight: FontWeight.w700,
+              )),
+            ]),
+          ),
+          // Card Content
+          Padding(
+            padding: const EdgeInsets.fromLTRB(20, 16, 20, 20),
+            child: Column(children: children),
+          ),
+        ],
+      ),
+    );
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  VIBRANT TEXT FIELD
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildVibrantField({
+    required TextEditingController controller,
+    required String label,
+    required String hint,
+    required IconData icon,
+    TextInputType keyboardType = TextInputType.text,
+    String? stateKey,
+  }) {
+    bool isFilled = controller.text.isNotEmpty;
+    return Padding(
+      padding: const EdgeInsets.only(bottom: 16),
+      child: Column(
+        crossAxisAlignment: CrossAxisAlignment.start,
+        children: [
+          Text(label, style: TextStyle(
+            color: isFilled ? _primary : _textMuted,
+            fontSize: 12,
+            fontWeight: FontWeight.w600,
+            letterSpacing: 0.5,
+          )),
+          const SizedBox(height: 6),
+          Container(
+            decoration: BoxDecoration(
+              color: AppColors.backgroundCard,
+              borderRadius: BorderRadius.circular(16),
+              border: Border.all(
+                color: isFilled ? _primary : AppColors.greyBorder,
+                width: isFilled ? 1.5 : 1,
+              ),
+            ),
+            child: TextField(
+              controller: controller,
+              keyboardType: keyboardType,
+              style: const TextStyle(color: _textWhite, fontSize: 15, fontWeight: FontWeight.w500),
+              decoration: InputDecoration(
+                hintText: hint,
+                hintStyle: TextStyle(color: AppColors.greyLight, fontSize: 14),
+                prefixIcon: Icon(icon, color: isFilled ? _primary : _textMuted, size: 20),
+                suffixIcon: isFilled
+                    ? Icon(Icons.check_circle_rounded, color: AppColors.success, size: 20)
+                    : null,
+                border: InputBorder.none,
+                contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 16),
+              ),
+              onChanged: (value) {
+                setState(() {});
+                switch (stateKey) {
+                  case 'vehicleName': FFAppState().vehicleName = value; break;
+                  case 'vehicleMake': FFAppState().vehicleMake = value; break;
+                  case 'vehicleModel': FFAppState().vehicleModel = value; break;
+                  case 'vehicleYear': FFAppState().vehicleYear = value; break;
+                  case 'licensePlate': FFAppState().licensePlate = value; break;
+                  case 'registrationNumber': FFAppState().registrationNumber = value; break;
+                  case 'registrationDate': FFAppState().registrationDate = value; break;
+                  case 'insuranceNumber': FFAppState().insuranceNumber = value; break;
+                  case 'insuranceExpiryDate': FFAppState().insuranceExpiryDate = value; break;
+                  case 'pollutionExpiryDate': FFAppState().pollutionExpiryDate = value; break;
+                }
+                FFAppState().update(() {});
+              },
+            ),
+          ),
+        ],
+      ),
+    );
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  COLOR GRID
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildColorGrid() {
+    return Wrap(
+      spacing: 10,
+      runSpacing: 10,
+      children: vehicleColors.map((colorData) {
+        bool isSelected = _selectedColor == colorData['name'];
+        return GestureDetector(
+          onTap: () {
+            setState(() => _selectedColor = colorData['name']);
+            FFAppState().vehicleColor = colorData['name'];
+            FFAppState().update(() {});
+          },
+          child: AnimatedContainer(
+            duration: const Duration(milliseconds: 250),
+            curve: Curves.easeOutBack,
+            padding: const EdgeInsets.symmetric(horizontal: 14, vertical: 10),
+            decoration: BoxDecoration(
+              color: isSelected ? AppColors.sectionOrangeLight : AppColors.backgroundCard,
+              borderRadius: BorderRadius.circular(14),
+              border: Border.all(
+                color: isSelected ? _primary : AppColors.greyBorder,
+                width: isSelected ? 2 : 1,
+              ),
+              boxShadow: isSelected
+                  ? [BoxShadow(color: _primary.withOpacity(0.25), blurRadius: 10)]
+                  : [],
+            ),
+            child: Row(
+              mainAxisSize: MainAxisSize.min,
+              children: [
+                Container(
+                  width: 22, height: 22,
+                  decoration: BoxDecoration(
+                    color: colorData['color'],
+                    shape: BoxShape.circle,
+                    border: Border.all(color: colorData['border'], width: 2),
+                    boxShadow: [BoxShadow(color: AppColors.black.withOpacity(0.15), blurRadius: 4)],
+                  ),
+                ),
+                const SizedBox(width: 8),
+                Text(colorData['name'], style: TextStyle(
+                  fontSize: 13,
+                  fontWeight: FontWeight.w600,
+                  color: isSelected ? _primary : _textMuted,
+                )),
+                if (isSelected) ...[
+                  const SizedBox(width: 6),
+                  const Icon(Icons.check_rounded, size: 14, color: _primary),
+                ],
+              ],
+            ),
+          ),
+        );
+      }).toList(),
+    );
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  VEHICLE TYPE FROM API
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildVehicleTypeFromApi() {
+    return FutureBuilder<ApiCallResponse>(
+      future: ChoosevehicleCall.call(),
+      builder: (context, snapshot) {
+        if (!snapshot.hasData) {
+          return Container(
+            height: 80,
+            decoration: BoxDecoration(
+              color: _cardBg,
+              borderRadius: BorderRadius.circular(16),
+              border: Border.all(color: AppColors.greyBorder),
+            ),
+            child: Center(child: SizedBox(
+              width: 28, height: 28,
+              child: CircularProgressIndicator(strokeWidth: 2.5, valueColor: AlwaysStoppedAnimation<Color>(_primary)),
+            )),
+          );
+        }
+        if (snapshot.hasError || snapshot.data?.statusCode != 200) {
+          return Container(
+            padding: const EdgeInsets.all(20),
+            decoration: BoxDecoration(color: _cardBg, borderRadius: BorderRadius.circular(16), border: Border.all(color: AppColors.greyBorder)),
+            child: Row(children: [
+              Icon(Icons.cloud_off_rounded, color: AppColors.greySlate, size: 28),
+              const SizedBox(width: 12),
+              Expanded(child: Text('Could not load vehicle types', style: TextStyle(color: AppColors.greySlate, fontSize: 14))),
+              TextButton(
+                onPressed: () => setState(() {}),
+                child: Text('Retry', style: TextStyle(color: _primary, fontWeight: FontWeight.w700)),
               ),
+            ]),
+          );
+        }
+        final rawList = ChoosevehicleCall.data(snapshot.data!.jsonBody);
+        final list = (rawList is List) ? rawList : [];
+        if (list.isEmpty) {
+          return Container(
+            padding: const EdgeInsets.all(20),
+            decoration: BoxDecoration(color: _cardBg, borderRadius: BorderRadius.circular(16), border: Border.all(color: AppColors.greyBorder)),
+            child: Text('No vehicle types available', style: TextStyle(color: AppColors.greySlate, fontSize: 14)),
+          );
+        }
+        return ListView.separated(
+          shrinkWrap: true,
+          physics: const NeverScrollableScrollPhysics(),
+          itemCount: list.length,
+          separatorBuilder: (_, __) => const SizedBox(height: 12),
+          itemBuilder: (context, index) {
+            final item = list[index];
+            String name = '';
+            int id = 0;
+            String? imagePath;
+            if (item is Map) {
+              name = item['name']?.toString() ?? '';
+              id = castToType<int>(item['id']) ?? 0;
+              imagePath = item['image']?.toString();
+            } else {
+              name = getJsonField(item, r'$["name"]')?.toString() ?? '';
+              id = castToType<int>(getJsonField(item, r'$["id"]')) ?? 0;
+              imagePath = getJsonField(item, r'$["image"]')?.toString();
+            }
+            if (name.isEmpty) name = 'Unknown';
+            final imageUrl = (imagePath != null && imagePath.isNotEmpty && imagePath != 'null')
+                ? (imagePath.startsWith('http') ? imagePath : '${app_config.Config.baseUrl}${imagePath.startsWith('/') ? imagePath : '/$imagePath'}')
+                : null;
+            final isSelected = (_selectedVehicleType != null && _selectedVehicleType!.toLowerCase() == name.toLowerCase()) || _selectedVehicleTypeId == id;
+            return _buildVehicleTypeCard(name, id, imageUrl, isSelected);
+          },
+        );
+      },
+    );
+  }
 
-            if (hasImage && _isVehicleImageValid)
-              Positioned(
-                top: 8,
-                left: 8,
-                child: Container(
-                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
-                  decoration: BoxDecoration(
-                    color: AppColors.accentEmerald,
-                    borderRadius: BorderRadius.circular(20),
-                    boxShadow: const [
-                      BoxShadow(
-                        color: Colors.black26,
-                        blurRadius: 4,
-                        offset: Offset(0, 2),
-                      ),
-                    ],
-                  ),
-                  child: const Row(
-                    mainAxisSize: MainAxisSize.min,
-                    children: [
-                      Icon(Icons.check_circle, color: Colors.white, size: 16),
-                      SizedBox(width: 4),
-                      Text(
-                        'Uploaded',
-                        style: TextStyle(
-                          color: Colors.white,
-                          fontSize: 12,
-                          fontWeight: FontWeight.w600,
-                        ),
-                      ),
-                    ],
-                  ),
-                ),
-              ),
-          ],
-        ),
+  Widget _buildVehicleTypeCard(String name, int id, String? imageUrl, bool isSelected) {
+    return GestureDetector(
+      onTap: () {
+        setState(() { _selectedVehicleType = name; _selectedVehicleTypeId = id; });
+        FFAppState().selectvehicle = name;
+        FFAppState().adminVehicleId = id;
+        FFAppState().vehicleType = name;
+        FFAppState().update(() {});
+      },
+      child: AnimatedContainer(
+        duration: const Duration(milliseconds: 250),
+        curve: Curves.easeOutBack,
+        padding: const EdgeInsets.all(16),
+        decoration: BoxDecoration(
+          gradient: isSelected
+              ? LinearGradient(colors: [AppColors.sectionOrangeLight, AppColors.sectionOrangeLight.withOpacity(0.5)], begin: Alignment.topLeft, end: Alignment.bottomRight)
+              : null,
+          borderRadius: BorderRadius.circular(20),
+          color: isSelected ? null : AppColors.backgroundCard,
+          border: Border.all(color: isSelected ? _primary : AppColors.greyBorder, width: isSelected ? 2 : 1),
+          boxShadow: isSelected ? [BoxShadow(color: _primary.withOpacity(0.25), blurRadius: 16, offset: const Offset(0, 4))] : [],
+        ),
+        child: Row(children: [
+          Container(
+            width: 56, height: 56,
+            decoration: BoxDecoration(
+              color: isSelected ? AppColors.sectionOrangeLight : AppColors.backgroundCard,
+              borderRadius: BorderRadius.circular(14),
+            ),
+            child: ClipRRect(
+              borderRadius: BorderRadius.circular(14),
+              child: imageUrl != null
+                  ? Image.network(imageUrl, fit: BoxFit.cover,
+                  errorBuilder: (_, __, ___) => Icon(_getVehicleIcon(name), size: 28, color: isSelected ? _primary : _textMuted))
+                  : Icon(_getVehicleIcon(name), size: 28, color: isSelected ? _primary : _textMuted),
+            ),
+          ),
+          const SizedBox(width: 16),
+          Expanded(child: Column(
+            crossAxisAlignment: CrossAxisAlignment.start,
+            children: [
+              Text(name, style: TextStyle(
+                fontSize: 16, fontWeight: FontWeight.w700,
+                color: isSelected ? _textWhite : _textMuted,
+              )),
+              if (isSelected)
+                Text('Selected', style: TextStyle(fontSize: 12, color: _primary, fontWeight: FontWeight.w500)),
+            ],
+          )),
+          AnimatedContainer(
+            duration: const Duration(milliseconds: 200),
+            padding: const EdgeInsets.all(4),
+            decoration: BoxDecoration(
+              color: isSelected ? _primary : Colors.transparent,
+              shape: BoxShape.circle,
+              border: Border.all(color: isSelected ? _primary : AppColors.greyBorder, width: 2),
+            ),
+            child: Icon(Icons.check, color: AppColors.white, size: isSelected ? 14 : 0),
+          ),
+        ]),
+      ),
+    );
+  }
+
+  Widget _buildSelectedVehicleTypeChip(String vehicleName) {
+    return Container(
+      padding: const EdgeInsets.symmetric(horizontal: 14, vertical: 10),
+      decoration: BoxDecoration(
+        color: AppColors.sectionOrangeLight,
+        borderRadius: BorderRadius.circular(12),
+        border: Border.all(color: _primary, width: 1.5),
+      ),
+      child: Row(
+        mainAxisSize: MainAxisSize.min,
+        children: [
+          Icon(Icons.check_circle, color: _primary, size: 20),
+          const SizedBox(width: 10),
+          Text(
+            'Selected: $vehicleName',
+            style: const TextStyle(
+              fontSize: 15,
+              fontWeight: FontWeight.w600,
+              color: AppColors.textDark,
+            ),
+          ),
+        ],
+      ),
+    );
+  }
+
+  IconData _getVehicleIcon(String name) {
+    final n = name.toLowerCase();
+    if (n.contains('auto')) return Icons.local_taxi;
+    if (n.contains('bike') || n.contains('motorcycle')) return Icons.two_wheeler;
+    if (n.contains('car') || n.contains('sedan') || n.contains('suv')) return Icons.directions_car;
+    if (n.contains('truck')) return Icons.local_shipping;
+    return Icons.directions_car_rounded;
+  }
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  DOCUMENT UPLOAD
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  Widget _buildDocUpload({
+    required String label,
+    required IconData icon,
+    required FFUploadedFile? image,
+    required bool isValid,
+    required Function(FFUploadedFile?) onSelected,
+  }) {
+    bool hasImg = image?.bytes != null && image!.bytes!.isNotEmpty;
+    return GestureDetector(
+      onTap: () async {
+        final selectedMedia = await selectMediaWithSourceBottomSheet(context: context, allowPhoto: true);
+        if (selectedMedia != null && selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {
+          final file = FFUploadedFile(
+            name: selectedMedia.first.storagePath.split('/').last,
+            bytes: selectedMedia.first.bytes,
+          );
+          onSelected(file);
+          _showSnackBar('$label uploaded!');
+        }
+      },
+      child: AnimatedContainer(
+        duration: const Duration(milliseconds: 300),
+        width: double.infinity,
+        height: 160,
+        decoration: BoxDecoration(
+          color: AppColors.backgroundCard,
+          borderRadius: BorderRadius.circular(18),
+          border: Border.all(
+            color: hasImg ? _primary : AppColors.greyBorder,
+            width: hasImg ? 2 : 1,
+          ),
+          boxShadow: hasImg ? [BoxShadow(color: _primary.withOpacity(0.2), blurRadius: 12)] : [],
+        ),
+        child: Stack(children: [
+          if (hasImg)
+            ClipRRect(
+              borderRadius: BorderRadius.circular(16),
+              child: Image.memory(image!.bytes!, fit: BoxFit.cover, width: double.infinity, height: double.infinity),
+            )
+          else
+            Center(child: Column(
+              mainAxisAlignment: MainAxisAlignment.center,
+              children: [
+                Container(
+                  padding: const EdgeInsets.all(16),
+                  decoration: BoxDecoration(
+                    color: _primary.withOpacity(0.1),
+                    shape: BoxShape.circle,
+                    border: Border.all(color: _primary.withOpacity(0.3)),
+                  ),
+                  child: Icon(icon, color: _primary, size: 36),
+                ),
+                const SizedBox(height: 10),
+                Text('Upload $label', style: const TextStyle(color: AppColors.textDark, fontWeight: FontWeight.w600, fontSize: 14)),
+                const SizedBox(height: 2),
+                Text('Tap to select', style: TextStyle(color: AppColors.greySlate, fontSize: 12)),
+              ],
+            )),
+          if (hasImg && isValid)
+            Positioned(top: 10, left: 10, child: Container(
+              padding: const EdgeInsets.symmetric(horizontal: 10, vertical: 5),
+              decoration: BoxDecoration(color: _primary, borderRadius: BorderRadius.circular(12)),
+              child: const Row(mainAxisSize: MainAxisSize.min, children: [
+                Icon(Icons.check, color: AppColors.white, size: 13),
+                SizedBox(width: 3),
+                Text('Valid', style: TextStyle(color: AppColors.white, fontSize: 11, fontWeight: FontWeight.w700)),
+              ]),
+            )),
+        ]),
       ),
     );
   }
 
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  //  SUBMIT BUTTON
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Widget _buildSubmitButton(bool hasImage) {
-    bool isFormValid = _selectedVehicleType != null &&
+    final hasVehicleType = (_selectedVehicleType != null && _selectedVehicleType!.isNotEmpty) ||
+        FFAppState().selectvehicle.isNotEmpty ||
+        FFAppState().vehicleType.isNotEmpty;
+    bool isFormValid = hasVehicleType &&
         _makeController.text.isNotEmpty &&
         _modelController.text.isNotEmpty &&
-        _yearController.text.isNotEmpty &&
-        _selectedColor != null &&
-        hasImage;
+        hasImage &&
+        _pollutionImage != null &&
+        _insuranceImage != null;
 
     return Container(
       width: double.infinity,
       height: 56,
       decoration: BoxDecoration(
         gradient: isFormValid
-            ? const LinearGradient(
-          colors: [AppColors.accentIndigo, AppColors.accentPurple],
-          begin: Alignment.centerLeft,
-          end: Alignment.centerRight,
-        )
+            ? const LinearGradient(colors: [AppColors.primaryGradientStart, AppColors.primary], begin: Alignment.centerLeft, end: Alignment.centerRight)
             : null,
         color: isFormValid ? null : AppColors.greyBorder,
         borderRadius: BorderRadius.circular(12),
-        boxShadow: isFormValid
-            ? [
-          BoxShadow(
-            color: AppColors.accentIndigo.withValues(alpha:0.4),
-            blurRadius: 12,
-            offset: const Offset(0, 6),
-          ),
-        ]
-            : [],
+        boxShadow: isFormValid ? [BoxShadow(color: _primary.withOpacity(0.4), blurRadius: 12, offset: const Offset(0, 6))] : [],
       ),
       child: Material(
         color: Colors.transparent,
+        borderRadius: BorderRadius.circular(12),
         child: InkWell(
           borderRadius: BorderRadius.circular(12),
           onTap: isFormValid
               ? () async {
-            FFAppState().vehicleType = _selectedVehicleType!;
-            FFAppState().vehicleYear = _yearController.text;
+            final vType = _selectedVehicleType ?? (FFAppState().selectvehicle.isNotEmpty ? FFAppState().selectvehicle : FFAppState().vehicleType);
+            if (vType.isNotEmpty) {
+              FFAppState().vehicleType = vType;
+              FFAppState().selectvehicle = vType;
+              if (_selectedVehicleTypeId > 0) FFAppState().adminVehicleId = _selectedVehicleTypeId;
+            }
+            FFAppState().vehicleName = _makeController.text;
             FFAppState().vehicleMake = _makeController.text;
             FFAppState().vehicleModel = _modelController.text;
-            FFAppState().vehicleColor = _selectedColor!;
+            FFAppState().vehicleColor = _selectedColor ?? '';
+            FFAppState().licensePlate = _licensePlateController.text;
+            FFAppState().registrationNumber = _regNumberController.text;
+            FFAppState().registrationDate = _regDateController.text;
+            FFAppState().insuranceNumber = _insuranceNumberController.text;
+            FFAppState().insuranceExpiryDate = _insuranceExpiryController.text;
+            FFAppState().pollutionExpiryDate = _pollutionExpiryController.text;
             FFAppState().vehicleImage = _vehicleImage;
-
-            if (_vehicleImage?.bytes != null) {
-              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);
-            }
-
+            FFAppState().pollutionImage = _pollutionImage;
+            FFAppState().insuranceImage = _insuranceImage;
+            if (_vehicleImage?.bytes != null) FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);
             FFAppState().update(() {});
 
-            _showSnackBar('âœ“ Vehicle details saved successfully!');
-
+            if (FFAppState().driverid > 0 && FFAppState().accessToken.isNotEmpty) {
+              try {
+                final res = await UpdateDriverCall.call(
+                  id: FFAppState().driverid,
+                  token: FFAppState().accessToken,
+                  isonline: null,
+                  vehicleImage: _vehicleImage,
+                  registrationImage: FFAppState().registrationImage,
+                  insuranceImage: _insuranceImage,
+                  pollutionCertificateImage: _pollutionImage,
+                  vehicleName: _makeController.text,
+                  vehicleModel: _modelController.text,
+                  vehicleColor: _selectedColor,
+                  licensePlate: _licensePlateController.text,
+                  registrationNumber: _regNumberController.text,
+                  registrationDate: _regDateController.text.isNotEmpty ? _regDateController.text : null,
+                  insuranceNumber: _insuranceNumberController.text,
+                  insuranceExpiryDate: _insuranceExpiryController.text.isNotEmpty ? _insuranceExpiryController.text : null,
+                  pollutionExpiryDate: _pollutionExpiryController.text.isNotEmpty ? _pollutionExpiryController.text : null,
+                  vehicleTypeId: _selectedVehicleTypeId > 0 ? _selectedVehicleTypeId : null,
+                );
+                if (!mounted) return;
+                if (res.succeeded) {
+                  _showSnackBar('Vehicle details saved successfully!');
+                } else {
+                  _showSnackBar(getJsonField(res.jsonBody, r'$.message')?.toString() ?? 'Update failed', isError: true);
+                  return;
+                }
+              } catch (e) {
+                if (mounted) _showSnackBar('Failed to update: $e', isError: true);
+                return;
+              }
+            } else {
+              _showSnackBar('Vehicle details saved successfully!');
+            }
             await Future.delayed(const Duration(milliseconds: 600));
-            context.pop();
+            if (mounted) context.pop();
           }
               : () {
-            if (_selectedVehicleType == null) {
-              _showSnackBar('Please select vehicle type', isError: true);
-            } else if (_makeController.text.isEmpty) {
-              _showSnackBar('Please enter vehicle make', isError: true);
-            } else if (_modelController.text.isEmpty) {
-              _showSnackBar('Please enter vehicle model', isError: true);
-            } else if (_yearController.text.isEmpty) {
-              _showSnackBar('Please enter year', isError: true);
-            } else if (_selectedColor == null) {
-              _showSnackBar('Please select color', isError: true);
-            } else if (!hasImage) {
-              _showSnackBar('Please upload vehicle photo', isError: true);
-            }
+            if (!hasVehicleType) _showSnackBar('Please select vehicle type first (from Choose Vehicle)', isError: true);
+            else if (_makeController.text.isEmpty) _showSnackBar('Please select vehicle name', isError: true);
+            else if (_modelController.text.isEmpty) _showSnackBar('Please select vehicle model', isError: true);
+            else if (!hasImage) _showSnackBar('Please upload vehicle photo', isError: true);
+            else if (_pollutionImage == null) _showSnackBar('Please upload pollution certificate', isError: true);
+            else if (_insuranceImage == null) _showSnackBar('Please upload insurance document', isError: true);
           },
           child: Center(
-            child: Text(
-              'Save Vehicle Details',
-              style: TextStyle(
-                color: isFormValid ? Colors.white : AppColors.greyLight,
-                fontSize: 16,
-                fontWeight: FontWeight.w600,
-                letterSpacing: 0.3,
-              ),
+            child: Row(
+              mainAxisSize: MainAxisSize.min,
+              children: [
+                Icon(
+                  isFormValid ? Icons.check_circle_rounded : Icons.lock_rounded,
+                  color: isFormValid ? AppColors.white : AppColors.greyLight,
+                  size: 20,
+                ),
+                const SizedBox(width: 10),
+                Text(
+                  isFormValid ? 'Save Vehicle Details' : 'Complete All Fields',
+                  style: TextStyle(
+                    color: isFormValid ? AppColors.white : AppColors.greyLight,
+                    fontSize: 17,
+                    fontWeight: FontWeight.w700,
+                    letterSpacing: 0.3,
+                  ),
+                ),
+              ],
             ),
           ),
         ),
Index: lib/login/login_widget.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/auth/firebase_auth/auth_util.dart';\nimport '/constants/responsive.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/index.dart';\nimport 'package:flutter/gestures.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:font_awesome_flutter/font_awesome_flutter.dart';\nimport 'package:google_fonts/google_fonts.dart';\nimport 'login_model.dart';\nexport 'login_model.dart';\n\nclass LoginWidget extends StatefulWidget {\n  const LoginWidget({super.key});\n\n  static String routeName = 'login';\n  static String routePath = '/login';\n\n  @override\n  State<LoginWidget> createState() => _LoginWidgetState();\n}\n\nclass _LoginWidgetState extends State<LoginWidget> {\n  late LoginModel _model;\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n\n  // âœ… Loading State\n  bool _isLoading = false;\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => LoginModel());\n\n    _model.textController ??= TextEditingController();\n    _model.textFieldFocusNode ??= FocusNode();\n\n    // Listen to auth changes\n    authManager.handlePhoneAuthStateChanges(context);\n  }\n\n  @override\n  void dispose() {\n    _model.dispose();\n    super.dispose();\n  }\n\n  // \uD83D\uDD39 LOGIC: Handle Social Login Results\n  void _handleSocialLoginSuccess(BaseAuthUser user) {\n    // Uber-like Flow: Phone number is the primary identity for drivers.\n    // If the social account doesn't provide a phone number, we force the user to enter it.\n    if (user.phoneNumber == null || user.phoneNumber!.isEmpty) {\n      ScaffoldMessenger.of(context).showSnackBar(\n        SnackBar(\n          content: Text(\n            'Verification Required: Please enter your mobile number to complete registration.',\n            style: GoogleFonts.inter(),\n          ),\n          backgroundColor: Colors.orange,\n          behavior: SnackBarBehavior.floating,\n        ),\n      );\n\n      // Auto-focus the phone field to guide the user\n      _model.textFieldFocusNode?.requestFocus();\n    } else {\n      // If phone is verified, proceed to Home (or Location Preference screen)\n      context.goNamed(HomeWidget.routeName);\n    }\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    // \uD83C\uDFA8 DRIVER APP COLORS\n    const Color brandPrimary = AppColors.primary;\n    const Color brandGradientStart = AppColors.primaryGradientStart;\n    const Color bgOffWhite = AppColors.backgroundAlt;\n\n    // \uD83D\uDCD0 RESPONSIVE SIZING (screenWidth / screenHeight media queries)\n    final screenW = Responsive.screenWidth(context);\n    final screenH = Responsive.screenHeight(context);\n    final isTablet = Responsive.isLargeScreen(context);\n    final isPortrait = screenH > screenW;\n\n    // Header height: responsive to both width and height\n    final headerHeight = Responsive.valueByHeight(context,\n      at600: isPortrait ? 280.0 : 180.0,\n      at700: isPortrait ? 320.0 : 200.0,\n      at800: isPortrait ? (isTablet ? 360.0 : 340.0) : 220.0,\n      defaultVal: isPortrait ? 340.0 : 200.0,\n    );\n\n    final scale = Responsive.scale(context);\n    final hPad = Responsive.horizontalPadding(context) + (isTablet ? 16.0 : 0.0);\n    final cardPadding = Responsive.valueByWidth(context,\n      at360: 20.0,\n      at600: 28.0,\n      at900: 32.0,\n      defaultVal: 24.0,\n    );\n    final cardHorizontalPad = Responsive.valueByWidth(context,\n      at360: 16.0,\n      at600: 24.0,\n      at900: 40.0,\n      defaultVal: 20.0,\n    );\n\n    final logoSize = Responsive.valueByWidth(context,\n      at360: 80.0,\n      at600: 110.0,\n      at900: 120.0,\n      defaultVal: 100.0,\n    );\n    final headlineFontSize = Responsive.fontSize(context, 36);\n    final subtitleFontSize = Responsive.fontSize(context, 28);\n    final phoneFontSize = Responsive.fontSize(context, 20);\n    final buttonHeight = Responsive.buttonHeight(context, base: 56);\n    final buttonFontSize = Responsive.fontSize(context, 18);\n\n    // Max card width on tablets (centered layout)\n    final maxCardWidth = Responsive.maxContentWidth(context);\n\n    return GestureDetector(\n      onTap: () {\n        FocusScope.of(context).unfocus();\n        FocusManager.instance.primaryFocus?.unfocus();\n      },\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: bgOffWhite,\n        body: SingleChildScrollView(\n          child: Column(\n            children: [\n              // ==========================================\n              // 1\uFE0Fâƒ£ VIBRANT HEADER (Curved Bottom)\n              // ==========================================\n              Container(\n                height: headerHeight,\n                width: double.infinity,\n                decoration: const BoxDecoration(\n                  gradient: LinearGradient(\n                    colors: [brandGradientStart, brandPrimary],\n                    begin: Alignment.topLeft,\n                    end: Alignment.bottomRight,\n                  ),\n                  borderRadius: BorderRadius.only(\n                    bottomLeft: Radius.circular(40),\n                    bottomRight: Radius.circular(40),\n                  ),\n                  boxShadow: [\n                    BoxShadow(\n                      color: Colors.black12,\n                      blurRadius: 10,\n                      offset: Offset(0, 5),\n                    )\n                  ],\n                ),\n                child: SafeArea(\n                  child: Padding(\n                    padding: EdgeInsets.symmetric(horizontal: hPad),\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        const Spacer(),\n                        // App Icon / Logo Placeholder\n                        Center(\n                          child: ClipRRect(\n                            borderRadius: BorderRadius.circular(12),\n                            child: Image.asset(\n                              'assets/images/app_launcher_icon.png',\n                              width: logoSize,\n                              height: logoSize,\n                              fit: BoxFit.contain,\n                              errorBuilder: (context, error, stackTrace) {\n                                return Icon(\n                                  Icons.local_taxi_rounded,\n                                  color: Colors.white,\n                                  size: logoSize * 0.4,\n                                );\n                              },\n                            ),\n                          ),\n                        ),\n                        const Spacer(),\n                        Center(\n                          child: Text(\n                            'Welcome Partner,',\n                            style: GoogleFonts.inter(\n                              fontSize: headlineFontSize,\n                              color: Colors.white.withValues(alpha:0.9),\n                              fontWeight: FontWeight.bold,\n                            ),\n                          ),\n                        ),\n                        SizedBox(height: 8 * scale),\n                        Center(\n                          child: Text(\n                            \"Let's get you on the road.\",\n                            style: GoogleFonts.interTight(\n                              fontSize: subtitleFontSize,\n                              color: Colors.white,\n                              fontWeight: FontWeight.bold,\n                              height: 1.1,\n                            ),\n                          ),\n                        ),\n                        SizedBox(height: 60 * scale), // Space for card overlap\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n\n              // ==========================================\n              // 2\uFE0Fâƒ£ FLOATING LOGIN CARD\n              // ==========================================\n              Transform.translate(\n                offset: Offset(0, Responsive.valueByHeight(context, at600: -32.0, at700: -36.0, at800: -40.0, defaultVal: -40.0) * scale),\n                child: Padding(\n                  padding: EdgeInsets.symmetric(horizontal: cardHorizontalPad),\n                  child: Center(\n                    child: ConstrainedBox(\n                      constraints: BoxConstraints(maxWidth: maxCardWidth ?? double.infinity),\n                      child: Container(\n                        width: double.infinity,\n                    decoration: BoxDecoration(\n                      color: Colors.white,\n                      borderRadius: BorderRadius.circular(24),\n                      boxShadow: [\n                        BoxShadow(\n                          color: Colors.black.withValues(alpha:0.08),\n                          blurRadius: 20 * scale,\n                          offset: const Offset(0, 12),\n                        ),\n                      ],\n                    ),\n                    child: Padding(\n                      padding: EdgeInsets.all(cardPadding),\n                      child: Column(\n                        crossAxisAlignment: CrossAxisAlignment.start,\n                        children: [\n                          Text(\n                            'Enter Mobile Number',\n                            style: GoogleFonts.inter(\n                              fontSize: 14 * scale,\n                              fontWeight: FontWeight.w600,\n                              color: Colors.grey[700],\n                            ),\n                          ),\n                          SizedBox(height: 12 * scale),\n\n                          // \uD83D\uDCF1 PHONE INPUT FIELD\n                          Container(\n                            height: 60 * scale,\n                            decoration: BoxDecoration(\n                              color: AppColors.backgroundCard,\n                              borderRadius: BorderRadius.circular(16),\n                              border: Border.all(\n                                color: AppColors.divider,\n                                width: 1.5,\n                              ),\n                            ),\n                            child: Row(\n                              children: [\n                                Padding(\n                                  padding: EdgeInsets.symmetric(\n                                      horizontal: 16.0 * scale),\n                                  child: Row(\n                                    children: [\n                                      Icon(Icons.flag,\n                                          color: Colors.orange, size: 20 * scale),\n                                      SizedBox(width: 8 * scale),\n                                      Text(\n                                        '+91',\n                                        style: GoogleFonts.inter(\n                                          fontSize: 18 * scale,\n                                          fontWeight: FontWeight.bold,\n                                          color: Colors.black87,\n                                        ),\n                                      ),\n                                    ],\n                                  ),\n                                ),\n                                Container(\n                                  width: 1,\n                                  height: 24 * scale,\n                                  color: Colors.grey[300],\n                                ),\n                                Expanded(\n                                  child: TextFormField(\n                                    controller: _model.textController,\n                                    focusNode: _model.textFieldFocusNode,\n                                    autofocus: false,\n                                    obscureText: false,\n                                    textInputAction: TextInputAction.done,\n                                    keyboardType: TextInputType.phone,\n                                    cursorColor: brandPrimary,\n                                    style: GoogleFonts.inter(\n                                      fontSize: phoneFontSize,\n                                      fontWeight: FontWeight.w600,\n                                      color: Colors.black,\n                                      letterSpacing: 1.2,\n                                    ),\n                                    inputFormatters: [\n                                      FilteringTextInputFormatter.digitsOnly,\n                                      LengthLimitingTextInputFormatter(10),\n                                    ],\n                                    decoration: InputDecoration(\n                                      hintText: 'Mobile Number',\n                                      hintStyle: GoogleFonts.inter(\n                                        color: Colors.grey[400],\n                                        fontSize: phoneFontSize,\n                                        fontWeight: FontWeight.w500,\n                                      ),\n                                      border: InputBorder.none,\n                                      contentPadding: EdgeInsets.symmetric(\n                                        horizontal: Responsive.horizontalPadding(context),\n                                        vertical: 18 * scale,\n                                      ),\n                                    ),\n                                  ),\n                                ),\n                              ],\n                            ),\n                          ),\n\n                          SizedBox(height: 32 * scale),\n\n                          // \uD83D\uDE80 ACTION BUTTON (GET OTP)\n                          SizedBox(\n                            width: double.infinity,\n                            height: buttonHeight,\n                            child: ElevatedButton(\n                              onPressed: _isLoading ? null : _handleSendOtp,\n                              style: ElevatedButton.styleFrom(\n                                backgroundColor: brandPrimary,\n                                foregroundColor: Colors.white,\n                                elevation: 4,\n                                shape: RoundedRectangleBorder(\n                                  borderRadius: BorderRadius.circular(16),\n                                ),\n                                disabledBackgroundColor:\n                                brandPrimary.withValues(alpha:0.6),\n                              ),\n                              child: _isLoading\n                                  ? SizedBox(\n                                height: 24 * scale,\n                                width: 24 * scale,\n                                child: const CircularProgressIndicator(\n                                  color: Colors.white,\n                                  strokeWidth: 2.5,\n                                ),\n                              )\n                                  : Text(\n                                'Get OTP',\n                                style: GoogleFonts.interTight(\n                                  fontSize: buttonFontSize,\n                                  fontWeight: FontWeight.bold,\n                                  letterSpacing: 0.5,\n                                ),\n                              ),\n                            ),\n                          ),\n\n                          SizedBox(height: 24 * scale),\n\n                          // \uD83D\uDCC4 LEGAL TEXT (tappable)\n                          Center(\n                            child: Builder(\n                              builder: (context) {\n                                return RichText(\n                                  textAlign: TextAlign.center,\n                                  text: TextSpan(\n                                    style: GoogleFonts.inter(\n                                      fontSize: 12 * scale,\n                                      color: Colors.grey[500],\n                                      height: 1.5,\n                                    ),\n                                    children: [\n                                      const TextSpan(text: 'By continuing, you agree to our\\n'),\n                                      TextSpan(\n                                        text: 'Terms of Service',\n                                        style: TextStyle(\n                                          color: Colors.black87,\n                                          fontWeight: FontWeight.w600,\n                                          decoration: TextDecoration.underline,\n                                          fontSize: 12 * scale,\n                                        ),\n                                        recognizer: TapGestureRecognizer()\n                                          ..onTap = () => context.pushNamed(TermsConditionsWidget.routeName),\n                                      ),\n                                      const TextSpan(text: ' & '),\n                                      TextSpan(\n                                        text: 'Privacy Policy',\n                                        style: TextStyle(\n                                          color: Colors.black87,\n                                          fontWeight: FontWeight.w600,\n                                          decoration: TextDecoration.underline,\n                                          fontSize: 12 * scale,\n                                        ),\n                                        recognizer: TapGestureRecognizer()\n                                          ..onTap = () => context.pushNamed(PrivacyPolicyPageWidget.routeName),\n                                      ),\n                                    ],\n                                  ),\n                                );\n                              },\n                            ),\n                          ),\n                        ],\n                      ),\n                    ),\n                  ),\n                    ),\n                  ),\n                ),\n              ),\n\n              // ==========================================\n              // 3\uFE0Fâƒ£ SOCIAL LOGIN (Subtle Footer)\n              // ==========================================\n              SizedBox(height: Responsive.verticalSpacing(context)),\n\n              Row(\n                children: [\n                  Expanded(\n                    child: Divider(\n                      indent: Responsive.valueByWidth(context, at360: 24.0, at600: 48.0, at900: 64.0, defaultVal: 40.0),\n                      endIndent: Responsive.verticalSpacing(context),\n                    ),\n                  ),\n                  Padding(\n                    padding: EdgeInsets.symmetric(horizontal: Responsive.verticalSpacing(context)),\n                    child: Text(\n                      'Or connect with',\n                      style: GoogleFonts.inter(\n                        fontSize: Responsive.fontSize(context, 12),\n                        color: Colors.grey[500],\n                        fontWeight: FontWeight.w500,\n                      ),\n                    ),\n                  ),\n                  Expanded(\n                    child: Divider(\n                      indent: Responsive.verticalSpacing(context),\n                      endIndent: Responsive.valueByWidth(context, at360: 24.0, at600: 48.0, at900: 64.0, defaultVal: 40.0),\n                    ),\n                  ),\n                ],\n              ),\n              SizedBox(height: Responsive.verticalSpacing(context) * 2),\n\n              // \uD83D\uDD39 SOCIAL BUTTONS\n              Row(\n                mainAxisAlignment: MainAxisAlignment.center,\n                children: [\n                  _socialButton(context,\n                    icon: FontAwesomeIcons.google,\n                    color: AppColors.googleRed,\n                    onTap: () async {\n                      setState(() => _isLoading = true);\n                      try {\n                        final user = await authManager.signInWithGoogle(context);\n                        if (user != null) {\n                          _handleSocialLoginSuccess(user);\n                        }\n                      } finally {\n                        if (mounted) setState(() => _isLoading = false);\n                      }\n                    },\n                  ),\n                  SizedBox(width: Responsive.verticalSpacing(context) * 2),\n                  _socialButton(context,\n                    icon: Icons.apple,\n                    color: Colors.black,\n                    onTap: () async {\n                      setState(() => _isLoading = true);\n                      try {\n                        final user = await authManager.signInWithApple(context);\n                        if (user != null) {\n                          _handleSocialLoginSuccess(user);\n                        }\n                      } finally {\n                        if (mounted) setState(() => _isLoading = false);\n                      }\n                    },\n                  ),\n                ],\n              ),\n              SizedBox(height: Responsive.valueByHeight(context, at600: 24.0, at700: 32.0, at800: 40.0, defaultVal: 40.0)),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n\n  // \uD83D\uDD39 LOGIC: Send OTP\n  Future<void> _handleSendOtp() async {\n    final phoneText = _model.textController.text.trim();\n\n    if (phoneText.isEmpty || phoneText.length != 10) {\n      ScaffoldMessenger.of(context).showSnackBar(\n        SnackBar(\n          content: Text(\n            'Please enter a valid 10-digit mobile number.',\n            style: GoogleFonts.inter(fontWeight: FontWeight.w500),\n          ),\n          backgroundColor: Colors.redAccent,\n          behavior: SnackBarBehavior.floating,\n          shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(10)),\n          margin: EdgeInsets.all(Responsive.horizontalPadding(context)),\n        ),\n      );\n      return;\n    }\n\n    setState(() => _isLoading = true);\n    HapticFeedback.mediumImpact(); // Touch Feedback\n\n    final phoneNumberVal = '+91$phoneText';\n\n    await authManager.beginPhoneAuth(\n      context: context,\n      phoneNumber: phoneNumberVal,\n      onCodeSent: (context) async {\n        if (mounted) {\n          setState(() => _isLoading = false);\n\n          context.goNamedAuth(\n            OtpverificationWidget.routeName,\n            context.mounted,\n            queryParameters: {\n              'mobile': serializeParam(\n                int.tryParse(phoneText),\n                ParamType.int,\n              ),\n            }.withoutNulls,\n            ignoreRedirect: true,\n          );\n        }\n      },\n    );\n\n    // Safety timeout\n    Future.delayed(const Duration(seconds: 15), () {\n      if (mounted && _isLoading) setState(() => _isLoading = false);\n    });\n  }\n\n  // \uD83D\uDD39 HELPER: Social Button (min 48dp touch target)\n  Widget _socialButton(BuildContext context,\n      {required IconData icon,\n        required Color color,\n        required VoidCallback onTap}) {\n    final btnSize = Responsive.buttonHeight(context, base: 56);\n    final iconSize = Responsive.iconSize(context, base: 24);\n\n    return Material(\n      color: Colors.transparent,\n      child: InkWell(\n      onTap: () {\n        HapticFeedback.lightImpact();\n        onTap();\n      },\n        borderRadius: BorderRadius.circular(12),\n        child: Container(\n          width: btnSize,\n          height: btnSize,\n          decoration: BoxDecoration(\n            color: Colors.white,\n            borderRadius: BorderRadius.circular(12),\n            border: Border.all(color: Colors.grey[200]!),\n            boxShadow: [\n              BoxShadow(\n                color: Colors.grey.withValues(alpha: 0.1),\n                blurRadius: 10,\n                offset: const Offset(0, 4),\n              )\n            ],\n          ),\n          child: Center(\n            child: FaIcon(icon, color: color, size: iconSize),\n          ),\n        ),\n      ),\n    );\n  }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/login/login_widget.dart b/lib/login/login_widget.dart
--- a/lib/login/login_widget.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/login/login_widget.dart	(date 1771587530629)
@@ -116,7 +116,6 @@
     final phoneFontSize = Responsive.fontSize(context, 20);
     final buttonHeight = Responsive.buttonHeight(context, base: 56);
     final buttonFontSize = Responsive.fontSize(context, 18);
-
     // Max card width on tablets (centered layout)
     final maxCardWidth = Responsive.maxContentWidth(context);
 
Index: lib/on_boarding/on_boarding_widget.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/backend/api_requests/api_calls.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/index.dart';\nimport '/services/document_verification_service.dart';\nimport 'package:flutter/material.dart';\nimport 'package:google_fonts/google_fonts.dart';\nimport 'package:provider/provider.dart';\nimport 'on_boarding_model.dart';\nexport 'on_boarding_model.dart';\nimport 'package:firebase_messaging/firebase_messaging.dart';\n\nclass OnBoardingWidget extends StatefulWidget {\n  const OnBoardingWidget({\n    super.key,\n    required this.mobile,\n    this.firstname,\n    this.lastname,\n    this.email,\n    this.referalcode,\n    this.vehicletype,\n  });\n\n  final int mobile;\n  final String? firstname;\n  final String? lastname;\n  final String? email;\n  final String? referalcode; // Should be String to match previous screens\n  final String? vehicletype;\n\n  static String routeName = 'on_boarding';\n  static String routePath = '/onBoarding';\n\n  @override\n  State<OnBoardingWidget> createState() => _OnBoardingWidgetState();\n}\n\nclass _OnBoardingWidgetState extends State<OnBoardingWidget> {\n  late OnBoardingModel _model;\n  String? fcm_token;\n  bool _isLoading = false;\n\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => OnBoardingModel());\n    _initFCM();\n  }\n\n  Future<void> _initFCM() async {\n    try {\n      fcm_token = await FirebaseMessaging.instance.getToken();\n    } catch (e) {\n      print('FCM Error: $e');\n    }\n  }\n\n  @override\n  void dispose() {\n    _model.dispose();\n    super.dispose();\n  }\n\n  // Helper to check uploads\n  bool _isDocumentUploaded(dynamic document) {\n    if (document == null) return false;\n    if (document is FFUploadedFile) {\n      return document.bytes != null && document.bytes!.isNotEmpty;\n    }\n    if (document is String) {\n      return document.isNotEmpty && document != 'null';\n    }\n    return false;\n  }\n\n  int _calculateCompletionPercentage() {\n    int completed = 0;\n    int total = 6; // License, Profile, Aadhar, Pan, Vehicle, RC\n\n    final hasLicense = _isDocumentUploaded(FFAppState().imageLicense) ||\n        _isDocumentUploaded(FFAppState().licenseFrontImage) ||\n        _isDocumentUploaded(FFAppState().licenseBackImage);\n    final hasAadhaar = _isDocumentUploaded(FFAppState().aadharImage) ||\n        _isDocumentUploaded(FFAppState().aadhaarFrontImage) ||\n        _isDocumentUploaded(FFAppState().aadhaarBackImage);\n    final hasRC = _isDocumentUploaded(FFAppState().registrationImage) ||\n        _isDocumentUploaded(FFAppState().rcFrontImage) ||\n        _isDocumentUploaded(FFAppState().rcBackImage);\n\n    if (hasLicense) completed++;\n    if (_isDocumentUploaded(FFAppState().profilePhoto)) completed++;\n    if (hasAadhaar) completed++;\n    if (_isDocumentUploaded(FFAppState().panImage)) completed++;\n    if (_isDocumentUploaded(FFAppState().vehicleImage)) completed++;\n    if (hasRC) completed++;\n\n    return ((completed / total) * 100).round();\n  }\n\n\n  @override\n  Widget build(BuildContext context) {\n    context.watch<FFAppState>();\n\n    final completionPercentage = _calculateCompletionPercentage();\n    final allDocsUploaded = completionPercentage == 100;\n\n    // \uD83C\uDFA8 APP COLORS\n    const Color brandPrimary = AppColors.primary;\n    const Color brandGradientStart = AppColors.primaryGradientStart;\n    const Color bgOffWhite = AppColors.backgroundAlt;\n\n    return GestureDetector(\n      onTap: () {\n        FocusScope.of(context).unfocus();\n        FocusManager.instance.primaryFocus?.unfocus();\n      },\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: bgOffWhite,\n        body: Column(\n          children: [\n            // ==========================================\n            // 1\uFE0Fâƒ£ VIBRANT HEADER\n            // ==========================================\n            Container(\n              height: 240,\n              width: double.infinity,\n              decoration: const BoxDecoration(\n                gradient: LinearGradient(\n                  colors: [brandGradientStart, brandPrimary],\n                  begin: Alignment.topLeft,\n                  end: Alignment.bottomRight,\n                ),\n                borderRadius: BorderRadius.only(\n                  bottomLeft: Radius.circular(30),\n                  bottomRight: Radius.circular(30),\n                ),\n                boxShadow: [\n                  BoxShadow(\n                    color: Colors.black12,\n                    blurRadius: 10,\n                    offset: Offset(0, 5),\n                  )\n                ],\n              ),\n              child: SafeArea(\n                child: Padding(\n                  padding: const EdgeInsets.symmetric(horizontal: 24.0),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      const SizedBox(height: 16),\n                      InkWell(\n                        onTap: () => context.pop(),\n                        child: Container(\n                          padding: const EdgeInsets.all(8),\n                          decoration: BoxDecoration(\n                            color: Colors.white.withValues(alpha:0.2),\n                            borderRadius: BorderRadius.circular(12),\n                          ),\n                          child: const Icon(Icons.arrow_back, color: Colors.white),\n                        ),\n                      ),\n                      const Spacer(),\n                      Row(\n                        mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                        children: [\n                          Column(\n                            crossAxisAlignment: CrossAxisAlignment.start,\n                            children: [\n                              Text(\n                                'Setup Profile',\n                                style: GoogleFonts.inter(\n                                  fontSize: 16,\n                                  color: Colors.white.withValues(alpha:0.9),\n                                  fontWeight: FontWeight.w500,\n                                ),\n                              ),\n                              const SizedBox(height: 4),\n                              Text(\n                                '$completionPercentage% Done',\n                                style: GoogleFonts.interTight(\n                                  fontSize: 32,\n                                  color: Colors.white,\n                                  fontWeight: FontWeight.bold,\n                                ),\n                              ),\n                            ],\n                          ),\n\n                          // Circular Progress\n                          SizedBox(\n                            width: 60,\n                            height: 60,\n                            child: Stack(\n                              children: [\n                                CircularProgressIndicator(\n                                  value: completionPercentage / 100,\n                                  strokeWidth: 6,\n                                  backgroundColor: Colors.white24,\n                                  valueColor: const AlwaysStoppedAnimation<Color>(Colors.white),\n                                ),\n                                Center(\n                                  child: Text(\n                                    '${(completionPercentage / 16.6).round()}/6',\n                                    style: const TextStyle(\n                                      color: Colors.white,\n                                      fontWeight: FontWeight.bold,\n                                    ),\n                                  ),\n                                )\n                              ],\n                            ),\n                          )\n                        ],\n                      ),\n                      const SizedBox(height: 30),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n\n            // ==========================================\n            // 2\uFE0Fâƒ£ DOCUMENT LIST (Scrollable)\n            // ==========================================\n            Expanded(\n              child: Transform.translate(\n                offset: const Offset(0, -20),\n                child: Container(\n                  margin: const EdgeInsets.symmetric(horizontal: 16),\n                  padding: const EdgeInsets.all(20),\n                  decoration: BoxDecoration(\n                    color: Colors.white,\n                    borderRadius: BorderRadius.circular(24),\n                    boxShadow: [\n                      BoxShadow(\n                        color: Colors.black.withValues(alpha:0.05),\n                        blurRadius: 15,\n                        offset: const Offset(0, 5),\n                      )\n                    ],\n                  ),\n                  child: SingleChildScrollView(\n                    child: Column(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        Text(\n                          'Required Documents',\n                          style: GoogleFonts.inter(\n                            fontSize: 18,\n                            fontWeight: FontWeight.bold,\n                            color: Colors.black87,\n                          ),\n                        ),\n                        const SizedBox(height: 20),\n\n                        _buildDocItem(\n                          'Driving License',\n                          FFAppState().imageLicense,\n                              () => context.pushNamed(DrivingDlWidget.routeName),\n                        ),\n                        const SizedBox(height: 16),\n                        _buildDocItem(\n                          'Profile Photo',\n                          FFAppState().profilePhoto,\n                              () => context.pushNamed(FaceVerifyWidget.routeName),\n                        ),\n                        const SizedBox(height: 16),\n                        _buildDocItem(\n                          'Aadhaar Card',\n                          FFAppState().aadharImage,\n                              () => context.pushNamed(AdharUploadWidget.routeName),\n                        ),\n                        const SizedBox(height: 16),\n                        _buildDocItem(\n                          'PAN Card',\n                          FFAppState().panImage,\n                              () => context.pushNamed(PanuploadScreenWidget.routeName),\n                        ),\n                        const SizedBox(height: 16),\n                        _buildDocItem(\n                          'Vehicle Photo',\n                          FFAppState().vehicleImage,\n                              () => context.pushNamed(VehicleImageWidget.routeName),\n                        ),\n                        const SizedBox(height: 16),\n                        _buildDocItem(\n                          'RC Book',\n                          FFAppState().registrationImage,\n                              () => context.pushNamed(RegistrationImageWidget.routeName),\n                        ),\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n            ),\n\n            // ==========================================\n            // 3\uFE0Fâƒ£ ACTION BUTTON (Fixed Bottom)\n            // ==========================================\n            Container(\n              padding: const EdgeInsets.all(24),\n              decoration: BoxDecoration(\n                color: Colors.white,\n                boxShadow: [\n                  BoxShadow(\n                    color: Colors.black.withValues(alpha:0.05),\n                    blurRadius: 10,\n                    offset: const Offset(0, -5),\n                  )\n                ],\n              ),\n              child: SizedBox(\n                width: double.infinity,\n                height: 56,\n                child: ElevatedButton(\n                  onPressed: _isLoading ? null : () => _handleContinue(allDocsUploaded),\n                  style: ElevatedButton.styleFrom(\n                    backgroundColor: allDocsUploaded ? AppColors.accentEmerald : brandPrimary,\n                    foregroundColor: Colors.white,\n                    elevation: 4,\n                    shape: RoundedRectangleBorder(\n                      borderRadius: BorderRadius.circular(16),\n                    ),\n                  ),\n                  child: _isLoading\n                      ? const SizedBox(\n                    height: 24, width: 24,\n                    child: CircularProgressIndicator(color: Colors.white, strokeWidth: 2.5),\n                  )\n                      : Text(\n                    allDocsUploaded ? 'Submit for Verification' : 'Skip for Now',\n                    style: GoogleFonts.interTight(\n                      fontSize: 18,\n                      fontWeight: FontWeight.bold,\n                      letterSpacing: 0.5,\n                    ),\n                  ),\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  // \uD83D\uDD39 Custom Document List Item\n  Widget _buildDocItem(String title, dynamic docState, VoidCallback onTap) {\n    bool isUploaded = _isDocumentUploaded(docState);\n\n    return InkWell(\n      onTap: onTap,\n      borderRadius: BorderRadius.circular(16),\n      child: Container(\n        padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),\n        decoration: BoxDecoration(\n          color: isUploaded ? AppColors.sectionGreenTint : AppColors.backgroundCard,\n          borderRadius: BorderRadius.circular(16),\n          border: Border.all(\n            color: isUploaded ? AppColors.accentEmerald : AppColors.divider,\n            width: 1.5,\n          ),\n        ),\n        child: Row(\n          children: [\n            Container(\n              width: 44,\n              height: 44,\n              decoration: BoxDecoration(\n                color: isUploaded ? AppColors.sectionGreenTint : Colors.white,\n                shape: BoxShape.circle,\n                border: Border.all(\n                  color: isUploaded ? Colors.transparent : Colors.grey.shade300,\n                ),\n              ),\n              child: Icon(\n                isUploaded ? Icons.check : Icons.upload_file,\n                color: isUploaded ? AppColors.accentEmerald : Colors.grey.shade500,\n                size: 22,\n              ),\n            ),\n            const SizedBox(width: 16),\n            Expanded(\n              child: Column(\n                crossAxisAlignment: CrossAxisAlignment.start,\n                children: [\n                  Text(\n                    title,\n                    style: GoogleFonts.inter(\n                      fontSize: 16,\n                      fontWeight: FontWeight.w600,\n                      color: Colors.black87,\n                    ),\n                  ),\n                  const SizedBox(height: 2),\n                  Text(\n                    isUploaded ? 'Uploaded' : 'Tap to upload',\n                    style: GoogleFonts.inter(\n                      fontSize: 13,\n                      color: isUploaded ? AppColors.accentEmerald : Colors.grey.shade500,\n                      fontWeight: FontWeight.w500,\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            Icon(\n              Icons.chevron_right,\n              color: Colors.grey.shade400,\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  /// Convert date to YYYY-MM-DD for API\n  String _toApiDate(String value) {\n    final v = value.trim();\n    if (v.isEmpty) return v;\n    final m = RegExp(r'^(\\d{1,2})/(\\d{1,2})/(\\d{4})$').firstMatch(v);\n    if (m != null) {\n      final d = m.group(1)!.padLeft(2, '0');\n      final mo = m.group(2)!.padLeft(2, '0');\n      final y = m.group(3)!;\n      return '$y-$mo-$d';\n    }\n    if (RegExp(r'^\\d{4}-\\d{2}-\\d{2}$').hasMatch(v)) return v;\n    return v;\n  }\n\n  // \uD83D\uDD39 Logic: Handle Submit / Skip (Uber-style verification)\n  Future<void> _handleContinue(bool allDocsUploaded) async {\n    if (allDocsUploaded) {\n      // Submit for Verification: run full document verification first\n      final result = DocumentVerificationService.verifyAll();\n      if (!result.isValid) {\n        await showDialog(\n          context: context,\n          builder: (ctx) => AlertDialog(\n            title: const Row(\n              children: [\n                Icon(Icons.warning_amber_rounded, color: Colors.orange, size: 28),\n                SizedBox(width: 12),\n                Text('Verification Required'),\n              ],\n            ),\n            content: SingleChildScrollView(\n              child: Column(\n                mainAxisSize: MainAxisSize.min,\n                crossAxisAlignment: CrossAxisAlignment.start,\n                children: [\n                  const Text(\n                    'Please fix the following before submitting:',\n                    style: TextStyle(fontWeight: FontWeight.w600),\n                  ),\n                  const SizedBox(height: 12),\n                  ...result.errors.map((e) => Padding(\n                    padding: const EdgeInsets.only(bottom: 6),\n                    child: Row(\n                      crossAxisAlignment: CrossAxisAlignment.start,\n                      children: [\n                        const Text('â€¢ ', style: TextStyle(color: Colors.red)),\n                        Expanded(child: Text(e, style: const TextStyle(fontSize: 14))),\n                      ],\n                    ),\n                  )),\n                ],\n              ),\n            ),\n            actions: [\n              TextButton(\n                onPressed: () => Navigator.pop(ctx),\n                child: const Text('OK'),\n              ),\n            ],\n          ),\n        );\n        return;\n      }\n    } else {\n      // Skip: confirm and run minimum validation\n      final confirm = await showDialog<bool>(\n        context: context,\n        builder: (ctx) => AlertDialog(\n          title: const Text('Incomplete Profile'),\n          content: const Text(\n            \"You won't be able to go online until all documents are verified. Continue anyway?\",\n          ),\n          actions: [\n            TextButton(\n              onPressed: () => Navigator.pop(ctx, false),\n              child: const Text('Cancel'),\n            ),\n            TextButton(\n              onPressed: () => Navigator.pop(ctx, true),\n              child: const Text('Skip', style: TextStyle(color: AppColors.primary)),\n            ),\n          ],\n        ),\n      );\n      if (confirm != true) return;\n\n      final minResult = DocumentVerificationService.verifyMinimum();\n      if (!minResult.isValid) {\n        if (mounted) {\n          ScaffoldMessenger.of(context).showSnackBar(\n            SnackBar(\n              content: Text(minResult.errorSummary),\n              backgroundColor: Colors.red,\n              duration: const Duration(seconds: 4),\n            ),\n          );\n        }\n        return;\n      }\n    }\n\n    setState(() => _isLoading = true);\n\n    try {\n      // Prepare JSON Payload - include all collected onboarding data\n      final driverJsonData = <String, dynamic>{\n        'mobile_number': FFAppState().mobileNo.toString(),\n        'first_name': FFAppState().firstName,\n        'last_name': FFAppState().lastName,\n        'email': FFAppState().email,\n        'referal_code': FFAppState().referralCode,\n        'fcm_token': fcm_token ?? '',\n      };\n      if (FFAppState().licenseNumber.isNotEmpty) {\n        driverJsonData['license_number'] = FFAppState().licenseNumber;\n      }\n      if (FFAppState().licenseExpiryDate.isNotEmpty) {\n        driverJsonData['license_expiry_date'] = _toApiDate(FFAppState().licenseExpiryDate);\n      }\n      if (FFAppState().aadharNumber.isNotEmpty) {\n        driverJsonData['aadhaar_number'] = FFAppState().aadharNumber;\n      }\n      if (FFAppState().panNumber.isNotEmpty) {\n        driverJsonData['pan_number'] = FFAppState().panNumber;\n      }\n      if (FFAppState().dateOfBirth.isNotEmpty) {\n        driverJsonData['date_of_birth'] = _toApiDate(FFAppState().dateOfBirth);\n      }\n      if (FFAppState().address.isNotEmpty) {\n        driverJsonData['address'] = FFAppState().address;\n      }\n      if (FFAppState().city.isNotEmpty) {\n        driverJsonData['city'] = FFAppState().city;\n      }\n      if (FFAppState().state.isNotEmpty) {\n        driverJsonData['state'] = FFAppState().state;\n      }\n      if (FFAppState().postalCode.isNotEmpty) {\n        driverJsonData['postal_code'] = FFAppState().postalCode;\n      }\n      if (FFAppState().emergencyContactName.isNotEmpty) {\n        driverJsonData['emergency_contact_name'] = FFAppState().emergencyContactName;\n      }\n      if (FFAppState().emergencyContactPhone.isNotEmpty) {\n        driverJsonData['emergency_contact_phone'] = FFAppState().emergencyContactPhone;\n      }\n\n      final vehicleJsonData = <String, dynamic>{\n        'vehicle_type': FFAppState().selectvehicle.isEmpty ? 'auto' : FFAppState().selectvehicle,\n      };\n      if (FFAppState().adminVehicleId > 0) {\n        vehicleJsonData['admin_vehicle_id'] = FFAppState().adminVehicleId;\n      }\n\n      // 3. API Call\n      _model.apiResult7ju = await CreateDriverCall.call(\n        profileimage: FFAppState().profilePhoto,\n        licenseimage: FFAppState().imageLicense,\n        licenseFrontImage: FFAppState().licenseFrontImage,\n        licenseBackImage: FFAppState().licenseBackImage,\n        aadhaarimage: FFAppState().aadharImage,\n        aadhaarFrontImage: FFAppState().aadhaarFrontImage,\n        aadhaarBackImage: FFAppState().aadhaarBackImage,\n        panimage: FFAppState().panImage,\n        rcFrontImage: FFAppState().rcFrontImage,\n        rcBackImage: FFAppState().rcBackImage,\n        vehicleImage: FFAppState().vehicleImage,\n        registrationImage: FFAppState().registrationImage,\n        driverJson: driverJsonData,\n        vehicleJson: vehicleJsonData,\n        fcmToken: fcm_token ?? '',\n      );\n\n      // 4. Handle Response\n      if (_model.apiResult7ju?.succeeded ?? false) {\n        final jsonBody = _model.apiResult7ju?.jsonBody;\n\n        // Extract token (backend may use access_token, accessToken, or token)\n        String? accessToken = getJsonField(jsonBody, r'''$.data.access_token''')?.toString();\n        accessToken ??= getJsonField(jsonBody, r'''$.data.accessToken''')?.toString();\n        accessToken ??= getJsonField(jsonBody, r'''$.data.token''')?.toString();\n        accessToken ??= getJsonField(jsonBody, r'''$.access_token''')?.toString();\n        accessToken ??= getJsonField(jsonBody, r'''$.accessToken''')?.toString();\n        if (accessToken == 'null' || accessToken == null || accessToken.isEmpty) {\n          accessToken = null;\n        }\n\n        // Extract driverId (backend may use data.driver.id or data.id)\n        int? driverId = castToType<int>(getJsonField(jsonBody, r'''$.data.driver.id'''));\n        driverId ??= castToType<int>(getJsonField(jsonBody, r'''$.data.id'''));\n        driverId ??= castToType<int>(getJsonField(jsonBody, r'''$.data.driver_id'''));\n        driverId ??= 0;\n\n        // If createDriver didn't return a token, fetch via login API (driver now exists)\n        if (accessToken == null || accessToken.isEmpty) {\n          final loginRes = await LoginCall.call(\n            mobile: FFAppState().mobileNo,\n            fcmToken: FFAppState().fcmToken.isNotEmpty ? FFAppState().fcmToken : (fcm_token ?? ''),\n          );\n          if (loginRes.succeeded) {\n            accessToken = getJsonField(loginRes.jsonBody, r'''$.data.accessToken''')?.toString();\n            accessToken ??= getJsonField(loginRes.jsonBody, r'''$.data.access_token''')?.toString();\n            if (driverId == 0) {\n              driverId = castToType<int>(getJsonField(loginRes.jsonBody, r'''$.data.id''')) ?? 0;\n            }\n          }\n        }\n\n        final resolvedDriverId = driverId;\n        if (accessToken != null && accessToken.isNotEmpty && resolvedDriverId > 0) {\n          FFAppState().update(() {\n            FFAppState().isLoggedIn = true;\n            FFAppState().isRegistered = true;\n            FFAppState().driverid = resolvedDriverId;\n            FFAppState().accessToken = accessToken!;\n          });\n\n          if (mounted) {\n            context.pushReplacementNamed(HomeWidget.routeName);\n          }\n        } else {\n          // Token or driverId missing - redirect to login\n          FFAppState().update(() {\n            FFAppState().isLoggedIn = false;\n            FFAppState().isRegistered = true;\n            final id = driverId ?? 0;\n          if (id > 0) FFAppState().driverid = id;\n          });\n          if (mounted) {\n            ScaffoldMessenger.of(context).showSnackBar(\n              const SnackBar(\n                content: Text('Registration complete. Please sign in to continue.'),\n                backgroundColor: Colors.orange,\n              ),\n            );\n            context.pushReplacementNamed(LoginWidget.routeName); // from /index.dart\n          }\n        }\n      } else {\n        // Show Error\n        final errorMsg = getJsonField(_model.apiResult7ju?.jsonBody, r'''$.message''').toString();\n        if (mounted) {\n          ScaffoldMessenger.of(context).showSnackBar(\n            SnackBar(\n              content: Text(errorMsg.isEmpty ? 'Registration Failed' : errorMsg),\n              backgroundColor: Colors.red,\n            ),\n          );\n        }\n      }\n    } catch (e) {\n      print('Error: $e');\n    } finally {\n      if (mounted) setState(() => _isLoading = false);\n    }\n  }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/on_boarding/on_boarding_widget.dart b/lib/on_boarding/on_boarding_widget.dart
--- a/lib/on_boarding/on_boarding_widget.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/on_boarding/on_boarding_widget.dart	(date 1771596363429)
@@ -320,7 +320,7 @@
                 child: ElevatedButton(
                   onPressed: _isLoading ? null : () => _handleContinue(allDocsUploaded),
                   style: ElevatedButton.styleFrom(
-                    backgroundColor: allDocsUploaded ? AppColors.accentEmerald : brandPrimary,
+                    backgroundColor: brandPrimary,
                     foregroundColor: Colors.white,
                     elevation: 4,
                     shape: RoundedRectangleBorder(
@@ -359,10 +359,10 @@
       child: Container(
         padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
         decoration: BoxDecoration(
-          color: isUploaded ? AppColors.sectionGreenTint : AppColors.backgroundCard,
+          color: isUploaded ? AppColors.sectionOrangeLight : AppColors.backgroundCard,
           borderRadius: BorderRadius.circular(16),
           border: Border.all(
-            color: isUploaded ? AppColors.accentEmerald : AppColors.divider,
+            color: isUploaded ? AppColors.primary : AppColors.divider,
             width: 1.5,
           ),
         ),
@@ -372,7 +372,7 @@
               width: 44,
               height: 44,
               decoration: BoxDecoration(
-                color: isUploaded ? AppColors.sectionGreenTint : Colors.white,
+                color: isUploaded ? AppColors.sectionOrangeLight : Colors.white,
                 shape: BoxShape.circle,
                 border: Border.all(
                   color: isUploaded ? Colors.transparent : Colors.grey.shade300,
@@ -380,7 +380,7 @@
               ),
               child: Icon(
                 isUploaded ? Icons.check : Icons.upload_file,
-                color: isUploaded ? AppColors.accentEmerald : Colors.grey.shade500,
+                color: isUploaded ? AppColors.primary : Colors.grey.shade500,
                 size: 22,
               ),
             ),
@@ -402,7 +402,7 @@
                     isUploaded ? 'Uploaded' : 'Tap to upload',
                     style: GoogleFonts.inter(
                       fontSize: 13,
-                      color: isUploaded ? AppColors.accentEmerald : Colors.grey.shade500,
+                      color: isUploaded ? AppColors.primary : Colors.grey.shade500,
                       fontWeight: FontWeight.w500,
                     ),
                   ),
@@ -572,7 +572,17 @@
       };
       if (FFAppState().adminVehicleId > 0) {
         vehicleJsonData['admin_vehicle_id'] = FFAppState().adminVehicleId;
+        vehicleJsonData['vehicle_type_id'] = FFAppState().adminVehicleId;
       }
+      if (FFAppState().vehicleMake.isNotEmpty) vehicleJsonData['vehicle_name'] = FFAppState().vehicleMake;
+      if (FFAppState().vehicleModel.isNotEmpty) vehicleJsonData['vehicle_model'] = FFAppState().vehicleModel;
+      if (FFAppState().vehicleColor.isNotEmpty) vehicleJsonData['vehicle_color'] = FFAppState().vehicleColor;
+      if (FFAppState().licensePlate.isNotEmpty) vehicleJsonData['license_plate'] = FFAppState().licensePlate;
+      if (FFAppState().registrationNumber.isNotEmpty) vehicleJsonData['registration_number'] = FFAppState().registrationNumber;
+      if (FFAppState().registrationDate.isNotEmpty) vehicleJsonData['registration_date'] = FFAppState().registrationDate;
+      if (FFAppState().insuranceNumber.isNotEmpty) vehicleJsonData['insurance_number'] = FFAppState().insuranceNumber;
+      if (FFAppState().insuranceExpiryDate.isNotEmpty) vehicleJsonData['insurance_expiry_date'] = FFAppState().insuranceExpiryDate;
+      if (FFAppState().pollutionExpiryDate.isNotEmpty) vehicleJsonData['pollution_expiry_date'] = FFAppState().pollutionExpiryDate;
 
       // 3. API Call
       _model.apiResult7ju = await CreateDriverCall.call(
@@ -588,6 +598,8 @@
         rcBackImage: FFAppState().rcBackImage,
         vehicleImage: FFAppState().vehicleImage,
         registrationImage: FFAppState().registrationImage,
+        insuranceImage: FFAppState().insuranceImage,
+        pollutionCertificateImage: FFAppState().pollutioncertificateImage,
         driverJson: driverJsonData,
         vehicleJson: vehicleJsonData,
         fcmToken: fcm_token ?? '',
@@ -613,6 +625,20 @@
         driverId ??= castToType<int>(getJsonField(jsonBody, r'''$.data.driver_id'''));
         driverId ??= 0;
 
+        // Extract vehicle data from signup response (data.vehicle)
+        final vehicleData = getJsonField(jsonBody, r'''$.data.vehicle''');
+        if (vehicleData != null && vehicleData is Map) {
+          final vId = castToType<int>(vehicleData['id']) ?? 0;
+          final vTypeId = castToType<int>(vehicleData['vehicle_type_id']) ?? 0;
+          final vType = vehicleData['vehicle_type']?.toString() ?? '';
+          if (vId > 0) FFAppState().vehicleId = vId;
+          if (vTypeId > 0) FFAppState().adminVehicleId = vTypeId;
+          if (vType.isNotEmpty) {
+            FFAppState().selectvehicle = vType;
+            FFAppState().vehicleType = vType;
+          }
+        }
+
         // If createDriver didn't return a token, fetch via login API (driver now exists)
         if (accessToken == null || accessToken.isEmpty) {
           final loginRes = await LoginCall.call(
@@ -635,6 +661,7 @@
             FFAppState().isRegistered = true;
             FFAppState().driverid = resolvedDriverId;
             FFAppState().accessToken = accessToken!;
+            // Vehicle data from signup response already set above
           });
 
           if (mounted) {
Index: lib/vehicle_image/vehicle_image_widget.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/constants/app_colors.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/flutter_flow/upload_data.dart';\nimport 'package:flutter/material.dart';\nimport 'dart:convert';\nimport 'vehicle_image_model.dart';\nexport 'vehicle_image_model.dart';\n\nclass VehicleImageWidget extends StatefulWidget {\n  const VehicleImageWidget({super.key});\n\n  static String routeName = 'vehicleImage';\n  static String routePath = '/vehicleImage';\n\n  @override\n  State<VehicleImageWidget> createState() => _VehicleImageWidgetState();\n}\n\nclass _VehicleImageWidgetState extends State<VehicleImageWidget>\n    with SingleTickerProviderStateMixin {\n  late VehicleImageModel _model;\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n\n  FFUploadedFile? _vehicleImage;\n  bool _isVehicleImageValid = false;\n\n  String? _selectedVehicleType;\n  String? _selectedColor;\n\n  final TextEditingController _makeController = TextEditingController();\n  final TextEditingController _modelController = TextEditingController();\n  final TextEditingController _yearController = TextEditingController();\n\n  late AnimationController _animationController;\n  late Animation<double> _fadeAnimation;\n\n  final List<Map<String, dynamic>> vehicleTypes = [\n    {'name': 'Car', 'icon': '\uD83D\uDE97', 'color': AppColors.accentIndigo},\n    {'name': 'Bike', 'icon': '\uD83C\uDFCD\uFE0F', 'color': AppColors.accentPink},\n    {'name': 'Truck', 'icon': '\uD83D\uDE9A', 'color': AppColors.accentEmerald},\n    {'name': 'SUV', 'icon': '\uD83D\uDE99', 'color': AppColors.accentAmber},\n  ];\n\n  final List<Map<String, dynamic>> vehicleColors = [\n    {'name': 'White', 'color': AppColors.white, 'border': Colors.grey[300]},\n    {'name': 'Black', 'color': AppColors.black, 'border': Colors.black},\n    {'name': 'Silver', 'color': AppColors.silver, 'border': Colors.grey[400]},\n    {'name': 'Red', 'color': AppColors.accentRed, 'border': AppColors.accentRed},\n    {'name': 'Blue', 'color': AppColors.accentBlue, 'border': AppColors.accentBlue},\n    {'name': 'Grey', 'color': AppColors.greyVehicle, 'border': AppColors.greyVehicle},\n  ];\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => VehicleImageModel());\n\n    _animationController = AnimationController(\n      duration: const Duration(milliseconds: 800),\n      vsync: this,\n    );\n\n    _fadeAnimation = CurvedAnimation(\n      parent: _animationController,\n      curve: Curves.easeInOut,\n    );\n\n    _animationController.forward();\n    _loadSavedData();\n  }\n\n  void _loadSavedData() {\n    if (FFAppState().vehicleBase64.isNotEmpty) {\n      try {\n        Uint8List bytes = base64Decode(FFAppState().vehicleBase64);\n        setState(() {\n          _vehicleImage = FFUploadedFile(bytes: bytes, name: 'vehicle.jpg');\n          _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n          _isVehicleImageValid = true;\n        });\n      } catch (e) {\n        print('âŒ Error: $e');\n      }\n    } else if (FFAppState().vehicleImage?.bytes != null) {\n      setState(() {\n        _vehicleImage = FFAppState().vehicleImage;\n        _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n        _isVehicleImageValid = true;\n      });\n    }\n\n    if (FFAppState().vehicleType.isNotEmpty) {\n      setState(() => _selectedVehicleType = FFAppState().vehicleType);\n    }\n    if (FFAppState().vehicleMake.isNotEmpty) {\n      _makeController.text = FFAppState().vehicleMake;\n    }\n    if (FFAppState().vehicleModel.isNotEmpty) {\n      _modelController.text = FFAppState().vehicleModel;\n    }\n    if (FFAppState().vehicleYear.isNotEmpty) {\n      _yearController.text = FFAppState().vehicleYear;\n    }\n    if (FFAppState().vehicleColor.isNotEmpty) {\n      setState(() => _selectedColor = FFAppState().vehicleColor);\n    }\n  }\n\n  @override\n  void dispose() {\n    _model.dispose();\n    _animationController.dispose();\n    _makeController.dispose();\n    _modelController.dispose();\n    _yearController.dispose();\n    super.dispose();\n  }\n\n  void _showSnackBar(String message, {bool isError = false}) {\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Row(\n          children: [\n            Icon(\n              isError ? Icons.error_outline : Icons.check_circle,\n              color: Colors.white,\n              size: 20,\n            ),\n            const SizedBox(width: 10),\n            Expanded(\n              child: Text(message, style: const TextStyle(fontSize: 14)),\n            ),\n          ],\n        ),\n        backgroundColor: isError ? Colors.red[400] : Colors.green[500],\n        behavior: SnackBarBehavior.floating,\n        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),\n        margin: const EdgeInsets.all(16),\n        duration: const Duration(seconds: 3),\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    bool hasImage = (_vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty);\n\n    return GestureDetector(\n      onTap: () => FocusScope.of(context).unfocus(),\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: AppColors.backgroundLight,\n        appBar: AppBar(\n          backgroundColor: Colors.white,\n          elevation: 0,\n          leading: IconButton(\n            icon: const Icon(Icons.arrow_back, color: AppColors.textDark),\n            onPressed: () => context.pop(),\n          ),\n          title: const Text(\n            'Vehicle Details',\n            style: TextStyle(\n              color: AppColors.textDark,\n              fontSize: 18,\n              fontWeight: FontWeight.w600,\n            ),\n          ),\n          centerTitle: true,\n        ),\n        body: SafeArea(\n          child: FadeTransition(\n            opacity: _fadeAnimation,\n            child: SingleChildScrollView(\n              physics: const BouncingScrollPhysics(),\n              child: Padding(\n                padding: const EdgeInsets.all(20.0),\n                child: Column(\n                  crossAxisAlignment: CrossAxisAlignment.start,\n                  children: [\n                    // Vehicle Type\n                    const Text(\n                      'Vehicle Type',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildVehicleTypeGrid(),\n\n                    const SizedBox(height: 24),\n\n                    // Make\n                    _buildSimpleTextField(\n                      controller: _makeController,\n                      label: 'Vehicle Make',\n                      hint: 'e.g., Toyota, Honda',\n                      icon: Icons.directions_car,\n                    ),\n\n                    const SizedBox(height: 20),\n\n                    // Model\n                    _buildSimpleTextField(\n                      controller: _modelController,\n                      label: 'Vehicle Model',\n                      hint: 'e.g., Camry, Civic',\n                      icon: Icons.car_rental,\n                    ),\n\n                    const SizedBox(height: 20),\n\n                    // Year\n                    _buildSimpleTextField(\n                      controller: _yearController,\n                      label: 'Year',\n                      hint: 'e.g., 2023',\n                      icon: Icons.calendar_today,\n                      keyboardType: TextInputType.number,\n                    ),\n\n                    const SizedBox(height: 24),\n\n                    // Color\n                    const Text(\n                      'Vehicle Color',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildColorGrid(),\n\n                    const SizedBox(height: 24),\n\n                    // Photo Upload\n                    const Text(\n                      'Vehicle Photo',\n                      style: TextStyle(\n                        fontSize: 16,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.textDark,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    _buildPhotoUpload(hasImage),\n\n                    const SizedBox(height: 32),\n\n                    // Submit Button\n                    _buildSubmitButton(hasImage),\n\n                    const SizedBox(height: 20),\n                  ],\n                ),\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n\n  Widget _buildVehicleTypeGrid() {\n    return GridView.builder(\n      shrinkWrap: true,\n      physics: const NeverScrollableScrollPhysics(),\n      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(\n        crossAxisCount: 4,\n        crossAxisSpacing: 12,\n        mainAxisSpacing: 12,\n        childAspectRatio: 1,\n      ),\n      itemCount: vehicleTypes.length,\n      itemBuilder: (context, index) {\n        final type = vehicleTypes[index];\n        bool isSelected = _selectedVehicleType == type['name'];\n\n        return GestureDetector(\n          onTap: () {\n            setState(() => _selectedVehicleType = type['name']);\n            FFAppState().vehicleType = type['name'];\n            FFAppState().update(() {});\n          },\n          child: AnimatedContainer(\n            duration: const Duration(milliseconds: 200),\n            decoration: BoxDecoration(\n              color: isSelected ? type['color'] : Colors.white,\n              borderRadius: BorderRadius.circular(16),\n              border: Border.all(\n                color: isSelected ? type['color'] : AppColors.greyBorder,\n                width: 2,\n              ),\n              boxShadow: [\n                if (isSelected)\n                  BoxShadow(\n                    color: type['color'].withValues(alpha:0.3),\n                    blurRadius: 8,\n                    offset: const Offset(0, 4),\n                  ),\n              ],\n            ),\n            child: Column(\n              mainAxisAlignment: MainAxisAlignment.center,\n              children: [\n                Text(\n                  type['icon'],\n                  style: const TextStyle(fontSize: 32),\n                ),\n                const SizedBox(height: 4),\n                Text(\n                  type['name'],\n                  style: TextStyle(\n                    fontSize: 11,\n                    fontWeight: FontWeight.w600,\n                    color: isSelected ? Colors.white : AppColors.greySlate,\n                  ),\n                ),\n              ],\n            ),\n          ),\n        );\n      },\n    );\n  }\n\n  Widget _buildSimpleTextField({\n    required TextEditingController controller,\n    required String label,\n    required String hint,\n    required IconData icon,\n    TextInputType keyboardType = TextInputType.text,\n  }) {\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.start,\n      children: [\n        Text(\n          label,\n          style: const TextStyle(\n            fontSize: 16,\n            fontWeight: FontWeight.w600,\n            color: AppColors.textDark,\n          ),\n        ),\n        const SizedBox(height: 8),\n        Container(\n          decoration: BoxDecoration(\n            color: Colors.white,\n            borderRadius: BorderRadius.circular(12),\n            border: Border.all(\n              color: controller.text.isNotEmpty ? AppColors.accentIndigo : AppColors.greyBorder,\n              width: 2,\n            ),\n          ),\n          child: TextField(\n            controller: controller,\n            keyboardType: keyboardType,\n            style: const TextStyle(\n              fontSize: 15,\n              fontWeight: FontWeight.w500,\n              color: AppColors.textDark,\n            ),\n            decoration: InputDecoration(\n              hintText: hint,\n              hintStyle: const TextStyle(\n                color: AppColors.greyLight,\n                fontSize: 15,\n              ),\n              prefixIcon: Icon(icon, color: AppColors.accentIndigo, size: 20),\n              suffixIcon: controller.text.isNotEmpty\n                  ? const Icon(Icons.check_circle, color: AppColors.accentEmerald, size: 20)\n                  : null,\n              border: InputBorder.none,\n              contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 16),\n            ),\n            onChanged: (value) {\n              setState(() {});\n              if (label == 'Vehicle Make') {\n                FFAppState().vehicleMake = value;\n              } else if (label == 'Vehicle Model') {\n                FFAppState().vehicleModel = value;\n              } else if (label == 'Year') {\n                FFAppState().vehicleYear = value;\n              }\n              FFAppState().update(() {});\n            },\n          ),\n        ),\n      ],\n    );\n  }\n\n  Widget _buildColorGrid() {\n    return Wrap(\n      spacing: 12,\n      runSpacing: 12,\n      children: vehicleColors.map((colorData) {\n        bool isSelected = _selectedColor == colorData['name'];\n        return GestureDetector(\n          onTap: () {\n            setState(() => _selectedColor = colorData['name']);\n            FFAppState().vehicleColor = colorData['name'];\n            FFAppState().update(() {});\n          },\n          child: AnimatedContainer(\n            duration: const Duration(milliseconds: 200),\n            padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),\n            decoration: BoxDecoration(\n              color: isSelected ? AppColors.accentIndigo.withValues(alpha:0.1) : Colors.white,\n              borderRadius: BorderRadius.circular(12),\n              border: Border.all(\n                color: isSelected ? AppColors.accentIndigo : AppColors.greyBorder,\n                width: 2,\n              ),\n            ),\n            child: Row(\n              mainAxisSize: MainAxisSize.min,\n              children: [\n                Container(\n                  width: 24,\n                  height: 24,\n                  decoration: BoxDecoration(\n                    color: colorData['color'],\n                    shape: BoxShape.circle,\n                    border: Border.all(\n                      color: colorData['border'],\n                      width: 2,\n                    ),\n                  ),\n                ),\n                const SizedBox(width: 8),\n                Text(\n                  colorData['name'],\n                  style: TextStyle(\n                    fontSize: 14,\n                    fontWeight: FontWeight.w500,\n                    color: isSelected ? AppColors.accentIndigo : AppColors.greySlate,\n                  ),\n                ),\n                if (isSelected) ...[\n                  const SizedBox(width: 6),\n                  const Icon(Icons.check, size: 16, color: AppColors.accentIndigo),\n                ],\n              ],\n            ),\n          ),\n        );\n      }).toList(),\n    );\n  }\n\n  Widget _buildPhotoUpload(bool hasImage) {\n    return GestureDetector(\n      onTap: () async {\n        final selectedMedia = await selectMediaWithSourceBottomSheet(\n          context: context,\n          allowPhoto: true,\n        );\n        if (selectedMedia != null &&\n            selectedMedia.every((m) => validateFileFormat(m.storagePath, context))) {\n          var selectedUploadedFiles = <FFUploadedFile>[];\n          try {\n            selectedUploadedFiles = selectedMedia\n                .map((m) => FFUploadedFile(\n              name: m.storagePath.split('/').last,\n              bytes: m.bytes,\n              height: m.dimensions?.height,\n              width: m.dimensions?.width,\n              blurHash: m.blurHash,\n              originalFilename: m.originalFilename,\n            ))\n                .toList();\n          } catch (e) {\n            print('âŒ Error: $e');\n          }\n          if (selectedUploadedFiles.isNotEmpty) {\n            setState(() {\n              _vehicleImage = selectedUploadedFiles.first;\n              _model.uploadedLocalFile_uploadData69q = _vehicleImage!;\n              _isVehicleImageValid = true;\n            });\n\n            FFAppState().vehicleImage = _vehicleImage;\n            if (_vehicleImage?.bytes != null) {\n              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);\n            }\n            FFAppState().update(() {});\n            _showSnackBar('Photo uploaded successfully! âœ“');\n          }\n        }\n      },\n      child: AnimatedContainer(\n        duration: const Duration(milliseconds: 300),\n        width: double.infinity,\n        height: 200,\n        decoration: BoxDecoration(\n          color: hasImage ? null : Colors.white,\n          borderRadius: BorderRadius.circular(16),\n          border: Border.all(\n            color: hasImage ? AppColors.accentEmerald : AppColors.greyBorder,\n            width: 2,\n          ),\n        ),\n        child: Stack(\n          children: [\n            ClipRRect(\n              borderRadius: BorderRadius.circular(14),\n              child: _vehicleImage?.bytes != null && _vehicleImage!.bytes!.isNotEmpty\n                  ? Image.memory(\n                _vehicleImage!.bytes!,\n                width: double.infinity,\n                height: double.infinity,\n                fit: BoxFit.cover,\n              )\n                  : Center(\n                child: Column(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    Container(\n                      padding: const EdgeInsets.all(16),\n                      decoration: BoxDecoration(\n                        color: AppColors.accentIndigo.withValues(alpha:0.1),\n                        shape: BoxShape.circle,\n                      ),\n                      child: const Icon(\n                        Icons.add_photo_alternate,\n                        size: 40,\n                        color: AppColors.accentIndigo,\n                      ),\n                    ),\n                    const SizedBox(height: 12),\n                    const Text(\n                      'Tap to upload photo',\n                      style: TextStyle(\n                        fontSize: 15,\n                        fontWeight: FontWeight.w600,\n                        color: AppColors.greySlate,\n                      ),\n                    ),\n                    const SizedBox(height: 4),\n                    const Text(\n                      'Camera or Gallery',\n                      style: TextStyle(\n                        fontSize: 13,\n                        color: AppColors.greyLight,\n                      ),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n\n            if (hasImage)\n              Positioned(\n                top: 8,\n                right: 8,\n                child: GestureDetector(\n                  onTap: () {\n                    setState(() {\n                      _vehicleImage = null;\n                      _isVehicleImageValid = false;\n                    });\n                    FFAppState().vehicleImage = null;\n                    FFAppState().vehicleBase64 = '';\n                    FFAppState().update(() {});\n                    _showSnackBar('Photo removed', isError: true);\n                  },\n                  child: Container(\n                    padding: const EdgeInsets.all(8),\n                    decoration: BoxDecoration(\n                      color: Colors.red[400],\n                      shape: BoxShape.circle,\n                      boxShadow: const [\n                        BoxShadow(\n                          color: Colors.black26,\n                          blurRadius: 4,\n                          offset: Offset(0, 2),\n                        ),\n                      ],\n                    ),\n                    child: const Icon(Icons.close, color: Colors.white, size: 18),\n                  ),\n                ),\n              ),\n\n            if (hasImage && _isVehicleImageValid)\n              Positioned(\n                top: 8,\n                left: 8,\n                child: Container(\n                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),\n                  decoration: BoxDecoration(\n                    color: AppColors.accentEmerald,\n                    borderRadius: BorderRadius.circular(20),\n                    boxShadow: const [\n                      BoxShadow(\n                        color: Colors.black26,\n                        blurRadius: 4,\n                        offset: Offset(0, 2),\n                      ),\n                    ],\n                  ),\n                  child: const Row(\n                    mainAxisSize: MainAxisSize.min,\n                    children: [\n                      Icon(Icons.check_circle, color: Colors.white, size: 16),\n                      SizedBox(width: 4),\n                      Text(\n                        'Uploaded',\n                        style: TextStyle(\n                          color: Colors.white,\n                          fontSize: 12,\n                          fontWeight: FontWeight.w600,\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildSubmitButton(bool hasImage) {\n    bool isFormValid = _selectedVehicleType != null &&\n        _makeController.text.isNotEmpty &&\n        _modelController.text.isNotEmpty &&\n        _yearController.text.isNotEmpty &&\n        _selectedColor != null &&\n        hasImage;\n\n    return Container(\n      width: double.infinity,\n      height: 56,\n      decoration: BoxDecoration(\n        gradient: isFormValid\n            ? const LinearGradient(\n          colors: [AppColors.accentIndigo, AppColors.accentPurple],\n          begin: Alignment.centerLeft,\n          end: Alignment.centerRight,\n        )\n            : null,\n        color: isFormValid ? null : AppColors.greyBorder,\n        borderRadius: BorderRadius.circular(12),\n        boxShadow: isFormValid\n            ? [\n          BoxShadow(\n            color: AppColors.accentIndigo.withValues(alpha:0.4),\n            blurRadius: 12,\n            offset: const Offset(0, 6),\n          ),\n        ]\n            : [],\n      ),\n      child: Material(\n        color: Colors.transparent,\n        child: InkWell(\n          borderRadius: BorderRadius.circular(12),\n          onTap: isFormValid\n              ? () async {\n            FFAppState().vehicleType = _selectedVehicleType!;\n            FFAppState().vehicleYear = _yearController.text;\n            FFAppState().vehicleMake = _makeController.text;\n            FFAppState().vehicleModel = _modelController.text;\n            FFAppState().vehicleColor = _selectedColor!;\n            FFAppState().vehicleImage = _vehicleImage;\n\n            if (_vehicleImage?.bytes != null) {\n              FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);\n            }\n\n            FFAppState().update(() {});\n\n            _showSnackBar('âœ“ Vehicle details saved successfully!');\n\n            await Future.delayed(const Duration(milliseconds: 600));\n            context.pop();\n          }\n              : () {\n            if (_selectedVehicleType == null) {\n              _showSnackBar('Please select vehicle type', isError: true);\n            } else if (_makeController.text.isEmpty) {\n              _showSnackBar('Please enter vehicle make', isError: true);\n            } else if (_modelController.text.isEmpty) {\n              _showSnackBar('Please enter vehicle model', isError: true);\n            } else if (_yearController.text.isEmpty) {\n              _showSnackBar('Please enter year', isError: true);\n            } else if (_selectedColor == null) {\n              _showSnackBar('Please select color', isError: true);\n            } else if (!hasImage) {\n              _showSnackBar('Please upload vehicle photo', isError: true);\n            }\n          },\n          child: Center(\n            child: Text(\n              'Save Vehicle Details',\n              style: TextStyle(\n                color: isFormValid ? Colors.white : AppColors.greyLight,\n                fontSize: 16,\n                fontWeight: FontWeight.w600,\n                letterSpacing: 0.3,\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/vehicle_image/vehicle_image_widget.dart b/lib/vehicle_image/vehicle_image_widget.dart
--- a/lib/vehicle_image/vehicle_image_widget.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/vehicle_image/vehicle_image_widget.dart	(date 1771596651742)
@@ -1,8 +1,12 @@
+import '/backend/api_requests/api_calls.dart';
+import '/config.dart' as app_config;
 import '/constants/app_colors.dart';
+import '/constants/vehicle_data.dart';
 import '/flutter_flow/flutter_flow_util.dart';
 import '/flutter_flow/upload_data.dart';
 import 'package:flutter/material.dart';
 import 'dart:convert';
+import 'dart:typed_data';
 import 'vehicle_image_model.dart';
 export 'vehicle_image_model.dart';
 
@@ -25,26 +29,31 @@
   bool _isVehicleImageValid = false;
 
   String? _selectedVehicleType;
+  int _selectedVehicleTypeId = 0;
   String? _selectedColor;
 
   final TextEditingController _makeController = TextEditingController();
   final TextEditingController _modelController = TextEditingController();
   final TextEditingController _yearController = TextEditingController();
+  final TextEditingController _licensePlateController = TextEditingController();
+  final TextEditingController _regNumberController = TextEditingController();
+  final TextEditingController _regDateController = TextEditingController();
+  final TextEditingController _insuranceNumberController = TextEditingController();
+  final TextEditingController _insuranceExpiryController = TextEditingController();
+  final TextEditingController _pollutionExpiryController = TextEditingController();
 
   late AnimationController _animationController;
   late Animation<double> _fadeAnimation;
+  FFUploadedFile? _pollutionImage;
+  FFUploadedFile? _insuranceImage;
 
-  final List<Map<String, dynamic>> vehicleTypes = [
-    {'name': 'Car', 'icon': 'ðŸš—', 'color': AppColors.accentIndigo},
-    {'name': 'Bike', 'icon': 'ðŸï¸', 'color': AppColors.accentPink},
-    {'name': 'Truck', 'icon': 'ðŸšš', 'color': AppColors.accentEmerald},
-    {'name': 'SUV', 'icon': 'ðŸš™', 'color': AppColors.accentAmber},
-  ];
+  bool _isPollutionValid = false;
+  bool _isInsuranceValid = false;
 
   final List<Map<String, dynamic>> vehicleColors = [
-    {'name': 'White', 'color': AppColors.white, 'border': Colors.grey[300]},
-    {'name': 'Black', 'color': AppColors.black, 'border': Colors.black},
-    {'name': 'Silver', 'color': AppColors.silver, 'border': Colors.grey[400]},
+    {'name': 'White', 'color': AppColors.white, 'border': AppColors.greyBorder},
+    {'name': 'Black', 'color': AppColors.black, 'border': AppColors.black},
+    {'name': 'Silver', 'color': AppColors.silver, 'border': AppColors.greyMid},
     {'name': 'Red', 'color': AppColors.accentRed, 'border': AppColors.accentRed},
     {'name': 'Blue', 'color': AppColors.accentBlue, 'border': AppColors.accentBlue},
     {'name': 'Grey', 'color': AppColors.greyVehicle, 'border': AppColors.greyVehicle},
@@ -89,8 +98,17 @@
       });
     }
 
-    if (FFAppState().vehicleType.isNotEmpty) {
-      setState(() => _selectedVehicleType = FFAppState().vehicleType);
+    // Load vehicle type driver already selected (from Choose Vehicle or saved)
+    if (FFAppState().selectvehicle.isNotEmpty) {
+      setState(() {
+        _selectedVehicleType = FFAppState().selectvehicle;
+        _selectedVehicleTypeId = FFAppState().adminVehicleId;
+      });
+    } else if (FFAppState().vehicleType.isNotEmpty) {
+      setState(() {
+        _selectedVehicleType = FFAppState().vehicleType;
+        _selectedVehicleTypeId = FFAppState().adminVehicleId;
+      });
     }
     if (FFAppState().vehicleMake.isNotEmpty) {
       _makeController.text = FFAppState().vehicleMake;
@@ -104,6 +122,49 @@
     if (FFAppState().vehicleColor.isNotEmpty) {
       setState(() => _selectedColor = FFAppState().vehicleColor);
     }
+    if (FFAppState().licensePlate.isNotEmpty) _licensePlateController.text = FFAppState().licensePlate;
+    if (FFAppState().registrationNumber.isNotEmpty) _regNumberController.text = FFAppState().registrationNumber;
+    if (FFAppState().registrationDate.isNotEmpty) _regDateController.text = FFAppState().registrationDate;
+    if (FFAppState().insuranceNumber.isNotEmpty) _insuranceNumberController.text = FFAppState().insuranceNumber;
+    if (FFAppState().insuranceExpiryDate.isNotEmpty) _insuranceExpiryController.text = FFAppState().insuranceExpiryDate;
+    if (FFAppState().pollutionExpiryDate.isNotEmpty) _pollutionExpiryController.text = FFAppState().pollutionExpiryDate;
+    // Pollution Image
+    if (FFAppState().pollutionBase64.isNotEmpty) {
+      try {
+        Uint8List bytes = base64Decode(FFAppState().pollutionBase64);
+        setState(() {
+          _pollutionImage = FFUploadedFile(bytes: bytes, name: 'pollution.jpg');
+          _isPollutionValid = true;
+        });
+      } catch (e) {
+        print('âŒ Pollution decode error: $e');
+      }
+    } else if (FFAppState().pollutioncertificateImage?.bytes != null &&
+        FFAppState().pollutioncertificateImage!.bytes!.isNotEmpty) {
+      setState(() {
+        _pollutionImage = FFAppState().pollutioncertificateImage;
+        _isPollutionValid = true;
+      });
+    }
+
+    // Insurance Image
+    if (FFAppState().insuranceBase64.isNotEmpty) {
+      try {
+        Uint8List bytes = base64Decode(FFAppState().insuranceBase64);
+        setState(() {
+          _insuranceImage = FFUploadedFile(bytes: bytes, name: 'insurance.jpg');
+          _isInsuranceValid = true;
+        });
+      } catch (e) {
+        print('âŒ Insurance decode error: $e');
+      }
+    } else if (FFAppState().insuranceImage?.bytes != null &&
+        FFAppState().insuranceImage!.bytes!.isNotEmpty) {
+      setState(() {
+        _insuranceImage = FFAppState().insuranceImage;
+        _isInsuranceValid = true;
+      });
+    }
   }
 
   @override
@@ -113,6 +174,12 @@
     _makeController.dispose();
     _modelController.dispose();
     _yearController.dispose();
+    _licensePlateController.dispose();
+    _regNumberController.dispose();
+    _regDateController.dispose();
+    _insuranceNumberController.dispose();
+    _insuranceExpiryController.dispose();
+    _pollutionExpiryController.dispose();
     super.dispose();
   }
 
@@ -123,7 +190,7 @@
           children: [
             Icon(
               isError ? Icons.error_outline : Icons.check_circle,
-              color: Colors.white,
+              color: AppColors.white,
               size: 20,
             ),
             const SizedBox(width: 10),
@@ -132,7 +199,7 @@
             ),
           ],
         ),
-        backgroundColor: isError ? Colors.red[400] : Colors.green[500],
+        backgroundColor: isError ? AppColors.error : AppColors.success,
         behavior: SnackBarBehavior.floating,
         shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
         margin: const EdgeInsets.all(16),
@@ -151,7 +218,7 @@
         key: scaffoldKey,
         backgroundColor: AppColors.backgroundLight,
         appBar: AppBar(
-          backgroundColor: Colors.white,
+          backgroundColor: AppColors.white,
           elevation: 0,
           leading: IconButton(
             icon: const Icon(Icons.arrow_back, color: AppColors.textDark),
@@ -177,9 +244,38 @@
                 child: Column(
                   crossAxisAlignment: CrossAxisAlignment.start,
                   children: [
-                    // Vehicle Type
+                    // Vehicle Name (dynamic from API or static fallback)
+                    _buildVehicleMakeDropdown(),
+
+                    const SizedBox(height: 20),
+
+                    // Vehicle Model (dynamic from API or static fallback)
+                    _buildVehicleModelDropdown(),
+
+                    const SizedBox(height: 20),
+
+                    const Text('Vehicle Color', style: TextStyle(fontSize: 16, fontWeight: FontWeight.w600, color: AppColors.textDark)),
+                    const SizedBox(height: 8),
+                    _buildColorGrid(),
+
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _licensePlateController, label: 'License Plate', hint: 'e.g., AP01AB1234', icon: Icons.badge),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _regNumberController, label: 'Registration Number', hint: 'RC number', icon: Icons.description),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _regDateController, label: 'Registration Date', hint: 'YYYY-MM-DD', icon: Icons.calendar_today, keyboardType: TextInputType.datetime),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _insuranceNumberController, label: 'Insurance Number', hint: 'Policy number', icon: Icons.security),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _insuranceExpiryController, label: 'Insurance Expiry', hint: 'YYYY-MM-DD', icon: Icons.event, keyboardType: TextInputType.datetime),
+                    const SizedBox(height: 20),
+                    _buildSimpleTextField(controller: _pollutionExpiryController, label: 'Pollution Certificate Expiry', hint: 'YYYY-MM-DD', icon: Icons.eco, keyboardType: TextInputType.datetime),
+
+                    const SizedBox(height: 20),
+
+                    // Photo Upload (screenshot: large white card, icon in circle, Tap to upload photo, Camera or Gallery)
                     const Text(
-                      'Vehicle Type',
+                      'Vehicle Photo',
                       style: TextStyle(
                         fontSize: 16,
                         fontWeight: FontWeight.w600,
@@ -187,44 +283,11 @@
                       ),
                     ),
                     const SizedBox(height: 12),
-                    _buildVehicleTypeGrid(),
-
-                    const SizedBox(height: 24),
-
-                    // Make
-                    _buildSimpleTextField(
-                      controller: _makeController,
-                      label: 'Vehicle Make',
-                      hint: 'e.g., Toyota, Honda',
-                      icon: Icons.directions_car,
-                    ),
-
-                    const SizedBox(height: 20),
-
-                    // Model
-                    _buildSimpleTextField(
-                      controller: _modelController,
-                      label: 'Vehicle Model',
-                      hint: 'e.g., Camry, Civic',
-                      icon: Icons.car_rental,
-                    ),
-
-                    const SizedBox(height: 20),
-
-                    // Year
-                    _buildSimpleTextField(
-                      controller: _yearController,
-                      label: 'Year',
-                      hint: 'e.g., 2023',
-                      icon: Icons.calendar_today,
-                      keyboardType: TextInputType.number,
-                    ),
-
+                    _buildPhotoUpload(hasImage),
                     const SizedBox(height: 24),
 
-                    // Color
                     const Text(
-                      'Vehicle Color',
+                      'Pollution Certificate',
                       style: TextStyle(
                         fontSize: 16,
                         fontWeight: FontWeight.w600,
@@ -232,13 +295,27 @@
                       ),
                     ),
                     const SizedBox(height: 12),
-                    _buildColorGrid(),
+                    _buildExtraImageUpload(
+                      image: _pollutionImage,
+                      isValid: _isPollutionValid,
+                      onImageSelected: (file) {
+                        setState(() {
+                          _pollutionImage = file;
+                          _isPollutionValid = true;
+                        });
+
+                        FFAppState().pollutionImage = file;
+                        if (file?.bytes != null) {
+                          FFAppState().pollutionBase64 = base64Encode(file!.bytes!);
+                        }
+                        FFAppState().update(() {});
+                      },
+                    ),
 
                     const SizedBox(height: 24),
 
-                    // Photo Upload
                     const Text(
-                      'Vehicle Photo',
+                      'Insurance Document',
                       style: TextStyle(
                         fontSize: 16,
                         fontWeight: FontWeight.w600,
@@ -246,10 +323,26 @@
                       ),
                     ),
                     const SizedBox(height: 12),
-                    _buildPhotoUpload(hasImage),
+                    _buildExtraImageUpload(
+                      image: _insuranceImage,
+                      isValid: _isInsuranceValid,
+                      onImageSelected: (file) {
+                        setState(() {
+                          _insuranceImage = file;
+                          _isInsuranceValid = true;
+                        });
+
+                        FFAppState().insuranceImage = file;
+                        if (file?.bytes != null) {
+                          FFAppState().insuranceBase64 = base64Encode(file!.bytes!);
+                        }
+                        FFAppState().update(() {});
+                      },
+                    ),
 
                     const SizedBox(height: 32),
 
+
                     // Submit Button
                     _buildSubmitButton(hasImage),
 
@@ -264,66 +357,391 @@
     );
   }
 
-  Widget _buildVehicleTypeGrid() {
-    return GridView.builder(
-      shrinkWrap: true,
-      physics: const NeverScrollableScrollPhysics(),
-      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
-        crossAxisCount: 4,
-        crossAxisSpacing: 12,
-        mainAxisSpacing: 12,
-        childAspectRatio: 1,
-      ),
-      itemCount: vehicleTypes.length,
-      itemBuilder: (context, index) {
-        final type = vehicleTypes[index];
-        bool isSelected = _selectedVehicleType == type['name'];
+
+
+
+
+  Widget _buildExtraImageUpload({
+    required FFUploadedFile? image,
+    required bool isValid,
+    required Function(FFUploadedFile?) onImageSelected,
+  }) {
+    bool hasImage =
+    (image?.bytes != null && image!.bytes!.isNotEmpty);
+
+    return GestureDetector(
+      onTap: () async {
+        final selectedMedia = await selectMediaWithSourceBottomSheet(
+          context: context,
+          allowPhoto: true,
+        );
+
+        if (selectedMedia != null &&
+            selectedMedia.every(
+                    (m) => validateFileFormat(m.storagePath, context))) {
+          final file = FFUploadedFile(
+            name: selectedMedia.first.storagePath.split('/').last,
+            bytes: selectedMedia.first.bytes,
+          );
+
+          onImageSelected(file);
+          _showSnackBar('Photo uploaded successfully! âœ“');
+        }
+      },
+      child: Container(
+        width: double.infinity,
+        height: 180,
+        decoration: BoxDecoration(
+          color: AppColors.white,
+          borderRadius: BorderRadius.circular(16),
+          border: Border.all(
+            color: hasImage ? AppColors.primary : AppColors.greyBorder,
+            width: 1.5,
+          ),
+        ),
+        child: hasImage
+            ? ClipRRect(
+          borderRadius: BorderRadius.circular(14),
+          child: Image.memory(
+            image!.bytes!,
+            fit: BoxFit.cover,
+            width: double.infinity,
+            height: double.infinity,
+          ),
+        )
+            : Center(
+          child: Column(
+            mainAxisAlignment: MainAxisAlignment.center,
+            children: [
+              Container(
+                padding: const EdgeInsets.all(16),
+                decoration: BoxDecoration(
+                  color: AppColors.sectionOrangeLight,
+                  shape: BoxShape.circle,
+                ),
+                child: Icon(Icons.add_photo_alternate, size: 40, color: AppColors.primary),
+              ),
+              const SizedBox(height: 12),
+              Text(
+                'Tap to upload',
+                style: TextStyle(
+                  fontWeight: FontWeight.w600,
+                  color: AppColors.greySlate,
+                  fontSize: 15,
+                ),
+              ),
+            ],
+          ),
+        ),
+      ),
+    );
+  }
+
+  Widget _buildVehicleTypeFromApi() {
+    return FutureBuilder<ApiCallResponse>(
+      future: ChoosevehicleCall.call(),
+      builder: (context, snapshot) {
+        if (!snapshot.hasData) {
+          return Container(
+            padding: const EdgeInsets.all(24),
+            decoration: BoxDecoration(
+              color: AppColors.white,
+              borderRadius: BorderRadius.circular(16),
+              border: Border.all(color: AppColors.greyBorder),
+            ),
+            child: const Center(
+              child: SizedBox(
+                height: 32,
+                width: 32,
+                child: CircularProgressIndicator(
+                  strokeWidth: 2.5,
+                  valueColor: AlwaysStoppedAnimation<Color>(AppColors.primary),
+                ),
+              ),
+            ),
+          );
+        }
+        if (snapshot.hasError || snapshot.data?.statusCode != 200) {
+          return Container(
+            padding: const EdgeInsets.all(20),
+            decoration: BoxDecoration(
+              color: AppColors.white,
+              borderRadius: BorderRadius.circular(16),
+              border: Border.all(color: AppColors.greyBorder),
+            ),
+            child: Row(
+              children: [
+                Icon(Icons.cloud_off, color: AppColors.greySlate, size: 28),
+                const SizedBox(width: 12),
+                Expanded(
+                  child: Text(
+                    'Could not load vehicle types',
+                    style: TextStyle(color: AppColors.greySlate, fontSize: 14),
+                  ),
+                ),
+                TextButton(
+                  onPressed: () => setState(() {}),
+                  child: const Text('Retry', style: TextStyle(color: AppColors.primary, fontWeight: FontWeight.w600)),
+                ),
+              ],
+            ),
+          );
+        }
+        final rawList = ChoosevehicleCall.data(snapshot.data!.jsonBody);
+        final list = (rawList is List) ? rawList : [];
+        if (list.isEmpty) {
+          return Container(
+            padding: const EdgeInsets.all(20),
+            decoration: BoxDecoration(
+              color: AppColors.white,
+              borderRadius: BorderRadius.circular(16),
+              border: Border.all(color: AppColors.greyBorder),
+            ),
+            child: Text('No vehicle types available', style: TextStyle(color: AppColors.greySlate, fontSize: 14)),
+          );
+        }
+        return ListView.separated(
+          shrinkWrap: true,
+          physics: const NeverScrollableScrollPhysics(),
+          itemCount: list.length,
+          separatorBuilder: (_, __) => const SizedBox(height: 12),
+          itemBuilder: (context, index) {
+            final item = list[index];
+            String name = '';
+            int id = 0;
+            String? imagePath;
+            if (item is Map) {
+              name = item['name']?.toString() ?? '';
+              id = castToType<int>(item['id']) ?? 0;
+              imagePath = item['image']?.toString();
+            } else {
+              name = getJsonField(item, r'$["name"]')?.toString() ?? '';
+              id = castToType<int>(getJsonField(item, r'$["id"]')) ?? 0;
+              imagePath = getJsonField(item, r'$["image"]')?.toString();
+            }
+            if (name.isEmpty) name = 'Unknown';
+            final imageUrl = (imagePath != null && imagePath.isNotEmpty && imagePath != 'null')
+                ? (imagePath.startsWith('http') ? imagePath : '${app_config.Config.baseUrl}${imagePath.startsWith('/') ? imagePath : '/$imagePath'}')
+                : null;
+            final isSelected = (_selectedVehicleType != null && _selectedVehicleType!.toLowerCase() == name.toLowerCase()) || _selectedVehicleTypeId == id;
+            return _buildVehicleTypeCard(name, id, imageUrl, isSelected);
+          },
+        );
+      },
+    );
+  }
 
-        return GestureDetector(
-          onTap: () {
-            setState(() => _selectedVehicleType = type['name']);
-            FFAppState().vehicleType = type['name'];
-            FFAppState().update(() {});
-          },
-          child: AnimatedContainer(
-            duration: const Duration(milliseconds: 200),
-            decoration: BoxDecoration(
-              color: isSelected ? type['color'] : Colors.white,
-              borderRadius: BorderRadius.circular(16),
-              border: Border.all(
-                color: isSelected ? type['color'] : AppColors.greyBorder,
-                width: 2,
+  Widget _buildVehicleTypeCard(String name, int id, String? imageUrl, bool isSelected) {
+    return InkWell(
+      onTap: () {
+        setState(() {
+          _selectedVehicleType = name;
+          _selectedVehicleTypeId = id;
+        });
+        FFAppState().selectvehicle = name;
+        FFAppState().adminVehicleId = id;
+        FFAppState().vehicleType = name;
+        FFAppState().update(() {});
+      },
+      borderRadius: BorderRadius.circular(16),
+      child: Container(
+        padding: const EdgeInsets.all(16),
+        decoration: BoxDecoration(
+          color: isSelected ? AppColors.sectionOrangeLight : AppColors.white,
+          borderRadius: BorderRadius.circular(16),
+          border: Border.all(
+            color: isSelected ? AppColors.primary : AppColors.greyBorder,
+            width: isSelected ? 2 : 1.5,
+          ),
+        ),
+        child: Row(
+          children: [
+            ClipRRect(
+              borderRadius: BorderRadius.circular(12),
+              child: Container(
+                width: 56,
+                height: 56,
+                decoration: BoxDecoration(
+                  color: isSelected ? AppColors.sectionOrangeLight : AppColors.backgroundCard,
+                  borderRadius: BorderRadius.circular(12),
+                ),
+                child: imageUrl != null
+                    ? Image.network(imageUrl, fit: BoxFit.cover, errorBuilder: (_, __, ___) => Icon(_getVehicleIcon(name), size: 28, color: isSelected ? AppColors.primary : AppColors.greySlate))
+                    : Icon(_getVehicleIcon(name), size: 28, color: isSelected ? AppColors.primary : AppColors.greySlate),
               ),
-              boxShadow: [
-                if (isSelected)
-                  BoxShadow(
-                    color: type['color'].withValues(alpha:0.3),
-                    blurRadius: 8,
-                    offset: const Offset(0, 4),
-                  ),
-              ],
-            ),
-            child: Column(
-              mainAxisAlignment: MainAxisAlignment.center,
-              children: [
-                Text(
-                  type['icon'],
-                  style: const TextStyle(fontSize: 32),
-                ),
-                const SizedBox(height: 4),
-                Text(
-                  type['name'],
-                  style: TextStyle(
-                    fontSize: 11,
-                    fontWeight: FontWeight.w600,
-                    color: isSelected ? Colors.white : AppColors.greySlate,
-                  ),
-                ),
-              ],
+            ),
+            const SizedBox(width: 16),
+            Expanded(
+              child: Text(
+                name,
+                style: TextStyle(
+                  fontSize: 16,
+                  fontWeight: isSelected ? FontWeight.bold : FontWeight.w600,
+                  color: isSelected ? AppColors.textDark : AppColors.greySlate,
+                ),
+              ),
+            ),
+            Icon(
+              isSelected ? Icons.check_circle : Icons.radio_button_unchecked,
+              color: isSelected ? AppColors.primary : AppColors.greyBorder,
+              size: 26,
+            ),
+          ],
+        ),
+      ),
+    );
+  }
+
+  Widget _buildSelectedVehicleTypeChip(String vehicleName) {
+    return Container(
+      padding: const EdgeInsets.symmetric(horizontal: 14, vertical: 10),
+      decoration: BoxDecoration(
+        color: AppColors.sectionOrangeLight,
+        borderRadius: BorderRadius.circular(12),
+        border: Border.all(color: AppColors.primary, width: 1.5),
+      ),
+      child: Row(
+        mainAxisSize: MainAxisSize.min,
+        children: [
+          Icon(Icons.check_circle, color: AppColors.primary, size: 20),
+          const SizedBox(width: 10),
+          Text(
+            'Selected: $vehicleName',
+            style: const TextStyle(
+              fontSize: 15,
+              fontWeight: FontWeight.w600,
+              color: AppColors.textDark,
+            ),
+          ),
+        ],
+      ),
+    );
+  }
+
+  IconData _getVehicleIcon(String name) {
+    final n = name.toLowerCase();
+    if (n.contains('auto')) return Icons.local_taxi;
+    if (n.contains('bike') || n.contains('motorcycle')) return Icons.two_wheeler;
+    if (n.contains('car') || n.contains('sedan') || n.contains('suv')) return Icons.directions_car;
+    if (n.contains('truck')) return Icons.local_shipping;
+    return Icons.directions_car_rounded;
+  }
+
+  Widget _buildVehicleMakeDropdown() {
+    return FutureBuilder<ApiCallResponse>(
+      future: GetVehicleMakesCall.call(),
+      builder: (context, snapshot) {
+        List<String> options = VehicleData.defaultMakes;
+        if (snapshot.hasData &&
+            snapshot.data?.statusCode == 200 &&
+            GetVehicleMakesCall.names(snapshot.data!.jsonBody) != null) {
+          final apiList = GetVehicleMakesCall.names(snapshot.data!.jsonBody)!;
+          if (apiList.isNotEmpty) options = apiList;
+        }
+        if (_makeController.text.isNotEmpty && !options.contains(_makeController.text)) {
+          options = [_makeController.text, ...options];
+        }
+        return _buildDropdownField(
+          label: 'Vehicle Name',
+          hint: 'Select make (e.g., Toyota, Honda)',
+          icon: Icons.directions_car,
+          value: _makeController.text.isEmpty ? null : _makeController.text,
+          items: options,
+          onChanged: (v) {
+            setState(() {
+              _makeController.text = v ?? '';
+              FFAppState().vehicleMake = _makeController.text;
+              FFAppState().vehicleName = _makeController.text;
+              FFAppState().update(() {});
+            });
+          },
+        );
+      },
+    );
+  }
+
+  Widget _buildVehicleModelDropdown() {
+    return FutureBuilder<ApiCallResponse>(
+      key: ValueKey(_makeController.text),
+      future: GetVehicleModelsCall.call(makeName: _makeController.text),
+      builder: (context, snapshot) {
+        List<String> options = VehicleData.defaultModels;
+        if (snapshot.hasData &&
+            snapshot.data?.statusCode == 200 &&
+            GetVehicleModelsCall.names(snapshot.data!.jsonBody) != null) {
+          final apiList = GetVehicleModelsCall.names(snapshot.data!.jsonBody)!;
+          if (apiList.isNotEmpty) options = apiList;
+        }
+        if (_modelController.text.isNotEmpty && !options.contains(_modelController.text)) {
+          options = [_modelController.text, ...options];
+        }
+        return _buildDropdownField(
+          label: 'Vehicle Model',
+          hint: 'Select model (e.g., Camry, Civic)',
+          icon: Icons.car_rental,
+          value: _modelController.text.isEmpty ? null : _modelController.text,
+          items: options,
+          onChanged: (v) {
+            setState(() {
+              _modelController.text = v ?? '';
+              FFAppState().vehicleModel = _modelController.text;
+              FFAppState().update(() {});
+            });
+          },
+        );
+      },
+    );
+  }
+
+  Widget _buildDropdownField({
+    required String label,
+    required String hint,
+    required IconData icon,
+    required String? value,
+    required List<String> items,
+    required ValueChanged<String?> onChanged,
+  }) {
+    return Column(
+      crossAxisAlignment: CrossAxisAlignment.start,
+      children: [
+        Text(
+          label,
+          style: const TextStyle(
+            fontSize: 16,
+            fontWeight: FontWeight.w600,
+            color: AppColors.textDark,
+          ),
+        ),
+        const SizedBox(height: 8),
+        Container(
+          decoration: BoxDecoration(
+            color: AppColors.white,
+            borderRadius: BorderRadius.circular(12),
+            border: Border.all(
+              color: (value != null && value.isNotEmpty) ? AppColors.primary : AppColors.greyBorder,
+              width: 1.5,
             ),
           ),
-        );
-      },
+          child: DropdownButtonFormField<String>(
+            value: (value != null && value.isNotEmpty && items.contains(value)) ? value : null,
+            decoration: InputDecoration(
+              hintText: hint,
+              hintStyle: const TextStyle(color: AppColors.greyLight, fontSize: 15),
+              prefixIcon: Icon(icon, color: AppColors.primary, size: 20),
+              suffixIcon: (value != null && value.isNotEmpty)
+                  ? const Icon(Icons.check_circle, color: AppColors.success, size: 20)
+                  : null,
+              border: InputBorder.none,
+              contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
+            ),
+            icon: const Icon(Icons.keyboard_arrow_down, color: AppColors.greySlate),
+            dropdownColor: AppColors.white,
+            isExpanded: true,
+            items: items.map((s) => DropdownMenuItem<String>(value: s, child: Text(s, style: const TextStyle(fontSize: 15, color: AppColors.textDark)))).toList(),
+            onChanged: onChanged,
+          ),
+        ),
+      ],
     );
   }
 
@@ -348,11 +766,11 @@
         const SizedBox(height: 8),
         Container(
           decoration: BoxDecoration(
-            color: Colors.white,
+            color: AppColors.white,
             borderRadius: BorderRadius.circular(12),
             border: Border.all(
-              color: controller.text.isNotEmpty ? AppColors.accentIndigo : AppColors.greyBorder,
-              width: 2,
+              color: controller.text.isNotEmpty ? AppColors.primary : AppColors.greyBorder,
+              width: 1.5,
             ),
           ),
           child: TextField(
@@ -369,21 +787,34 @@
                 color: AppColors.greyLight,
                 fontSize: 15,
               ),
-              prefixIcon: Icon(icon, color: AppColors.accentIndigo, size: 20),
+              prefixIcon: Icon(icon, color: AppColors.primary, size: 20),
               suffixIcon: controller.text.isNotEmpty
-                  ? const Icon(Icons.check_circle, color: AppColors.accentEmerald, size: 20)
+                  ? const Icon(Icons.check_circle, color: AppColors.success, size: 20)
                   : null,
               border: InputBorder.none,
               contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 16),
             ),
             onChanged: (value) {
               setState(() {});
-              if (label == 'Vehicle Make') {
+              if (label == 'Vehicle Name') {
+                FFAppState().vehicleName = value;
                 FFAppState().vehicleMake = value;
               } else if (label == 'Vehicle Model') {
                 FFAppState().vehicleModel = value;
               } else if (label == 'Year') {
                 FFAppState().vehicleYear = value;
+              } else if (label == 'License Plate') {
+                FFAppState().licensePlate = value;
+              } else if (label == 'Registration Number') {
+                FFAppState().registrationNumber = value;
+              } else if (label == 'Registration Date') {
+                FFAppState().registrationDate = value;
+              } else if (label == 'Insurance Number') {
+                FFAppState().insuranceNumber = value;
+              } else if (label == 'Insurance Expiry') {
+                FFAppState().insuranceExpiryDate = value;
+              } else if (label == 'Pollution Certificate Expiry') {
+                FFAppState().pollutionExpiryDate = value;
               }
               FFAppState().update(() {});
             },
@@ -409,10 +840,10 @@
             duration: const Duration(milliseconds: 200),
             padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),
             decoration: BoxDecoration(
-              color: isSelected ? AppColors.accentIndigo.withValues(alpha:0.1) : Colors.white,
+              color: isSelected ? AppColors.sectionOrangeLight : AppColors.white,
               borderRadius: BorderRadius.circular(12),
               border: Border.all(
-                color: isSelected ? AppColors.accentIndigo : AppColors.greyBorder,
+                color: isSelected ? AppColors.primary : AppColors.greyBorder,
                 width: 2,
               ),
             ),
@@ -437,12 +868,12 @@
                   style: TextStyle(
                     fontSize: 14,
                     fontWeight: FontWeight.w500,
-                    color: isSelected ? AppColors.accentIndigo : AppColors.greySlate,
+                    color: isSelected ? AppColors.primary: AppColors.greySlate,
                   ),
                 ),
                 if (isSelected) ...[
                   const SizedBox(width: 6),
-                  const Icon(Icons.check, size: 16, color: AppColors.accentIndigo),
+                  const Icon(Icons.check, size: 16, color: AppColors.primary),
                 ],
               ],
             ),
@@ -497,11 +928,11 @@
         width: double.infinity,
         height: 200,
         decoration: BoxDecoration(
-          color: hasImage ? null : Colors.white,
+          color: AppColors.white,
           borderRadius: BorderRadius.circular(16),
           border: Border.all(
-            color: hasImage ? AppColors.accentEmerald : AppColors.greyBorder,
-            width: 2,
+            color: hasImage ? AppColors.primary : AppColors.greyBorder,
+            width: 1.5,
           ),
         ),
         child: Stack(
@@ -522,13 +953,13 @@
                     Container(
                       padding: const EdgeInsets.all(16),
                       decoration: BoxDecoration(
-                        color: AppColors.accentIndigo.withValues(alpha:0.1),
+                        color: AppColors.sectionOrangeLight,
                         shape: BoxShape.circle,
                       ),
                       child: const Icon(
                         Icons.add_photo_alternate,
                         size: 40,
-                        color: AppColors.accentIndigo,
+                        color: AppColors.primary,
                       ),
                     ),
                     const SizedBox(height: 12),
@@ -571,17 +1002,17 @@
                   child: Container(
                     padding: const EdgeInsets.all(8),
                     decoration: BoxDecoration(
-                      color: Colors.red[400],
+                      color: AppColors.error,
                       shape: BoxShape.circle,
-                      boxShadow: const [
+                      boxShadow: [
                         BoxShadow(
-                          color: Colors.black26,
+                          color: AppColors.black.withValues(alpha: 0.26),
                           blurRadius: 4,
-                          offset: Offset(0, 2),
+                          offset: const Offset(0, 2),
                         ),
                       ],
                     ),
-                    child: const Icon(Icons.close, color: Colors.white, size: 18),
+                    child: const Icon(Icons.close, color: AppColors.white, size: 18),
                   ),
                 ),
               ),
@@ -593,25 +1024,25 @@
                 child: Container(
                   padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
                   decoration: BoxDecoration(
-                    color: AppColors.accentEmerald,
+                    color: AppColors.primary,
                     borderRadius: BorderRadius.circular(20),
-                    boxShadow: const [
+                    boxShadow: [
                       BoxShadow(
-                        color: Colors.black26,
+                        color: AppColors.black.withValues(alpha: 0.26),
                         blurRadius: 4,
-                        offset: Offset(0, 2),
+                        offset: const Offset(0, 2),
                       ),
                     ],
                   ),
                   child: const Row(
                     mainAxisSize: MainAxisSize.min,
                     children: [
-                      Icon(Icons.check_circle, color: Colors.white, size: 16),
+                      Icon(Icons.check_circle, color: AppColors.white, size: 16),
                       SizedBox(width: 4),
                       Text(
                         'Uploaded',
                         style: TextStyle(
-                          color: Colors.white,
+                          color: AppColors.white,
                           fontSize: 12,
                           fontWeight: FontWeight.w600,
                         ),
@@ -627,12 +1058,15 @@
   }
 
   Widget _buildSubmitButton(bool hasImage) {
-    bool isFormValid = _selectedVehicleType != null &&
+    final hasVehicleType = (_selectedVehicleType != null && _selectedVehicleType!.isNotEmpty) ||
+        FFAppState().selectvehicle.isNotEmpty ||
+        FFAppState().vehicleType.isNotEmpty;
+    bool isFormValid = hasVehicleType &&
         _makeController.text.isNotEmpty &&
         _modelController.text.isNotEmpty &&
-        _yearController.text.isNotEmpty &&
-        _selectedColor != null &&
-        hasImage;
+        hasImage &&
+        _pollutionImage != null &&
+        _insuranceImage != null;
 
     return Container(
       width: double.infinity,
@@ -640,7 +1074,7 @@
       decoration: BoxDecoration(
         gradient: isFormValid
             ? const LinearGradient(
-          colors: [AppColors.accentIndigo, AppColors.accentPurple],
+          colors: [AppColors.primary, AppColors.primary],
           begin: Alignment.centerLeft,
           end: Alignment.centerRight,
         )
@@ -650,7 +1084,7 @@
         boxShadow: isFormValid
             ? [
           BoxShadow(
-            color: AppColors.accentIndigo.withValues(alpha:0.4),
+            color: AppColors.primary.withValues(alpha:0.4),
             blurRadius: 12,
             offset: const Offset(0, 6),
           ),
@@ -663,12 +1097,25 @@
           borderRadius: BorderRadius.circular(12),
           onTap: isFormValid
               ? () async {
-            FFAppState().vehicleType = _selectedVehicleType!;
-            FFAppState().vehicleYear = _yearController.text;
+            final vType = _selectedVehicleType ?? (FFAppState().selectvehicle.isNotEmpty ? FFAppState().selectvehicle : FFAppState().vehicleType);
+            if (vType.isNotEmpty) {
+              FFAppState().vehicleType = vType;
+              FFAppState().selectvehicle = vType;
+              if (_selectedVehicleTypeId > 0) FFAppState().adminVehicleId = _selectedVehicleTypeId;
+            }
+            FFAppState().vehicleName = _makeController.text;
             FFAppState().vehicleMake = _makeController.text;
             FFAppState().vehicleModel = _modelController.text;
-            FFAppState().vehicleColor = _selectedColor!;
+            FFAppState().vehicleColor = _selectedColor ?? '';
+            FFAppState().licensePlate = _licensePlateController.text;
+            FFAppState().registrationNumber = _regNumberController.text;
+            FFAppState().registrationDate = _regDateController.text;
+            FFAppState().insuranceNumber = _insuranceNumberController.text;
+            FFAppState().insuranceExpiryDate = _insuranceExpiryController.text;
+            FFAppState().pollutionExpiryDate = _pollutionExpiryController.text;
             FFAppState().vehicleImage = _vehicleImage;
+            FFAppState().pollutionImage = _pollutionImage;
+            FFAppState().insuranceImage = _insuranceImage;
 
             if (_vehicleImage?.bytes != null) {
               FFAppState().vehicleBase64 = base64Encode(_vehicleImage!.bytes!);
@@ -682,25 +1129,27 @@
             context.pop();
           }
               : () {
-            if (_selectedVehicleType == null) {
-              _showSnackBar('Please select vehicle type', isError: true);
+            if (!hasVehicleType) {
+              _showSnackBar('Please select vehicle type first (from Choose Vehicle)', isError: true);
             } else if (_makeController.text.isEmpty) {
-              _showSnackBar('Please enter vehicle make', isError: true);
+              _showSnackBar('Please enter vehicle name', isError: true);
             } else if (_modelController.text.isEmpty) {
               _showSnackBar('Please enter vehicle model', isError: true);
-            } else if (_yearController.text.isEmpty) {
-              _showSnackBar('Please enter year', isError: true);
-            } else if (_selectedColor == null) {
-              _showSnackBar('Please select color', isError: true);
             } else if (!hasImage) {
               _showSnackBar('Please upload vehicle photo', isError: true);
             }
+            else if (_pollutionImage == null) {
+              _showSnackBar('Please upload pollution photo', isError: true);
+            }
+            else if (_insuranceImage == null) {
+              _showSnackBar('Please upload insurance photo', isError: true);
+            }
           },
           child: Center(
             child: Text(
               'Save Vehicle Details',
               style: TextStyle(
-                color: isFormValid ? Colors.white : AppColors.greyLight,
+                color: isFormValid ? AppColors.white : AppColors.greyLight,
                 fontSize: 16,
                 fontWeight: FontWeight.w600,
                 letterSpacing: 0.3,
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"AutoImportSettings\">\n    <option name=\"autoReloadType\" value=\"NONE\" />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"379021e6-8404-4cbe-8db7-751ea3ec972c\" name=\"Changes\" comment=\"responsive audit fix done\">\n      <change beforePath=\"$PROJECT_DIR$/lib/app_state.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/app_state.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/driving_dl/driving_dl_update.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/driving_dl/driving_dl_update.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/driving_dl/driving_dl_widget.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/driving_dl/driving_dl_widget.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/firstdetails/firstdetails_widget.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/firstdetails/firstdetails_widget.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/flutter_flow/nav/nav.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/flutter_flow/nav/nav.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/index.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/index.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/on_boarding/on_boarding_widget.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/on_boarding/on_boarding_widget.dart\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/lib/utils/input_validators.dart\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/lib/utils/input_validators.dart\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"ClangdSettings\">\n    <option name=\"formatViaClangd\" value=\"false\" />\n  </component>\n  <component name=\"DartProblemsView\" auto-scroll-to-source=\"true\" group-by-severity=\"false\" />\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"Dart File\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n    <option name=\"RESET_MODE\" value=\"HARD\" />\n  </component>\n  <component name=\"GitHubPullRequestSearchHistory\">{\n  &quot;lastFilter&quot;: {\n    &quot;state&quot;: &quot;OPEN&quot;,\n    &quot;assignee&quot;: &quot;dhacodedesignersprivatelimited&quot;\n  }\n}</component>\n  <component name=\"GithubPullRequestsUISettings\">{\n  &quot;selectedUrlAndAccountId&quot;: {\n    &quot;url&quot;: &quot;https://github.com/mekala-111/ugo_drivers.git&quot;,\n    &quot;accountId&quot;: &quot;4ee35345-86d9-41f6-9b9c-d46fd7985e51&quot;\n  }\n}</component>\n  <component name=\"ProjectColorInfo\">{\n  &quot;associatedIndex&quot;: 0\n}</component>\n  <component name=\"ProjectId\" id=\"38KNIA6WeDUQBYtg5A0fEakWjnu\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\">{\n  &quot;keyToString&quot;: {\n    &quot;ASKED_SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,\n    &quot;Flutter.main.dart.executor&quot;: &quot;Run&quot;,\n    &quot;ModuleVcsDetector.initialDetectionPerformed&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.cidr.known.project.marker&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.readMode.enableVisualFormatting&quot;: &quot;true&quot;,\n    &quot;SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,\n    &quot;cf.first.check.clang-format&quot;: &quot;false&quot;,\n    &quot;cidr.known.project.marker&quot;: &quot;true&quot;,\n    &quot;com.google.services.firebase.aqiPopupShown&quot;: &quot;true&quot;,\n    &quot;dart.analysis.tool.window.visible&quot;: &quot;false&quot;,\n    &quot;git-widget-placeholder&quot;: &quot;main&quot;,\n    &quot;io.flutter.project.isFirstOpen&quot;: &quot;true&quot;,\n    &quot;io.flutter.reload.alreadyRun&quot;: &quot;true&quot;,\n    &quot;kotlin-language-version-configured&quot;: &quot;true&quot;,\n    &quot;last_opened_file_path&quot;: &quot;/Users/mekalamanjunadh/StudioProjects/ugo_drivers/android/app&quot;,\n    &quot;settings.editor.selected.configurable&quot;: &quot;AndroidSdkUpdater&quot;,\n    &quot;show.migrate.to.gradle.popup&quot;: &quot;false&quot;\n  }\n}</component>\n  <component name=\"RecentsManager\">\n    <key name=\"CopyFile.RECENT_KEYS\">\n      <recent name=\"$PROJECT_DIR$/android/app\" />\n    </key>\n  </component>\n  <component name=\"SvnConfiguration\">\n    <configuration>$USER_HOME$/.subversion</configuration>\n  </component>\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"379021e6-8404-4cbe-8db7-751ea3ec972c\" name=\"Changes\" comment=\"\" />\n      <created>1768544220292</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1768544220292</updated>\n    </task>\n    <task id=\"LOCAL-00001\" summary=\"new project of ugo\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1768546578103</created>\n      <option name=\"number\" value=\"00001\" />\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1768546578103</updated>\n    </task>\n    <task id=\"LOCAL-00002\" summary=\"Package update\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1769416117615</created>\n      <option name=\"number\" value=\"00002\" />\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1769416117615</updated>\n    </task>\n    <task id=\"LOCAL-00003\" summary=\"push update 032026\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1770129815404</created>\n      <option name=\"number\" value=\"00003\" />\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1770129815404</updated>\n    </task>\n    <task id=\"LOCAL-00004\" summary=\"push update adhar_upload_widget.dart\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1770227503991</created>\n      <option name=\"number\" value=\"00004\" />\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1770227503991</updated>\n    </task>\n    <task id=\"LOCAL-00005\" summary=\"BOOKING FLOW LATEST UPADET and upadte gradel\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771149492710</created>\n      <option name=\"number\" value=\"00005\" />\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771149492710</updated>\n    </task>\n    <task id=\"LOCAL-00006\" summary=\"UI ENHANCEMENT\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771191092736</created>\n      <option name=\"number\" value=\"00006\" />\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771191092736</updated>\n    </task>\n    <task id=\"LOCAL-00007\" summary=\"UI ENHANCEMENT\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771225136042</created>\n      <option name=\"number\" value=\"00007\" />\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771225136042</updated>\n    </task>\n    <task id=\"LOCAL-00008\" summary=\"UI ENHANCEMENT with wallets\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771227446202</created>\n      <option name=\"number\" value=\"00008\" />\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771227446202</updated>\n    </task>\n    <task id=\"LOCAL-00009\" summary=\"UI ENHANCEMENT with wallets\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771229583639</created>\n      <option name=\"number\" value=\"00009\" />\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771229583639</updated>\n    </task>\n    <task id=\"LOCAL-00010\" summary=\"UPADTE PACKAGE\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771529926481</created>\n      <option name=\"number\" value=\"00010\" />\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771529926481</updated>\n    </task>\n    <task id=\"LOCAL-00011\" summary=\"final audit fix done\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771553651534</created>\n      <option name=\"number\" value=\"00011\" />\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771553651535</updated>\n    </task>\n    <task id=\"LOCAL-00012\" summary=\"responsive audit fix done\">\n      <option name=\"closed\" value=\"true\" />\n      <created>1771580906987</created>\n      <option name=\"number\" value=\"00012\" />\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1771580906987</updated>\n    </task>\n    <option name=\"localTasksCounter\" value=\"13\" />\n    <servers />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State />\n          </value>\n        </entry>\n      </map>\n    </option>\n  </component>\n  <component name=\"VcsManagerConfiguration\">\n    <MESSAGE value=\"new project of ugo\" />\n    <MESSAGE value=\"Package update\" />\n    <MESSAGE value=\"push update 032026\" />\n    <MESSAGE value=\"push update adhar_upload_widget.dart\" />\n    <MESSAGE value=\"BOOKING FLOW LATEST UPADET and upadte gradel\" />\n    <MESSAGE value=\"UI ENHANCEMENT\" />\n    <MESSAGE value=\"UI ENHANCEMENT with wallets\" />\n    <MESSAGE value=\"UPADTE PACKAGE\" />\n    <MESSAGE value=\"final audit fix done\" />\n    <MESSAGE value=\"responsive audit fix done\" />\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"responsive audit fix done\" />\n    <option name=\"MAKE_NEW_CHANGELIST_ACTIVE\" value=\"true\" />\n  </component>\n  <component name=\"XDebuggerManager\">\n    <breakpoint-manager>\n      <breakpoints>\n        <line-breakpoint enabled=\"true\" type=\"Dart\">\n          <url>file://$PROJECT_DIR$/lib/driving_dl/driving_dl_widget.dart</url>\n          <line>406</line>\n          <option name=\"timeStamp\" value=\"29\" />\n        </line-breakpoint>\n        <line-breakpoint enabled=\"true\" type=\"Dart\">\n          <url>file://$PROJECT_DIR$/lib/backend/api_requests/api_calls.dart</url>\n          <line>670</line>\n          <option name=\"timeStamp\" value=\"36\" />\n        </line-breakpoint>\n      </breakpoints>\n    </breakpoint-manager>\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/.idea/workspace.xml	(date 1771596811773)
@@ -4,15 +4,17 @@
     <option name="autoReloadType" value="NONE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="379021e6-8404-4cbe-8db7-751ea3ec972c" name="Changes" comment="responsive audit fix done">
+    <list default="true" id="379021e6-8404-4cbe-8db7-751ea3ec972c" name="Changes" comment="disable QR WHEN USER IS OFLINE&#10; audit fix done">
+      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/account_support/documents.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/account_support/documents.dart" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/lib/app_state.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/app_state.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/driving_dl/driving_dl_update.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/driving_dl/driving_dl_update.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/driving_dl/driving_dl_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/driving_dl/driving_dl_widget.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/firstdetails/firstdetails_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/firstdetails/firstdetails_widget.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/flutter_flow/nav/nav.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/flutter_flow/nav/nav.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/index.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/index.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/backend/api_requests/api_calls.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/backend/api_requests/api_calls.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/choose_vehicle/choose_vehicle_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/choose_vehicle/choose_vehicle_widget.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/components/vehicle_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/components/vehicle_widget.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/login/login_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/login/login_widget.dart" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/lib/on_boarding/on_boarding_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/on_boarding/on_boarding_widget.dart" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/lib/utils/input_validators.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/utils/input_validators.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/vehicle_image/vehicle_image_update.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/vehicle_image/vehicle_image_update.dart" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/lib/vehicle_image/vehicle_image_widget.dart" beforeDir="false" afterPath="$PROJECT_DIR$/lib/vehicle_image/vehicle_image_widget.dart" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -190,7 +192,23 @@
       <option name="project" value="LOCAL" />
       <updated>1771580906987</updated>
     </task>
-    <option name="localTasksCounter" value="13" />
+    <task id="LOCAL-00013" summary="registation working  audit fix done">
+      <option name="closed" value="true" />
+      <created>1771584019045</created>
+      <option name="number" value="00013" />
+      <option name="presentableId" value="LOCAL-00013" />
+      <option name="project" value="LOCAL" />
+      <updated>1771584019045</updated>
+    </task>
+    <task id="LOCAL-00014" summary="disable QR WHEN USER IS OFLINE&#10; audit fix done">
+      <option name="closed" value="true" />
+      <created>1771584706555</created>
+      <option name="number" value="00014" />
+      <option name="presentableId" value="LOCAL-00014" />
+      <option name="project" value="LOCAL" />
+      <updated>1771584706555</updated>
+    </task>
+    <option name="localTasksCounter" value="15" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -215,7 +233,9 @@
     <MESSAGE value="UPADTE PACKAGE" />
     <MESSAGE value="final audit fix done" />
     <MESSAGE value="responsive audit fix done" />
-    <option name="LAST_COMMIT_MESSAGE" value="responsive audit fix done" />
+    <MESSAGE value="registation working  audit fix done" />
+    <MESSAGE value="disable QR WHEN USER IS OFLINE&#10; audit fix done" />
+    <option name="LAST_COMMIT_MESSAGE" value="disable QR WHEN USER IS OFLINE&#10; audit fix done" />
     <option name="MAKE_NEW_CHANGELIST_ACTIVE" value="true" />
   </component>
   <component name="XDebuggerManager">
@@ -228,7 +248,7 @@
         </line-breakpoint>
         <line-breakpoint enabled="true" type="Dart">
           <url>file://$PROJECT_DIR$/lib/backend/api_requests/api_calls.dart</url>
-          <line>670</line>
+          <line>762</line>
           <option name="timeStamp" value="36" />
         </line-breakpoint>
       </breakpoints>
Index: lib/components/vehicle_widget.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import '/flutter_flow/flutter_flow_theme.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/flutter_flow/flutter_flow_widgets.dart';\nimport '/index.dart';\nimport 'package:flutter/material.dart';\nimport 'package:google_fonts/google_fonts.dart';\nimport 'vehicle_model.dart';\nexport 'vehicle_model.dart';\n\n/// New Component Gen\nclass VehicleWidget extends StatefulWidget {\n  const VehicleWidget({super.key});\n\n  @override\n  State<VehicleWidget> createState() => _VehicleWidgetState();\n}\n\nclass _VehicleWidgetState extends State<VehicleWidget> {\n  late VehicleModel _model;\n\n  @override\n  void setState(VoidCallback callback) {\n    super.setState(callback);\n    _model.onUpdate();\n  }\n\n  @override\n  void initState() {\n    super.initState();\n    _model = createModel(context, () => VehicleModel());\n  }\n\n  @override\n  void dispose() {\n    _model.maybeDispose();\n\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Container(\n      decoration: const BoxDecoration(\n        color: Colors.white,\n      ),\n      child: Align(\n        alignment: const AlignmentDirectional(1.0, 0.0),\n        child: Padding(\n          padding: const EdgeInsetsDirectional.fromSTEB(16.0, 16.0, 16.0, 16.0),\n          child: Column(\n            mainAxisSize: MainAxisSize.max,\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              Text(\n                FFLocalizations.of(context).getText(\n                  '1irb145s' /* Choose How You Want to Earn wi... */,\n                ),\n                style: FlutterFlowTheme.of(context).headlineMedium.override(\n                      font: GoogleFonts.interTight(\n                        fontWeight: FontWeight.w600,\n                        fontStyle: FlutterFlowTheme.of(context)\n                            .headlineMedium\n                            .fontStyle,\n                      ),\n                      color: FlutterFlowTheme.of(context).primaryText,\n                      fontSize: 24.0,\n                      letterSpacing: 0.0,\n                      fontWeight: FontWeight.w600,\n                      fontStyle:\n                          FlutterFlowTheme.of(context).headlineMedium.fontStyle,\n                    ),\n              ),\n              Column(\n                mainAxisSize: MainAxisSize.max,\n                children: [\n                  ListView(\n                    padding: EdgeInsets.zero,\n                    shrinkWrap: true,\n                    scrollDirection: Axis.vertical,\n                    children: [\n                      Padding(\n                        padding: const EdgeInsets.all(1.0),\n                        child: Container(\n                          width: double.infinity,\n                          height: 80.0,\n                          decoration: BoxDecoration(\n                            color: FlutterFlowTheme.of(context)\n                                .secondaryBackground,\n                            borderRadius: BorderRadius.circular(8.0),\n                            border: Border.all(\n                              color: FlutterFlowTheme.of(context).alternate,\n                            ),\n                          ),\n                          child: Padding(\n                            padding: const EdgeInsetsDirectional.fromSTEB(\n                                16.0, 16.0, 16.0, 16.0),\n                            child: Row(\n                              mainAxisSize: MainAxisSize.max,\n                              children: [\n                                ClipRRect(\n                                  borderRadius: BorderRadius.circular(8.0),\n                                  child: Image.network(\n                                    'https://images.unsplash.com/photo-1531327431456-837da4b1d562?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjIxNjQ0NjV8&ixlib=rb-4.1.0&q=80&w=1080',\n                                    width: 48.0,\n                                    height: 48.0,\n                                    fit: BoxFit.cover,\n                                  ),\n                                ),\n                                Expanded(\n                                  child: Column(\n                                    mainAxisSize: MainAxisSize.max,\n                                    crossAxisAlignment:\n                                        CrossAxisAlignment.start,\n                                    children: [\n                                      Text(\n                                        FFLocalizations.of(context).getText(\n                                          '566mujas' /*  */,\n                                        ),\n                                        style: FlutterFlowTheme.of(context)\n                                            .bodyLarge\n                                            .override(\n                                              font: GoogleFonts.inter(\n                                                fontWeight: FontWeight.w600,\n                                                fontStyle:\n                                                    FlutterFlowTheme.of(context)\n                                                        .bodyLarge\n                                                        .fontStyle,\n                                              ),\n                                              letterSpacing: 0.0,\n                                              fontWeight: FontWeight.w600,\n                                              fontStyle:\n                                                  FlutterFlowTheme.of(context)\n                                                      .bodyLarge\n                                                      .fontStyle,\n                                            ),\n                                      ),\n                                      Text(\n                                        FFLocalizations.of(context).getText(\n                                          '709wrpn4' /*  */,\n                                        ),\n                                        style: FlutterFlowTheme.of(context)\n                                            .bodySmall\n                                            .override(\n                                              font: GoogleFonts.inter(\n                                                fontWeight:\n                                                    FlutterFlowTheme.of(context)\n                                                        .bodySmall\n                                                        .fontWeight,\n                                                fontStyle:\n                                                    FlutterFlowTheme.of(context)\n                                                        .bodySmall\n                                                        .fontStyle,\n                                              ),\n                                              color:\n                                                  FlutterFlowTheme.of(context)\n                                                      .secondaryText,\n                                              letterSpacing: 0.0,\n                                              fontWeight:\n                                                  FlutterFlowTheme.of(context)\n                                                      .bodySmall\n                                                      .fontWeight,\n                                              fontStyle:\n                                                  FlutterFlowTheme.of(context)\n                                                      .bodySmall\n                                                      .fontStyle,\n                                            ),\n                                      ),\n                                    ].divide(const SizedBox(height: 4.0)),\n                                  ),\n                                ),\n                                Container(\n                                  height: 32.0,\n                                  decoration: BoxDecoration(\n                                    color: FlutterFlowTheme.of(context)\n                                        .primaryBackground,\n                                    border: Border.all(\n                                      color: FlutterFlowTheme.of(context)\n                                          .alternate,\n                                      width: 1.0,\n                                    ),\n                                  ),\n                                  child: Padding(\n                                    padding: const EdgeInsetsDirectional.fromSTEB(\n                                        8.0, 4.0, 8.0, 4.0),\n                                    child: Text(\n                                      FFLocalizations.of(context).getText(\n                                        'wczmqr2s' /*  */,\n                                      ),\n                                      style: FlutterFlowTheme.of(context)\n                                          .bodySmall\n                                          .override(\n                                            font: GoogleFonts.inter(\n                                              fontWeight:\n                                                  FlutterFlowTheme.of(context)\n                                                      .bodySmall\n                                                      .fontWeight,\n                                              fontStyle:\n                                                  FlutterFlowTheme.of(context)\n                                                      .bodySmall\n                                                      .fontStyle,\n                                            ),\n                                            color: FlutterFlowTheme.of(context)\n                                                .secondaryText,\n                                            letterSpacing: 0.0,\n                                            fontWeight:\n                                                FlutterFlowTheme.of(context)\n                                                    .bodySmall\n                                                    .fontWeight,\n                                            fontStyle:\n                                                FlutterFlowTheme.of(context)\n                                                    .bodySmall\n                                                    .fontStyle,\n                                          ),\n                                    ),\n                                  ),\n                                ),\n                              ].divide(const SizedBox(width: 12.0)),\n                            ),\n                          ),\n                        ),\n                      ),\n                    ],\n                  ),\n                ].divide(const SizedBox(height: 16.0)),\n              ),\n              FFButtonWidget(\n                onPressed: () async {\n                  context.pushNamed(\n                    OnBoardingWidget.routeName,\n                    queryParameters: {\n                      'mobile': serializeParam(\n                        0,\n                        ParamType.int,\n                      ),\n                      'firstname': serializeParam(\n                        '',\n                        ParamType.String,\n                      ),\n                      'lastname': serializeParam(\n                        '',\n                        ParamType.String,\n                      ),\n                      'email': serializeParam(\n                        '',\n                        ParamType.String,\n                      ),\n                      'referalcode': serializeParam(\n                        0,\n                        ParamType.int,\n                      ),\n                      'vehicletype': serializeParam(\n                        '',\n                        ParamType.String,\n                      ),\n                    }.withoutNulls,\n                  );\n                },\n                text: FFLocalizations.of(context).getText(\n                  'q21dqnjj' /* Continue */,\n                ),\n                options: FFButtonOptions(\n                  width: double.infinity,\n                  height: 55.0,\n                  padding: const EdgeInsets.all(8.0),\n                  iconPadding:\n                      const EdgeInsetsDirectional.fromSTEB(0.0, 0.0, 0.0, 0.0),\n                  color: AppColors.accentCoral,\n                  textStyle: FlutterFlowTheme.of(context).titleMedium.override(\n                        font: GoogleFonts.interTight(\n                          fontWeight: FontWeight.w600,\n                          fontStyle: FlutterFlowTheme.of(context)\n                              .titleMedium\n                              .fontStyle,\n                        ),\n                        color: Colors.white,\n                        letterSpacing: 0.0,\n                        fontWeight: FontWeight.w600,\n                        fontStyle:\n                            FlutterFlowTheme.of(context).titleMedium.fontStyle,\n                      ),\n                  elevation: 0.0,\n                ),\n              ),\n            ].divide(const SizedBox(height: 24.0)),\n          ),\n        ),\n      ),\n    );\n  }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/components/vehicle_widget.dart b/lib/components/vehicle_widget.dart
--- a/lib/components/vehicle_widget.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/components/vehicle_widget.dart	(date 1771589549733)
@@ -1,15 +1,21 @@
-import '/flutter_flow/flutter_flow_theme.dart';
+import '/config.dart' as app_config;
+import '/constants/app_colors.dart';
+import 'package:provider/provider.dart';
 import '/flutter_flow/flutter_flow_util.dart';
-import '/flutter_flow/flutter_flow_widgets.dart';
 import '/index.dart';
 import 'package:flutter/material.dart';
 import 'package:google_fonts/google_fonts.dart';
 import 'vehicle_model.dart';
 export 'vehicle_model.dart';
 
-/// New Component Gen
+/// Displays driver's vehicle info from FFAppState (aligned with vehicles table).
 class VehicleWidget extends StatefulWidget {
-  const VehicleWidget({super.key});
+  const VehicleWidget({
+    super.key,
+    this.onEditTap,
+  });
+
+  final VoidCallback? onEditTap;
 
   @override
   State<VehicleWidget> createState() => _VehicleWidgetState();
@@ -33,258 +39,192 @@
   @override
   void dispose() {
     _model.maybeDispose();
-
     super.dispose();
   }
 
+  String _vehicleDisplayName() {
+    final name = FFAppState().vehicleName;
+    if (name.isNotEmpty) return name;
+    final make = FFAppState().vehicleMake;
+    final model = FFAppState().vehicleModel;
+    if (make.isNotEmpty || model.isNotEmpty) {
+      return '${make.trim()} ${model.trim()}'.trim();
+    }
+    return FFAppState().vehicleType.isNotEmpty
+        ? FFAppState().vehicleType
+        : 'My Vehicle';
+  }
+
+  String _vehicleSubtitle() {
+    final parts = <String>[];
+    if (FFAppState().vehicleColor.isNotEmpty) parts.add(FFAppState().vehicleColor);
+    if (FFAppState().vehicleYear.isNotEmpty) parts.add(FFAppState().vehicleYear);
+    if (FFAppState().licensePlate.isNotEmpty) parts.add(FFAppState().licensePlate);
+    return parts.join(' â€¢ ');
+  }
+
+  String? _vehicleImageUrl() {
+    final url = FFAppState().vehicleImageUrl;
+    if (url.isNotEmpty) return app_config.Config.fullImageUrl(url);
+    return null;
+  }
+
   @override
   Widget build(BuildContext context) {
+    context.watch<FFAppState>();
+
+    final hasVehicleData = FFAppState().vehicleType.isNotEmpty ||
+        FFAppState().vehicleName.isNotEmpty ||
+        FFAppState().vehicleMake.isNotEmpty ||
+        FFAppState().vehicleImage?.bytes != null ||
+        FFAppState().vehicleImageUrl.isNotEmpty;
+
     return Container(
-      decoration: const BoxDecoration(
+      decoration: BoxDecoration(
         color: Colors.white,
+        borderRadius: BorderRadius.circular(16),
+        boxShadow: [
+          BoxShadow(
+            color: Colors.black.withValues(alpha: 0.06),
+            blurRadius: 12,
+            offset: const Offset(0, 4),
+          ),
+        ],
       ),
-      child: Align(
-        alignment: const AlignmentDirectional(1.0, 0.0),
-        child: Padding(
-          padding: const EdgeInsetsDirectional.fromSTEB(16.0, 16.0, 16.0, 16.0),
-          child: Column(
-            mainAxisSize: MainAxisSize.max,
-            crossAxisAlignment: CrossAxisAlignment.start,
-            children: [
-              Text(
-                FFLocalizations.of(context).getText(
-                  '1irb145s' /* Choose How You Want to Earn wi... */,
-                ),
-                style: FlutterFlowTheme.of(context).headlineMedium.override(
-                      font: GoogleFonts.interTight(
-                        fontWeight: FontWeight.w600,
-                        fontStyle: FlutterFlowTheme.of(context)
-                            .headlineMedium
-                            .fontStyle,
-                      ),
-                      color: FlutterFlowTheme.of(context).primaryText,
-                      fontSize: 24.0,
-                      letterSpacing: 0.0,
-                      fontWeight: FontWeight.w600,
-                      fontStyle:
-                          FlutterFlowTheme.of(context).headlineMedium.fontStyle,
-                    ),
-              ),
-              Column(
-                mainAxisSize: MainAxisSize.max,
-                children: [
-                  ListView(
-                    padding: EdgeInsets.zero,
-                    shrinkWrap: true,
-                    scrollDirection: Axis.vertical,
-                    children: [
-                      Padding(
-                        padding: const EdgeInsets.all(1.0),
-                        child: Container(
-                          width: double.infinity,
-                          height: 80.0,
-                          decoration: BoxDecoration(
-                            color: FlutterFlowTheme.of(context)
-                                .secondaryBackground,
-                            borderRadius: BorderRadius.circular(8.0),
-                            border: Border.all(
-                              color: FlutterFlowTheme.of(context).alternate,
-                            ),
-                          ),
-                          child: Padding(
-                            padding: const EdgeInsetsDirectional.fromSTEB(
-                                16.0, 16.0, 16.0, 16.0),
-                            child: Row(
-                              mainAxisSize: MainAxisSize.max,
-                              children: [
-                                ClipRRect(
-                                  borderRadius: BorderRadius.circular(8.0),
-                                  child: Image.network(
-                                    'https://images.unsplash.com/photo-1531327431456-837da4b1d562?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjIxNjQ0NjV8&ixlib=rb-4.1.0&q=80&w=1080',
-                                    width: 48.0,
-                                    height: 48.0,
-                                    fit: BoxFit.cover,
-                                  ),
-                                ),
-                                Expanded(
-                                  child: Column(
-                                    mainAxisSize: MainAxisSize.max,
-                                    crossAxisAlignment:
-                                        CrossAxisAlignment.start,
-                                    children: [
-                                      Text(
-                                        FFLocalizations.of(context).getText(
-                                          '566mujas' /*  */,
-                                        ),
-                                        style: FlutterFlowTheme.of(context)
-                                            .bodyLarge
-                                            .override(
-                                              font: GoogleFonts.inter(
-                                                fontWeight: FontWeight.w600,
-                                                fontStyle:
-                                                    FlutterFlowTheme.of(context)
-                                                        .bodyLarge
-                                                        .fontStyle,
-                                              ),
-                                              letterSpacing: 0.0,
-                                              fontWeight: FontWeight.w600,
-                                              fontStyle:
-                                                  FlutterFlowTheme.of(context)
-                                                      .bodyLarge
-                                                      .fontStyle,
-                                            ),
-                                      ),
-                                      Text(
-                                        FFLocalizations.of(context).getText(
-                                          '709wrpn4' /*  */,
-                                        ),
-                                        style: FlutterFlowTheme.of(context)
-                                            .bodySmall
-                                            .override(
-                                              font: GoogleFonts.inter(
-                                                fontWeight:
-                                                    FlutterFlowTheme.of(context)
-                                                        .bodySmall
-                                                        .fontWeight,
-                                                fontStyle:
-                                                    FlutterFlowTheme.of(context)
-                                                        .bodySmall
-                                                        .fontStyle,
-                                              ),
-                                              color:
-                                                  FlutterFlowTheme.of(context)
-                                                      .secondaryText,
-                                              letterSpacing: 0.0,
-                                              fontWeight:
-                                                  FlutterFlowTheme.of(context)
-                                                      .bodySmall
-                                                      .fontWeight,
-                                              fontStyle:
-                                                  FlutterFlowTheme.of(context)
-                                                      .bodySmall
-                                                      .fontStyle,
-                                            ),
-                                      ),
-                                    ].divide(const SizedBox(height: 4.0)),
-                                  ),
-                                ),
-                                Container(
-                                  height: 32.0,
-                                  decoration: BoxDecoration(
-                                    color: FlutterFlowTheme.of(context)
-                                        .primaryBackground,
-                                    border: Border.all(
-                                      color: FlutterFlowTheme.of(context)
-                                          .alternate,
-                                      width: 1.0,
-                                    ),
-                                  ),
-                                  child: Padding(
-                                    padding: const EdgeInsetsDirectional.fromSTEB(
-                                        8.0, 4.0, 8.0, 4.0),
-                                    child: Text(
-                                      FFLocalizations.of(context).getText(
-                                        'wczmqr2s' /*  */,
-                                      ),
-                                      style: FlutterFlowTheme.of(context)
-                                          .bodySmall
-                                          .override(
-                                            font: GoogleFonts.inter(
-                                              fontWeight:
-                                                  FlutterFlowTheme.of(context)
-                                                      .bodySmall
-                                                      .fontWeight,
-                                              fontStyle:
-                                                  FlutterFlowTheme.of(context)
-                                                      .bodySmall
-                                                      .fontStyle,
-                                            ),
-                                            color: FlutterFlowTheme.of(context)
-                                                .secondaryText,
-                                            letterSpacing: 0.0,
-                                            fontWeight:
-                                                FlutterFlowTheme.of(context)
-                                                    .bodySmall
-                                                    .fontWeight,
-                                            fontStyle:
-                                                FlutterFlowTheme.of(context)
-                                                    .bodySmall
-                                                    .fontStyle,
-                                          ),
-                                    ),
-                                  ),
-                                ),
-                              ].divide(const SizedBox(width: 12.0)),
-                            ),
-                          ),
-                        ),
-                      ),
-                    ],
-                  ),
-                ].divide(const SizedBox(height: 16.0)),
+      child: Padding(
+        padding: const EdgeInsets.all(16.0),
+        child: Column(
+          mainAxisSize: MainAxisSize.min,
+          crossAxisAlignment: CrossAxisAlignment.start,
+          children: [
+            Row(
+              children: [
+                Icon(Icons.directions_car, color: AppColors.primary, size: 22),
+                const SizedBox(width: 8),
+                Text(
+                  'Vehicle Details',
+                  style: GoogleFonts.inter(
+                    fontSize: 18,
+                    fontWeight: FontWeight.w700,
+                    color: AppColors.textDark,
+                  ),
+                ),
+              ],
+            ),
+            const SizedBox(height: 16),
+            if (hasVehicleData) ...[
+              Container(
+                width: double.infinity,
+                padding: const EdgeInsets.all(16),
+                decoration: BoxDecoration(
+                  color: AppColors.backgroundCard,
+                  borderRadius: BorderRadius.circular(12),
+                  border: Border.all(color: AppColors.divider),
+                ),
+                child: Row(
+                  children: [
+                    ClipRRect(
+                      borderRadius: BorderRadius.circular(10),
+                      child: _vehicleImageUrl() != null
+                          ? Image.network(
+                              _vehicleImageUrl()!,
+                              width: 64,
+                              height: 64,
+                              fit: BoxFit.cover,
+                              errorBuilder: (_, __, ___) => _buildPlaceholderIcon(),
+                            )
+                          : FFAppState().vehicleImage?.bytes != null
+                              ? Image.memory(
+                                  FFAppState().vehicleImage!.bytes!,
+                                  width: 64,
+                                  height: 64,
+                                  fit: BoxFit.cover,
+                                )
+                              : _buildPlaceholderIcon(),
+                    ),
+                    const SizedBox(width: 16),
+                    Expanded(
+                      child: Column(
+                        crossAxisAlignment: CrossAxisAlignment.start,
+                        children: [
+                          Text(
+                            _vehicleDisplayName(),
+                            style: GoogleFonts.inter(
+                              fontSize: 16,
+                              fontWeight: FontWeight.w600,
+                              color: AppColors.textDark,
+                            ),
+                          ),
+                          if (_vehicleSubtitle().isNotEmpty) ...[
+                            const SizedBox(height: 4),
+                            Text(
+                              _vehicleSubtitle(),
+                              style: GoogleFonts.inter(
+                                fontSize: 13,
+                                color: Colors.grey,
+                              ),
+                            ),
+                          ],
+                          if (FFAppState().registrationNumber.isNotEmpty) ...[
+                            const SizedBox(height: 2),
+                            Text(
+                              'RC: ${FFAppState().registrationNumber}',
+                              style: GoogleFonts.inter(
+                                fontSize: 12,
+                                color: Colors.grey,
+                              ),
+                            ),
+                          ],
+                        ],
+                      ),
+                    ),
+                    if (widget.onEditTap != null)
+                      IconButton(
+                        onPressed: widget.onEditTap,
+                        icon: const Icon(Icons.edit_outlined, color: AppColors.primary),
+                      ),
+                  ],
+                ),
               ),
-              FFButtonWidget(
-                onPressed: () async {
-                  context.pushNamed(
-                    OnBoardingWidget.routeName,
-                    queryParameters: {
-                      'mobile': serializeParam(
-                        0,
-                        ParamType.int,
-                      ),
-                      'firstname': serializeParam(
-                        '',
-                        ParamType.String,
-                      ),
-                      'lastname': serializeParam(
-                        '',
-                        ParamType.String,
-                      ),
-                      'email': serializeParam(
-                        '',
-                        ParamType.String,
-                      ),
-                      'referalcode': serializeParam(
-                        0,
-                        ParamType.int,
-                      ),
-                      'vehicletype': serializeParam(
-                        '',
-                        ParamType.String,
-                      ),
-                    }.withoutNulls,
-                  );
-                },
-                text: FFLocalizations.of(context).getText(
-                  'q21dqnjj' /* Continue */,
-                ),
-                options: FFButtonOptions(
+            ] else
+              GestureDetector(
+                onTap: widget.onEditTap ?? () => context.pushNamed(VehicleImageUpdateWidget.routeName),
+                child: Container(
                   width: double.infinity,
-                  height: 55.0,
-                  padding: const EdgeInsets.all(8.0),
-                  iconPadding:
-                      const EdgeInsetsDirectional.fromSTEB(0.0, 0.0, 0.0, 0.0),
-                  color: AppColors.accentCoral,
-                  textStyle: FlutterFlowTheme.of(context).titleMedium.override(
-                        font: GoogleFonts.interTight(
-                          fontWeight: FontWeight.w600,
-                          fontStyle: FlutterFlowTheme.of(context)
-                              .titleMedium
-                              .fontStyle,
+                  padding: const EdgeInsets.symmetric(vertical: 24),
+                  decoration: BoxDecoration(
+                    color: AppColors.backgroundCard,
+                    borderRadius: BorderRadius.circular(12),
+                    border: Border.all(color: AppColors.divider),
+                  ),
+                  child: Column(
+                    children: [
+                      Icon(Icons.add_circle_outline, size: 40, color: Colors.grey[400]),
+                      const SizedBox(height: 8),
+                      Text(
+                        'Add Vehicle Details',
+                        style: GoogleFonts.inter(
+                          fontSize: 15,
+                          fontWeight: FontWeight.w500,
+                          color: Colors.grey,
                         ),
-                        color: Colors.white,
-                        letterSpacing: 0.0,
-                        fontWeight: FontWeight.w600,
-                        fontStyle:
-                            FlutterFlowTheme.of(context).titleMedium.fontStyle,
                       ),
-                  elevation: 0.0,
-                ),
-              ),
-            ].divide(const SizedBox(height: 24.0)),
-          ),
+                    ],
+                  ),
+                ),
+              ),
+          ],
         ),
       ),
+    );
+  }
+
+  Widget _buildPlaceholderIcon() {
+    return Container(
+      width: 64,
+      height: 64,
+      color: AppColors.backgroundAlt,
+      child: Icon(Icons.directions_car, size: 32, color: Colors.grey[400]),
     );
   }
 }
Index: lib/app_state.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import 'package:flutter/material.dart';\nimport 'package:shared_preferences/shared_preferences.dart';\nimport '/flutter_flow/uploaded_file.dart';\nimport '/services/secure_storage_service.dart';\n\nclass FFAppState extends ChangeNotifier {\n  static final FFAppState _instance = FFAppState._internal();\n\n  factory FFAppState() {\n    return _instance;\n  }\n\n  FFAppState._internal();\n\n  bool hasProfilePhoto = false;\n  bool hasLicense = false;\n  bool hasAadhar = false;\n  bool hasPan = false;\n  bool hasVehicleImage = false;\n  bool hasRC = false;\n  int _activeRideId = 0;\n  String _activeRideStatus = '';\n\n  /// Set when user taps ride request notification (Rapido-style). HomeWidget fetches and shows.\n  int _pendingRideIdFromNotification = 0;\n  int get pendingRideIdFromNotification => _pendingRideIdFromNotification;\n  set pendingRideIdFromNotification(int value) {\n    _pendingRideIdFromNotification = value;\n  }\n  int _mobileNo = 0;\n  String _firstName = '';\n  String _lastName = '';\n  String _email = '';\n  String _referralCode = '';\n\n  Future initializePersistedState() async {\n    prefs = await SharedPreferences.getInstance();\n    SecureStorageService.instance.init();\n    _safeInit(() {\n      _accessToken = prefs.getString('ff_accessToken') ?? _accessToken;\n    });\n    _safeInit(() {\n      _kycStatus = prefs.getString('ff_kycStatus') ?? _kycStatus;\n    });\n    _safeInit(() {\n      _qrImage = prefs.getString('ff_qrImage') ?? _qrImage;\n    });\n    _safeInit(() {\n      isLoggedIn = prefs.getBool('ff_isLoggedIn') ?? false;\n    });\n    _safeInit(() {\n      _isRegistered = prefs.getBool('ff_isRegistered') ?? false;\n    });\n    _safeInit(() {\n      _driverid = prefs.getInt('ff_driverid') ?? _driverid;\n    });\n    _safeInit(() {\n      _isonline = prefs.getBool('ff_isonline') ?? false;\n    });\n    _safeInit(() {\n      _activeRideId = prefs.getInt('ff_activeRideId') ?? 0;\n    });\n    _safeInit(() {\n      _activeRideStatus = prefs.getString('ff_activeRideStatus') ?? '';\n    });\n    _safeInit(() {\n      _mobileNo = prefs.getInt('ff_mobileNo') ?? 0;\n    });\n    _safeInit(() {\n      _firstName = prefs.getString('ff_firstName') ?? '';\n    });\n    _safeInit(() {\n      _lastName = prefs.getString('ff_lastName') ?? '';\n    });\n    _safeInit(() {\n      _email = prefs.getString('ff_email') ?? '';\n    });\n    _safeInit(() {\n      _referralCode = prefs.getString('ff_referralCode') ?? '';\n    });\n    _safeInit(() {\n      _dateOfBirth = prefs.getString('ff_dateOfBirth') ?? '';\n    });\n    _safeInit(() {\n      _address = prefs.getString('ff_address') ?? '';\n    });\n    _safeInit(() {\n      _city = prefs.getString('ff_city') ?? '';\n    });\n    _safeInit(() {\n      _state = prefs.getString('ff_state') ?? '';\n    });\n    _safeInit(() {\n      _postalCode = prefs.getString('ff_postalCode') ?? '';\n    });\n    _safeInit(() {\n      _emergencyContactName = prefs.getString('ff_emergencyContactName') ?? '';\n    });\n    _safeInit(() {\n      _emergencyContactPhone = prefs.getString('ff_emergencyContactPhone') ?? '';\n    });\n    _safeInit(() {\n      _fcmToken = prefs.getString('ff_fcmToken') ?? '';\n    });\n    // Aadhaar/PAN: migrate from SharedPreferences then load from secure storage\n    await _loadAadharPanFromSecureStorage();\n\n    _safeInit(() {\n      _profilePhotoUrl = prefs.getString('ff_profilePhotoUrl') ?? '';\n    });\n    _safeInit(() {\n      _profilePhotoBase64 = prefs.getString('ff_profilePhotoBase64') ?? '';\n    });\n\n    _safeInit(() {\n      _licenseFrontImageUrl = prefs.getString('ff_licenseFrontImageUrl') ?? '';\n    });\n    _safeInit(() {\n      _licenseBackImageUrl = prefs.getString('ff_licenseBackImageUrl') ?? '';\n    });\n    _safeInit(() {\n      _licenseFrontBase64 = prefs.getString('ff_licenseFrontBase64') ?? '';\n    });\n    _safeInit(() {\n      _licenseBackBase64 = prefs.getString('ff_licenseBackBase64') ?? '';\n    });\n    _safeInit(() {\n      _licenseNumber = prefs.getString('ff_licenseNumber') ?? '';\n    });\n    _safeInit(() {\n      _licenseExpiryDate = prefs.getString('ff_licenseExpiryDate') ?? '';\n    });\n\n    _safeInit(() {\n      _rcFrontImageUrl = prefs.getString('ff_rcFrontImageUrl') ?? '';\n    });\n    _safeInit(() {\n      _rcBackImageUrl = prefs.getString('ff_rcBackImageUrl') ?? '';\n    });\n    _safeInit(() {\n      _rcFrontBase64 = prefs.getString('ff_rcFrontBase64') ?? '';\n    });\n    _safeInit(() {\n      _rcBackBase64 = prefs.getString('ff_rcBackBase64') ?? '';\n    });\n    _safeInit(() {\n      _registrationNumber = prefs.getString('ff_registrationNumber') ?? '';\n    });\n\n    _safeInit(() {\n      _vehicleYear = prefs.getString('ff_vehicleYear') ?? '';\n    });\n\n    _safeInit(() {\n      _vehicleImageUrl = prefs.getString('ff_vehicleImageUrl') ?? '';\n    });\n    _safeInit(() {\n      _vehicleBase64 = prefs.getString('ff_vehicleBase64') ?? '';\n    });\n    _safeInit(() {\n      _vehicleType = prefs.getString('ff_vehicleType') ?? '';\n    });\n    _safeInit(() {\n      _vehicleMake = prefs.getString('ff_vehicleMake') ?? '';\n    });\n    _safeInit(() {\n      _vehicleModel = prefs.getString('ff_vehicleModel') ?? '';\n    });\n    _safeInit(() {\n      _vehicleColor = prefs.getString('ff_vehicleColor') ?? '';\n    });\n  }\n\n  Future<void> _loadAadharPanFromSecureStorage() async {\n    final sec = SecureStorageService.instance;\n    try {\n      var v = await sec.read(SecureStorageService.keyAadharNumber);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_aadharNumber');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyAadharNumber, fromPrefs);\n          await prefs.remove('ff_aadharNumber');\n        }\n        v = fromPrefs ?? '';\n      }\n      _aadharNumber = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyAadharFrontImageUrl);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_aadharFrontImageUrl');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyAadharFrontImageUrl, fromPrefs);\n          await prefs.remove('ff_aadharFrontImageUrl');\n          v = fromPrefs;\n        } else {\n          v = '';\n        }\n      }\n      _aadharFrontImageUrl = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyAadharBackImageUrl);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_aadharBackImageUrl');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyAadharBackImageUrl, fromPrefs);\n          await prefs.remove('ff_aadharBackImageUrl');\n        }\n        v = fromPrefs ?? '';\n      }\n      _aadharBackImageUrl = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyAadharFrontBase64);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_aadharFrontBase64');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyAadharFrontBase64, fromPrefs);\n          await prefs.remove('ff_aadharFrontBase64');\n        }\n        v = fromPrefs ?? '';\n      }\n      _aadharFrontBase64 = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyAadharBackBase64);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_aadharBackBase64');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyAadharBackBase64, fromPrefs);\n          await prefs.remove('ff_aadharBackBase64');\n        }\n        v = fromPrefs ?? '';\n      }\n      _aadharBackBase64 = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyPanImageUrl);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_panImageUrl');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyPanImageUrl, fromPrefs);\n          await prefs.remove('ff_panImageUrl');\n        }\n        v = fromPrefs ?? '';\n      }\n      _panImageUrl = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyPanBase64);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_panBase64');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyPanBase64, fromPrefs);\n          await prefs.remove('ff_panBase64');\n        }\n        v = fromPrefs ?? '';\n      }\n      _panBase64 = v;\n    } catch (_) {}\n    try {\n      var v = await sec.read(SecureStorageService.keyPanNumber);\n      if (v == null || v.isEmpty) {\n        final fromPrefs = prefs.getString('ff_panNumber');\n        if (fromPrefs != null && fromPrefs.isNotEmpty) {\n          await sec.write(SecureStorageService.keyPanNumber, fromPrefs);\n          await prefs.remove('ff_panNumber');\n        }\n        v = fromPrefs ?? '';\n      }\n      _panNumber = v;\n    } catch (_) {}\n  }\n\n  void update(VoidCallback callback) {\n    callback();\n    notifyListeners();\n  }\n\n  int get activeRideId => _activeRideId;\n  String get activeRideStatus => _activeRideStatus;\n\n  set activeRideId(int value) {\n    _activeRideId = value;\n    prefs.setInt('ff_activeRideId', value);\n    notifyListeners();\n  }\n\n  set activeRideStatus(String value) {\n    _activeRideStatus = value;\n    prefs.setString('ff_activeRideStatus', value);\n    notifyListeners();\n  }\n\n  int _activeRideCount = 0;\n  int get activeRideCount => _activeRideCount;\n\n  set activeRideCount(int value) {\n    _activeRideCount = value;\n    notifyListeners();\n  }\n\n  int get mobileNo => _mobileNo;\n\n  set mobileNo(int value) {\n    _mobileNo = value;\n    prefs.setInt('ff_mobileNo', value);\n    notifyListeners();\n  }\n\n  String get firstName => _firstName;\n\n  set firstName(String value) {\n    _firstName = value;\n    prefs.setString('ff_firstName', value);\n    notifyListeners();\n  }\n\n  String _fcmToken = '';\n  String get fcmToken => _fcmToken;\n  set fcmToken(String value) {\n    _fcmToken = value;\n    prefs.setString('ff_fcmToken', value);\n  }\n\n  String get lastName => _lastName;\n\n  set lastName(String value) {\n    _lastName = value;\n    prefs.setString('ff_lastName', value);\n    notifyListeners();\n  }\n\n  String get email => _email;\n\n  set email(String value) {\n    _email = value;\n    prefs.setString('ff_email', value);\n    notifyListeners();\n  }\n\n  String get referralCode => _referralCode;\n\n  set referralCode(String value) {\n    _referralCode = value;\n    prefs.setString('ff_referralCode', value);\n    notifyListeners();\n  }\n\n  /// Date of birth (YYYY-MM-DD)\n  String _dateOfBirth = '';\n  String get dateOfBirth => _dateOfBirth;\n  set dateOfBirth(String value) {\n    _dateOfBirth = value;\n    if (value.isEmpty) prefs.remove('ff_dateOfBirth');\n    else prefs.setString('ff_dateOfBirth', value);\n    notifyListeners();\n  }\n\n  String _address = '';\n  String get address => _address;\n  set address(String value) {\n    _address = value;\n    if (value.isEmpty) prefs.remove('ff_address');\n    else prefs.setString('ff_address', value);\n    notifyListeners();\n  }\n\n  String _city = '';\n  String get city => _city;\n  set city(String value) {\n    _city = value;\n    if (value.isEmpty) prefs.remove('ff_city');\n    else prefs.setString('ff_city', value);\n    notifyListeners();\n  }\n\n  String _state = '';\n  String get state => _state;\n  set state(String value) {\n    _state = value;\n    if (value.isEmpty) prefs.remove('ff_state');\n    else prefs.setString('ff_state', value);\n    notifyListeners();\n  }\n\n  String _postalCode = '';\n  String get postalCode => _postalCode;\n  set postalCode(String value) {\n    _postalCode = value;\n    if (value.isEmpty) prefs.remove('ff_postalCode');\n    else prefs.setString('ff_postalCode', value);\n    notifyListeners();\n  }\n\n  String _emergencyContactName = '';\n  String get emergencyContactName => _emergencyContactName;\n  set emergencyContactName(String value) {\n    _emergencyContactName = value;\n    if (value.isEmpty) prefs.remove('ff_emergencyContactName');\n    else prefs.setString('ff_emergencyContactName', value);\n    notifyListeners();\n  }\n\n  String _emergencyContactPhone = '';\n  String get emergencyContactPhone => _emergencyContactPhone;\n  set emergencyContactPhone(String value) {\n    _emergencyContactPhone = value;\n    if (value.isEmpty) prefs.remove('ff_emergencyContactPhone');\n    else prefs.setString('ff_emergencyContactPhone', value);\n    notifyListeners();\n  }\n\n  late SharedPreferences prefs;\n\n  bool _isLoggedIn = false;\n\n  bool get isLoggedIn => _isLoggedIn;\n\n  set isLoggedIn(bool value) {\n    _isLoggedIn = value;\n    prefs.setBool('ff_isLoggedIn', value);\n    notifyListeners();\n  }\n\n  bool _isRegistered = false;\n  bool get isRegistered => _isRegistered;\n  set isRegistered(bool value) {\n    _isRegistered = value;\n    prefs.setBool('ff_isRegistered', value);\n    notifyListeners();\n  }\n\n  String _selectvehicle = '';\n  String get selectvehicle => _selectvehicle;\n  set selectvehicle(String value) {\n    _selectvehicle = value;\n    notifyListeners();\n  }\n\n  /// Admin vehicle ID from API (used for signup-with-vehicle)\n  int _adminVehicleId = 0;\n  int get adminVehicleId => _adminVehicleId;\n  set adminVehicleId(int value) {\n    _adminVehicleId = value;\n    notifyListeners();\n  }\n\n  // ==========================================\n  // DRIVING LICENSE IMAGE\n  // ==========================================\n  FFUploadedFile? _imageLicense;\n  FFUploadedFile? get imageLicense => _imageLicense;\n  set imageLicense(FFUploadedFile? value) {\n    _imageLicense = value;\n    notifyListeners();\n  }\n\n  // ==========================================\n  // DRIVING LICENSE FRONT AND BACK IMAGES\n  // ==========================================\n  FFUploadedFile? _licenseFrontImage;\n  FFUploadedFile? get licenseFrontImage => _licenseFrontImage;\n  set licenseFrontImage(FFUploadedFile? value) {\n    _licenseFrontImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _licenseBackImage;\n  FFUploadedFile? get licenseBackImage => _licenseBackImage;\n  set licenseBackImage(FFUploadedFile? value) {\n    _licenseBackImage = value;\n    notifyListeners();\n  }\n\n  // ==========================================\n  // AADHAAR IMAGES (temporary in-memory)\n  // ==========================================\n  FFUploadedFile? _aadharImage;\n  FFUploadedFile? get aadharImage => _aadharImage;\n  set aadharImage(FFUploadedFile? value) {\n    _aadharImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _aadharBackImage;\n  FFUploadedFile? get aadharBackImage => _aadharBackImage;\n  set aadharBackImage(FFUploadedFile? value) {\n    _aadharBackImage = value;\n    notifyListeners();\n  }\n\n  // ==========================================\n  // AADHAAR FRONT AND BACK IMAGES\n  // ==========================================\n  FFUploadedFile? _aadhaarFrontImage;\n  FFUploadedFile? get aadhaarFrontImage => _aadhaarFrontImage;\n  set aadhaarFrontImage(FFUploadedFile? value) {\n    _aadhaarFrontImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _aadhaarBackImage;\n  FFUploadedFile? get aadhaarBackImage => _aadhaarBackImage;\n  set aadhaarBackImage(FFUploadedFile? value) {\n    _aadhaarBackImage = value;\n    notifyListeners();\n  }\n\n  // ==========================================\n  // RC (REGISTRATION CERTIFICATE) FRONT AND BACK IMAGES\n  // ==========================================\n  FFUploadedFile? _rcFrontImage;\n  FFUploadedFile? get rcFrontImage => _rcFrontImage;\n  set rcFrontImage(FFUploadedFile? value) {\n    _rcFrontImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _rcBackImage;\n  FFUploadedFile? get rcBackImage => _rcBackImage;\n  set rcBackImage(FFUploadedFile? value) {\n    _rcBackImage = value;\n    notifyListeners();\n  }\n\n  // AADHAAR IMAGE URLs - stored in secure storage\n  String _aadharFrontImageUrl = '';\n  String get aadharFrontImageUrl => _aadharFrontImageUrl;\n  set aadharFrontImageUrl(String value) {\n    _aadharFrontImageUrl = value;\n    SecureStorageService.instance.write(SecureStorageService.keyAadharFrontImageUrl, value);\n    notifyListeners();\n  }\n\n  String _aadharBackImageUrl = '';\n  String get aadharBackImageUrl => _aadharBackImageUrl;\n  set aadharBackImageUrl(String value) {\n    _aadharBackImageUrl = value;\n    SecureStorageService.instance.write(SecureStorageService.keyAadharBackImageUrl, value);\n    notifyListeners();\n  }\n\n  // AADHAAR BASE64 - stored in secure storage\n  String _aadharFrontBase64 = '';\n  String get aadharFrontBase64 => _aadharFrontBase64;\n  set aadharFrontBase64(String value) {\n    _aadharFrontBase64 = value;\n    SecureStorageService.instance.write(SecureStorageService.keyAadharFrontBase64, value);\n    notifyListeners();\n  }\n\n  String _aadharBackBase64 = '';\n  String get aadharBackBase64 => _aadharBackBase64;\n  set aadharBackBase64(String value) {\n    _aadharBackBase64 = value;\n    SecureStorageService.instance.write(SecureStorageService.keyAadharBackBase64, value);\n    notifyListeners();\n  }\n\n  // AADHAAR NUMBER - stored in secure storage\n  String _aadharNumber = '';\n  String get aadharNumber => _aadharNumber;\n  set aadharNumber(String value) {\n    _aadharNumber = value;\n    SecureStorageService.instance.write(SecureStorageService.keyAadharNumber, value);\n    notifyListeners();\n  }\n\n// ==========================================\n// PAN CARD (temporary in-memory)\n// ==========================================\n  FFUploadedFile? _panImage;\n  FFUploadedFile? get panImage => _panImage;\n  set panImage(FFUploadedFile? value) {\n    _panImage = value;\n    notifyListeners();\n  }\n\n// PAN IMAGE URL - stored in secure storage\n  String _panImageUrl = '';\n  String get panImageUrl => _panImageUrl;\n  set panImageUrl(String value) {\n    _panImageUrl = value;\n    SecureStorageService.instance.write(SecureStorageService.keyPanImageUrl, value);\n    notifyListeners();\n  }\n\n// PAN BASE64 - stored in secure storage\n  String _panBase64 = '';\n  String get panBase64 => _panBase64;\n  set panBase64(String value) {\n    _panBase64 = value;\n    SecureStorageService.instance.write(SecureStorageService.keyPanBase64, value);\n    notifyListeners();\n  }\n\n// PAN NUMBER - stored in secure storage\n  String _panNumber = '';\n  String get panNumber => _panNumber;\n  set panNumber(String value) {\n    _panNumber = value;\n    SecureStorageService.instance.write(SecureStorageService.keyPanNumber, value);\n    notifyListeners();\n  }\n\n  // Vehicle Image\n  FFUploadedFile? _vehicleImage;\n  FFUploadedFile? get vehicleImage => _vehicleImage;\n  set vehicleImage(FFUploadedFile? value) {\n    _vehicleImage = value;\n    notifyListeners();\n  }\n\n// Vehicle Image URL\n  String _vehicleImageUrl = '';\n  String get vehicleImageUrl => _vehicleImageUrl;\n  set vehicleImageUrl(String value) {\n    _vehicleImageUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleImageUrl');\n    } else {\n      prefs.setString('ff_vehicleImageUrl', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Base64\n  String _vehicleBase64 = '';\n  String get vehicleBase64 => _vehicleBase64;\n  set vehicleBase64(String value) {\n    _vehicleBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleBase64');\n    } else {\n      prefs.setString('ff_vehicleBase64', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Type\n  String _vehicleType = '';\n  String get vehicleType => _vehicleType;\n  set vehicleType(String value) {\n    _vehicleType = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleType');\n    } else {\n      prefs.setString('ff_vehicleType', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Make\n  String _vehicleMake = '';\n  String get vehicleMake => _vehicleMake;\n  set vehicleMake(String value) {\n    _vehicleMake = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleMake');\n    } else {\n      prefs.setString('ff_vehicleMake', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Model\n  String _vehicleModel = '';\n  String get vehicleModel => _vehicleModel;\n  set vehicleModel(String value) {\n    _vehicleModel = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleModel');\n    } else {\n      prefs.setString('ff_vehicleModel', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Color\n  String _vehicleColor = '';\n  String get vehicleColor => _vehicleColor;\n  set vehicleColor(String value) {\n    _vehicleColor = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleColor');\n    } else {\n      prefs.setString('ff_vehicleColor', value);\n    }\n    notifyListeners();\n  }\n\n// ==========================================\n// PROFILE PHOTO URL (persistent - from server)\n// ==========================================\n  String _profilePhotoUrl = '';\n  String get profilePhotoUrl => _profilePhotoUrl;\n  set profilePhotoUrl(String value) {\n    _profilePhotoUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_profilePhotoUrl');\n    } else {\n      prefs.setString('ff_profilePhotoUrl', value);\n    }\n    notifyListeners();\n  }\n\n// License URLs\n  String _licenseFrontImageUrl = '';\n  String get licenseFrontImageUrl => _licenseFrontImageUrl;\n  set licenseFrontImageUrl(String value) {\n    _licenseFrontImageUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseFrontImageUrl');\n    } else {\n      prefs.setString('ff_licenseFrontImageUrl', value);\n    }\n    notifyListeners();\n  }\n\n  String _licenseBackImageUrl = '';\n  String get licenseBackImageUrl => _licenseBackImageUrl;\n  set licenseBackImageUrl(String value) {\n    _licenseBackImageUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseBackImageUrl');\n    } else {\n      prefs.setString('ff_licenseBackImageUrl', value);\n    }\n    notifyListeners();\n  }\n\n// License Base64\n  String _licenseFrontBase64 = '';\n  String get licenseFrontBase64 => _licenseFrontBase64;\n  set licenseFrontBase64(String value) {\n    _licenseFrontBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseFrontBase64');\n    } else {\n      prefs.setString('ff_licenseFrontBase64', value);\n    }\n    notifyListeners();\n  }\n\n  String _licenseBackBase64 = '';\n  String get licenseBackBase64 => _licenseBackBase64;\n  set licenseBackBase64(String value) {\n    _licenseBackBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseBackBase64');\n    } else {\n      prefs.setString('ff_licenseBackBase64', value);\n    }\n    notifyListeners();\n  }\n\n// License Number\n  String _licenseNumber = '';\n  String get licenseNumber => _licenseNumber;\n  set licenseNumber(String value) {\n    _licenseNumber = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseNumber');\n    } else {\n      prefs.setString('ff_licenseNumber', value);\n    }\n    notifyListeners();\n  }\n\n// License Expiry Date (YYYY-MM-DD or DD/MM/YYYY)\n  String _licenseExpiryDate = '';\n  String get licenseExpiryDate => _licenseExpiryDate;\n  set licenseExpiryDate(String value) {\n    _licenseExpiryDate = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_licenseExpiryDate');\n    } else {\n      prefs.setString('ff_licenseExpiryDate', value);\n    }\n    notifyListeners();\n  }\n\n// RC Front URL\n  String _rcFrontImageUrl = '';\n  String get rcFrontImageUrl => _rcFrontImageUrl;\n  set rcFrontImageUrl(String value) {\n    _rcFrontImageUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_rcFrontImageUrl');\n    } else {\n      prefs.setString('ff_rcFrontImageUrl', value);\n    }\n    notifyListeners();\n  }\n\n// RC Back URL (NEW)\n  String _rcBackImageUrl = '';\n  String get rcBackImageUrl => _rcBackImageUrl;\n  set rcBackImageUrl(String value) {\n    _rcBackImageUrl = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_rcBackImageUrl');\n    } else {\n      prefs.setString('ff_rcBackImageUrl', value);\n    }\n    notifyListeners();\n  }\n\n// RC Front Base64\n  String _rcFrontBase64 = '';\n  String get rcFrontBase64 => _rcFrontBase64;\n  set rcFrontBase64(String value) {\n    _rcFrontBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_rcFrontBase64');\n    } else {\n      prefs.setString('ff_rcFrontBase64', value);\n    }\n    notifyListeners();\n  }\n\n// RC Back Base64 (NEW)\n  String _rcBackBase64 = '';\n  String get rcBackBase64 => _rcBackBase64;\n  set rcBackBase64(String value) {\n    _rcBackBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_rcBackBase64');\n    } else {\n      prefs.setString('ff_rcBackBase64', value);\n    }\n    notifyListeners();\n  }\n\n// Registration Number (existing)\n  String _registrationNumber = '';\n  String get registrationNumber => _registrationNumber;\n  set registrationNumber(String value) {\n    _registrationNumber = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_registrationNumber');\n    } else {\n      prefs.setString('ff_registrationNumber', value);\n    }\n    notifyListeners();\n  }\n\n// Vehicle Year (NEW)\n  String _vehicleYear = '';\n  String get vehicleYear => _vehicleYear;\n  set vehicleYear(String value) {\n    _vehicleYear = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_vehicleYear');\n    } else {\n      prefs.setString('ff_vehicleYear', value);\n    }\n    notifyListeners();\n  }\n\n// ==========================================\n// PROFILE PHOTO BASE64 (temporary persistence)\n// ==========================================\n  String _profilePhotoBase64 = '';\n  String get profilePhotoBase64 => _profilePhotoBase64;\n  set profilePhotoBase64(String value) {\n    _profilePhotoBase64 = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_profilePhotoBase64');\n    } else {\n      prefs.setString('ff_profilePhotoBase64', value);\n    }\n    notifyListeners();\n  }\n\n  FFUploadedFile? _profilePhoto;\n  FFUploadedFile? get profilePhoto => _profilePhoto;\n  set profilePhoto(FFUploadedFile? value) {\n    _profilePhoto = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _registrationImage;\n  FFUploadedFile? get registrationImage => _registrationImage;\n  set registrationImage(FFUploadedFile? value) {\n    _registrationImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _insuranceImage;\n  FFUploadedFile? get insuranceImage => _insuranceImage;\n  set insuranceImage(FFUploadedFile? value) {\n    _insuranceImage = value;\n    notifyListeners();\n  }\n\n  FFUploadedFile? _pollutioncertificateImage;\n  FFUploadedFile? get pollutioncertificateImage => _pollutioncertificateImage;\n  set pollutioncertificateImage(FFUploadedFile? value) {\n    _pollutioncertificateImage = value;\n    notifyListeners();\n  }\n\n  int _driverid = 0;\n  int get driverid => _driverid;\n\n  set driverid(int value) {\n    _driverid = value;\n    prefs.setInt('ff_driverid', value);\n  }\n\n  bool _isonline = false;\n  bool get isonline => _isonline;\n\n  set isonline(bool value) {\n    _isonline = value;\n    prefs.setBool('ff_isonline', value);\n    notifyListeners();\n  }\n\n  String _accessToken = '';\n  String get accessToken => _accessToken;\n\n  set accessToken(String value) {\n    _accessToken = value;\n    if (value.isEmpty) {\n      prefs.remove('ff_accessToken');\n    } else {\n      prefs.setString('ff_accessToken', value);\n    }\n    notifyListeners();\n  }\n\n  String _kycStatus = '';\n  String get kycStatus => _kycStatus;\n\n  set kycStatus(String value) {\n    final cleanValue = value.trim().toLowerCase() == 'null' ? '' : value.trim();\n\n    _kycStatus = cleanValue;\n\n    if (cleanValue.isEmpty) {\n      prefs.remove('ff_kycStatus');\n    } else {\n      prefs.setString('ff_kycStatus', cleanValue);\n    }\n\n    notifyListeners();\n  }\n\n  String _qrImage = '';\n  String get qrImage => _qrImage;\n  set qrImage(String value) {\n    _qrImage = value;\n    prefs.setString('ff_qrImage', value);\n    notifyListeners();\n  }\n  \n  Future<void> clearAppState() async {\n  await prefs.clear();\n\n  // Auth\n  _accessToken = '';\n  _driverid = 0;\n  _isLoggedIn = false;\n  _isRegistered = false;\n\n  // Basic info\n  _mobileNo = 0;\n  _firstName = '';\n  _lastName = '';\n  _email = '';\n  _referralCode = '';\n\n  // Ride\n  _activeRideId = 0;\n  _activeRideStatus = '';\n  _kycStatus = '';\n  _isonline = false;\n\n  // \uD83D\uDD25 Profile\n  _profilePhotoUrl = '';\n  _profilePhotoBase64 = '';\n  _profilePhoto = null;\n\n  // \uD83D\uDD25 PAN\n  _panImageUrl = '';\n  _panBase64 = '';\n  _panNumber = '';\n  _panImage = null;\n\n  // \uD83D\uDD25 Aadhar\n  _aadharFrontImageUrl = '';\n  _aadharBackImageUrl = '';\n  _aadharFrontBase64 = '';\n  _aadharBackBase64 = '';\n  _aadharNumber = '';\n  _aadharBackImage = null;\n\n  // Clear secure storage for Aadhaar/PAN\n  final sec = SecureStorageService.instance;\n  await sec.delete(SecureStorageService.keyAadharNumber);\n  await sec.delete(SecureStorageService.keyAadharFrontImageUrl);\n  await sec.delete(SecureStorageService.keyAadharBackImageUrl);\n  await sec.delete(SecureStorageService.keyAadharFrontBase64);\n  await sec.delete(SecureStorageService.keyAadharBackBase64);\n  await sec.delete(SecureStorageService.keyPanImageUrl);\n  await sec.delete(SecureStorageService.keyPanBase64);\n  await sec.delete(SecureStorageService.keyPanNumber);\n\n  // \uD83D\uDD25 License\n  _licenseFrontImageUrl = '';\n  _licenseBackImageUrl = '';\n  _licenseFrontBase64 = '';\n  _licenseBackBase64 = '';\n  _licenseFrontImage = null;\n  _licenseBackImage = null;\n\n  // \uD83D\uDD25 Vehicle / RC\n  _vehicleImageUrl = '';\n  // _vehicleImageBase64 = '';\n  _vehicleImage = null;\n\n  _rcFrontImageUrl = '';\n  _rcBackImageUrl = '';\n  _rcFrontBase64 = '';\n  _rcBackBase64 = '';\n  _rcFrontImage = null;\n  _rcBackImage = null;\n\n  notifyListeners();\n}\n\n\n}\n\nvoid _safeInit(Function() initializeField) {\n  try {\n    initializeField();\n  } catch (_) {}\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/app_state.dart b/lib/app_state.dart
--- a/lib/app_state.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/app_state.dart	(date 1771594620204)
@@ -169,6 +169,30 @@
     _safeInit(() {
       _vehicleColor = prefs.getString('ff_vehicleColor') ?? '';
     });
+    _safeInit(() {
+      _vehicleName = prefs.getString('ff_vehicleName') ?? '';
+    });
+    _safeInit(() {
+      _licensePlate = prefs.getString('ff_licensePlate') ?? '';
+    });
+    _safeInit(() {
+      _registrationDate = prefs.getString('ff_registrationDate') ?? '';
+    });
+    _safeInit(() {
+      _insuranceNumber = prefs.getString('ff_insuranceNumber') ?? '';
+    });
+    _safeInit(() {
+      _insuranceExpiryDate = prefs.getString('ff_insuranceExpiryDate') ?? '';
+    });
+    _safeInit(() {
+      _pollutionExpiryDate = prefs.getString('ff_pollutionExpiryDate') ?? '';
+    });
+    _safeInit(() {
+      _insuranceBase64 = prefs.getString('ff_insuranceBase64') ?? '';
+    });
+    _safeInit(() {
+      _pollutionBase64 = prefs.getString('ff_pollutionBase64') ?? '';
+    });
   }
 
   Future<void> _loadAadharPanFromSecureStorage() async {
@@ -446,6 +470,14 @@
     _adminVehicleId = value;
     notifyListeners();
   }
+
+  /// Created vehicle record ID from signup response (data.vehicle.id)
+  int _vehicleId = 0;
+  int get vehicleId => _vehicleId;
+  set vehicleId(int value) {
+    _vehicleId = value;
+    notifyListeners();
+  }
 
   // ==========================================
   // DRIVING LICENSE IMAGE
@@ -847,16 +879,73 @@
     notifyListeners();
   }
 
-// Vehicle Year (NEW)
+// Vehicle Year
   String _vehicleYear = '';
   String get vehicleYear => _vehicleYear;
   set vehicleYear(String value) {
     _vehicleYear = value;
-    if (value.isEmpty) {
-      prefs.remove('ff_vehicleYear');
-    } else {
-      prefs.setString('ff_vehicleYear', value);
-    }
+    if (value.isEmpty) prefs.remove('ff_vehicleYear');
+    else prefs.setString('ff_vehicleYear', value);
+    notifyListeners();
+  }
+
+// Vehicle Name (vehicles.vehicle_name)
+  String _vehicleName = '';
+  String get vehicleName => _vehicleName;
+  set vehicleName(String value) {
+    _vehicleName = value;
+    if (value.isEmpty) prefs.remove('ff_vehicleName');
+    else prefs.setString('ff_vehicleName', value);
+    notifyListeners();
+  }
+
+// License Plate (vehicles.license_plate)
+  String _licensePlate = '';
+  String get licensePlate => _licensePlate;
+  set licensePlate(String value) {
+    _licensePlate = value;
+    if (value.isEmpty) prefs.remove('ff_licensePlate');
+    else prefs.setString('ff_licensePlate', value);
+    notifyListeners();
+  }
+
+// Registration Date (vehicles.registration_date)
+  String _registrationDate = '';
+  String get registrationDate => _registrationDate;
+  set registrationDate(String value) {
+    _registrationDate = value;
+    if (value.isEmpty) prefs.remove('ff_registrationDate');
+    else prefs.setString('ff_registrationDate', value);
+    notifyListeners();
+  }
+
+// Insurance Number (vehicles.insurance_number)
+  String _insuranceNumber = '';
+  String get insuranceNumber => _insuranceNumber;
+  set insuranceNumber(String value) {
+    _insuranceNumber = value;
+    if (value.isEmpty) prefs.remove('ff_insuranceNumber');
+    else prefs.setString('ff_insuranceNumber', value);
+    notifyListeners();
+  }
+
+// Insurance Expiry Date (vehicles.insurance_expiry_date)
+  String _insuranceExpiryDate = '';
+  String get insuranceExpiryDate => _insuranceExpiryDate;
+  set insuranceExpiryDate(String value) {
+    _insuranceExpiryDate = value;
+    if (value.isEmpty) prefs.remove('ff_insuranceExpiryDate');
+    else prefs.setString('ff_insuranceExpiryDate', value);
+    notifyListeners();
+  }
+
+// Pollution Expiry Date (vehicles.pollution_expiry_date)
+  String _pollutionExpiryDate = '';
+  String get pollutionExpiryDate => _pollutionExpiryDate;
+  set pollutionExpiryDate(String value) {
+    _pollutionExpiryDate = value;
+    if (value.isEmpty) prefs.remove('ff_pollutionExpiryDate');
+    else prefs.setString('ff_pollutionExpiryDate', value);
     notifyListeners();
   }
 
@@ -895,6 +984,15 @@
     _insuranceImage = value;
     notifyListeners();
   }
+
+  String _insuranceBase64 = '';
+  String get insuranceBase64 => _insuranceBase64;
+  set insuranceBase64(String value) {
+    _insuranceBase64 = value;
+    if (value.isEmpty) prefs.remove('ff_insuranceBase64');
+    else prefs.setString('ff_insuranceBase64', value);
+    notifyListeners();
+  }
 
   FFUploadedFile? _pollutioncertificateImage;
   FFUploadedFile? get pollutioncertificateImage => _pollutioncertificateImage;
@@ -903,6 +1001,21 @@
     notifyListeners();
   }
 
+  FFUploadedFile? get pollutionImage => _pollutioncertificateImage;
+  set pollutionImage(FFUploadedFile? value) {
+    _pollutioncertificateImage = value;
+    notifyListeners();
+  }
+
+  String _pollutionBase64 = '';
+  String get pollutionBase64 => _pollutionBase64;
+  set pollutionBase64(String value) {
+    _pollutionBase64 = value;
+    if (value.isEmpty) prefs.remove('ff_pollutionBase64');
+    else prefs.setString('ff_pollutionBase64', value);
+    notifyListeners();
+  }
+
   int _driverid = 0;
   int get driverid => _driverid;
 
@@ -1020,8 +1133,13 @@
 
   // ðŸ”¥ Vehicle / RC
   _vehicleImageUrl = '';
-  // _vehicleImageBase64 = '';
   _vehicleImage = null;
+  _vehicleName = '';
+  _licensePlate = '';
+  _registrationDate = '';
+  _insuranceNumber = '';
+  _insuranceExpiryDate = '';
+  _pollutionExpiryDate = '';
 
   _rcFrontImageUrl = '';
   _rcBackImageUrl = '';
@@ -1029,6 +1147,8 @@
   _rcBackBase64 = '';
   _rcFrontImage = null;
   _rcBackImage = null;
+  _insuranceBase64 = '';
+  _pollutionBase64 = '';
 
   notifyListeners();
 }
Index: lib/account_support/documents.dart
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\nimport '/backend/api_requests/api_calls.dart';\nimport '/flutter_flow/flutter_flow_util.dart';\nimport '/index.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart'; // âœ… Required for HapticFeedback\nimport 'package:google_fonts/google_fonts.dart';\nimport 'package:provider/provider.dart';\n\nclass DocumentsScreen extends StatefulWidget {\n  const DocumentsScreen({super.key});\n\n  static String routeName = 'documents_screen';\n  static String routePath = '/documentsScreen';\n\n  @override\n  State<DocumentsScreen> createState() => _DocumentsScreenState();\n}\n\nclass _DocumentsScreenState extends State<DocumentsScreen> {\n  final scaffoldKey = GlobalKey<ScaffoldState>();\n  bool _isLoading = false;\n  bool _isFetchingDocuments = true;\n\n  // Track which documents are already uploaded on server\n  final Map<String, bool> _serverDocuments = {\n    'profilePhoto': false,\n    'imageLicense': false,\n    'aadharImage': false,\n    'panImage': false,\n    'vehicleImage': false,\n    'registrationImage': false,\n  };\n\n  @override\n  void initState() {\n    super.initState();\n    _fetchExistingDocuments();\n  }\n\n  @override\n  void dispose() {\n    super.dispose();\n  }\n\n  /// 1. Fetch existing documents from server using DriverIdfetchCall\n  Future<void> _fetchExistingDocuments() async {\n    setState(() => _isFetchingDocuments = true);\n\n    try {\n      final driverId = FFAppState().driverid;\n      final token = FFAppState().accessToken;\n\n      if (driverId == 0 || token.isEmpty) {\n        setState(() => _isFetchingDocuments = false);\n        return;\n      }\n\n      // âœ… API CALL: Get Driver Details\n      final response = await DriverIdfetchCall.call(\n        id: driverId,\n        token: token,\n      );\n\n      if (response.succeeded) {\n        final data = getJsonField(response.jsonBody, r'''$.data''');\n\n        if (data != null) {\n          // Helper to check if string is valid\n          bool hasDoc(dynamic path) =>\n              path != null &&\n                  path.toString().isNotEmpty &&\n                  path.toString() != 'null';\n\n          setState(() {\n            _serverDocuments['profilePhoto'] = hasDoc(data['profile_image']);\n            _serverDocuments['imageLicense'] = hasDoc(data['license_image']) ||\n                hasDoc(data['license_front_image']) ||\n                hasDoc(data['license_back_image']);\n            _serverDocuments['aadharImage'] = hasDoc(data['aadhaar_image']) ||\n                hasDoc(data['aadhaar_front_image']) ||\n                hasDoc(data['aadhaar_back_image']);\n            _serverDocuments['panImage'] = hasDoc(data['pan_image']);\n            _serverDocuments['vehicleImage'] = hasDoc(data['vehicle_image']);\n            _serverDocuments['registrationImage'] = hasDoc(data['rc_image']) ||\n                hasDoc(data['rc_front_image']) ||\n                hasDoc(data['rc_back_image']);\n          });\n\n        }\n      } else {\n      }\n    } finally {\n      if (mounted) setState(() => _isFetchingDocuments = false);\n    }\n  }\n\n  /// Helper to get local state doc (Newly picked files)\n  dynamic _getLocalDoc(String key) {\n    switch (key) {\n      case 'profilePhoto':\n        return FFAppState().profilePhoto;\n      case 'imageLicense':\n        return FFAppState().imageLicense;\n      case 'aadharImage':\n        return FFAppState().aadharImage;\n      case 'panImage':\n        return FFAppState().panImage;\n      case 'vehicleImage':\n        return FFAppState().vehicleImage;\n      case 'registrationImage':\n        return FFAppState().registrationImage;\n      default:\n        return null;\n    }\n  }\n\n  bool _hasNewDocuments() {\n    return _serverDocuments.keys.any((key) => _getLocalDoc(key) != null);\n  }\n\n  /// 2. Handle Update (Upload new files)\n  Future<void> _handleUpdateDocuments() async {\n    HapticFeedback.mediumImpact(); // âœ… Vibrate on tap\n\n    if (_isLoading) return;\n\n    if (!_hasNewDocuments()) {\n      _showSnack('Please upload at least one new document to update.',\n          isError: true);\n      return;\n    }\n\n    setState(() => _isLoading = true);\n\n    try {\n      final driverId = FFAppState().driverid;\n      final token = FFAppState().accessToken;\n\n      final apiResult = await UpdateDriverCall.call(\n        id: driverId,\n        token: token,\n        profileimage: FFAppState().profilePhoto,\n        licenseimage: FFAppState().imageLicense,\n        aadhaarimage: FFAppState().aadharImage,\n        panimage: FFAppState().panImage,\n        vehicleImage: FFAppState().vehicleImage,\n        registrationImage: FFAppState().registrationImage,\n      );\n\n      if ((apiResult.succeeded) || apiResult.statusCode == 200) {\n        // Success Logic\n        setState(() {\n          // Mark locally uploaded docs as \"On Server\" now\n          for (var key in _serverDocuments.keys) {\n            if (_getLocalDoc(key) != null) _serverDocuments[key] = true;\n          }\n        });\n\n        // Clear local state\n        FFAppState().update(() {\n          FFAppState().profilePhoto = null;\n          FFAppState().imageLicense = null;\n          FFAppState().aadharImage = null;\n          FFAppState().panImage = null;\n          FFAppState().vehicleImage = null;\n          FFAppState().registrationImage = null;\n        });\n\n        _showSnack('âœ“ Documents updated successfully!', isError: false);\n        await Future.delayed(const Duration(milliseconds: 1000));\n        if (mounted) context.pushReplacementNamed(HomeWidget.routeName);\n      } else {\n        // Error Logic\n        String msg =\n            getJsonField(apiResult.jsonBody, r'''$.message''')?.toString() ??\n                'Update failed';\n        _showSnack(msg, isError: true);\n      }\n    } catch (e) {\n      _showSnack('An error occurred. Please try again.', isError: true);\n    } finally {\n      if (mounted) setState(() => _isLoading = false);\n    }\n  }\n\n  void _showSnack(String msg, {bool isError = false}) {\n    HapticFeedback.lightImpact();\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(\n        content: Text(msg, style: const TextStyle(color: Colors.white)),\n        backgroundColor: isError ? Colors.red : Colors.green,\n        behavior: SnackBarBehavior.floating,\n        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(10)),\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    context.watch<FFAppState>();\n\n    // \uD83C\uDFA8 APP COLORS\n    const Color brandPrimary = AppColors.primary;\n    const Color brandGradientStart = AppColors.primaryGradientStart;\n    const Color bgOffWhite = AppColors.backgroundAlt;\n\n    return GestureDetector(\n      onTap: () => FocusScope.of(context).unfocus(),\n      child: Scaffold(\n        key: scaffoldKey,\n        backgroundColor: bgOffWhite,\n        body: Stack(\n          children: [\n            // 1\uFE0Fâƒ£ Header Background\n            Column(\n              children: [\n                Container(\n                  height: 240,\n                  width: double.infinity,\n                  decoration: const BoxDecoration(\n                    gradient: LinearGradient(\n                      colors: [brandGradientStart, brandPrimary],\n                      begin: Alignment.topLeft,\n                      end: Alignment.bottomRight,\n                    ),\n                    borderRadius: BorderRadius.only(\n                      bottomLeft: Radius.circular(30),\n                      bottomRight: Radius.circular(30),\n                    ),\n                  ),\n                  child: SafeArea(\n                    child: Padding(\n                      padding: const EdgeInsets.symmetric(horizontal: 24.0),\n                      child: Column(\n                        crossAxisAlignment: CrossAxisAlignment.start,\n                        children: [\n                          const SizedBox(height: 16),\n\n                          // Back Button Row\n                          Row(\n                            children: [\n                              InkWell(\n                                onTap: () {\n                                  HapticFeedback.lightImpact();\n                                  context.pop();\n                                },\n                                child: Container(\n                                  padding: const EdgeInsets.all(8),\n                                  decoration: BoxDecoration(\n                                    color: Colors.white.withValues(alpha:0.2),\n                                    borderRadius: BorderRadius.circular(12),\n                                  ),\n                                  child: const Icon(Icons.arrow_back,\n                                      color: Colors.white),\n                                ),\n                              ),\n                              const SizedBox(width: 16),\n                              const Text(\n                                'Manage Documents',\n                                style: TextStyle(\n                                  fontSize: 20,\n                                  color: Colors.white,\n                                  fontWeight: FontWeight.w600,\n                                ),\n                              ),\n                            ],\n                          ),\n\n                          const SizedBox(height: 40),\n                          const Center(\n                            child: Text(\n                              'Update your Proofs here.',\n                              style: TextStyle(\n                                fontSize: 28,\n                                color: Colors.white,\n                                fontWeight: FontWeight.bold,\n                                height: 1.1,\n                              ),\n                            ),\n                          ),\n                          const Spacer(),\n\n                        ],\n                      ),\n                    ),\n                  ),\n                ),\n                Expanded(child: Container()),\n              ],\n            ),\n\n            // 2\uFE0Fâƒ£ Floating List\n            Positioned.fill(\n              top: 180,\n              child: _isFetchingDocuments\n                  ? const Center(\n                  child: CircularProgressIndicator(color: brandPrimary))\n                  : SingleChildScrollView(\n                padding: const EdgeInsets.fromLTRB(16, 0, 16, 24),\n                child: Container(\n                  padding: const EdgeInsets.all(20),\n                  decoration: BoxDecoration(\n                    color: Colors.white,\n                    borderRadius: BorderRadius.circular(24),\n                    boxShadow: [\n                      BoxShadow(\n                        color: Colors.black.withValues(alpha:0.05),\n                        blurRadius: 15,\n                        offset: const Offset(0, 5),\n                      )\n                    ],\n                  ),\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      _buildSectionHeader('Personal Documents'),\n                      const SizedBox(height: 16),\n\n                      _buildStepItem(\n                        'Profile Photo',\n                        'profilePhoto',\n                            () => context\n                            .pushNamed(FaceVerifyupdateWidget.routeName),\n                      ),\n                      const SizedBox(height: 12),\n                      _buildStepItem(\n                        'Driving License',\n                        'imageLicense',\n                            () => context\n                            .pushNamed(DrivingDlUpdateWidget.routeName),\n                      ),\n                      const SizedBox(height: 12),\n                      _buildStepItem(\n                        'Aadhaar Card',\n                        'aadharImage',\n                            () => context\n                            .pushNamed(AdharUploadUpdateWidget.routeName),\n                      ),\n                      const SizedBox(height: 12),\n                      _buildStepItem(\n                        'PAN Card',\n                        'panImage',\n                            () => context\n                            .pushNamed(PanuploadScreenUpdateWidget.routeName),\n                      ),\n\n                      const SizedBox(height: 24),\n                      Divider(color: Colors.grey.shade100, thickness: 2),\n                      const SizedBox(height: 24),\n\n                      _buildSectionHeader('Vehicle Documents'),\n                      const SizedBox(height: 16),\n\n                      _buildStepItem(\n                        'Vehicle Photo',\n                        'vehicleImage',\n                            () => context\n                            .pushNamed(VehicleImageUpdateWidget.routeName),\n                      ),\n                      const SizedBox(height: 12),\n                      _buildStepItem(\n                        'RC Book',\n                        'registrationImage',\n                            () => context\n                            .pushNamed(RegistrationUpdateWidget.routeName),\n                      ),\n\n                      const SizedBox(height: 32),\n\n                      // Submit Button\n                      SizedBox(\n                        width: double.infinity,\n                        height: 56,\n                        child: ElevatedButton(\n                          onPressed:\n                          _isLoading ? null : _handleUpdateDocuments,\n                          style: ElevatedButton.styleFrom(\n                            backgroundColor: brandPrimary,\n                            foregroundColor: Colors.white,\n                            elevation: 4,\n                            shape: RoundedRectangleBorder(\n                              borderRadius: BorderRadius.circular(16),\n                            ),\n                            disabledBackgroundColor:\n                            brandPrimary.withValues(alpha:0.6),\n                          ),\n                          child: _isLoading\n                              ? const SizedBox(\n                            height: 24,\n                            width: 24,\n                            child: CircularProgressIndicator(\n                                color: Colors.white,\n                                strokeWidth: 2.5),\n                          )\n                              : const Text(\n                            'Update Documents',\n                            style: TextStyle(\n                              fontSize: 18,\n                              fontWeight: FontWeight.bold,\n                              letterSpacing: 0.5,\n                            ),\n                          ),\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildSectionHeader(String title) {\n    return Text(\n      title,\n      style: GoogleFonts.inter(\n        fontSize: 14,\n        fontWeight: FontWeight.w600,\n        color: Colors.grey[500],\n        letterSpacing: 1.0,\n      ),\n    );\n  }\n\n  Widget _buildStepItem(String title, String key, VoidCallback onTap) {\n    // 1. Is New Local File?\n    bool isLocal = _getLocalDoc(key) != null;\n    // 2. Is On Server?\n    bool isServer = _serverDocuments[key] ?? false;\n\n    // Define Visuals\n    Color bgColor = AppColors.backgroundCard;\n    Color borderColor = AppColors.divider;\n    Color iconColor = Colors.grey.shade400;\n    IconData icon = Icons.upload_file_rounded;\n    String statusText = 'Tap to upload';\n    Color textColor = Colors.grey.shade500;\n\n    if (isLocal) {\n      bgColor = AppColors.sectionOrangeTint;\n      borderColor = AppColors.primary.withValues(alpha:0.5);\n      iconColor = AppColors.primary;\n      icon = Icons.cloud_upload_rounded;\n      statusText = 'Ready to Update';\n      textColor = AppColors.primary;\n    } else if (isServer) {\n      bgColor = AppColors.sectionGreenTint;\n      borderColor = AppColors.accentEmerald.withValues(alpha:0.5);\n      iconColor = AppColors.accentEmerald;\n      icon = Icons.check_circle_rounded;\n      statusText = 'Uploaded';\n      textColor = AppColors.accentEmerald;\n    }\n\n    return InkWell(\n      onTap: () {\n        HapticFeedback.selectionClick(); // âœ… Vibrate on item tap\n        onTap();\n      },\n      borderRadius: BorderRadius.circular(12),\n      child: Container(\n        padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),\n        decoration: BoxDecoration(\n          color: bgColor,\n          borderRadius: BorderRadius.circular(12),\n          border: Border.all(color: borderColor),\n        ),\n        child: Row(\n          children: [\n            Container(\n              padding: const EdgeInsets.all(8),\n              decoration: BoxDecoration(\n                color: Colors.white,\n                borderRadius: BorderRadius.circular(8),\n              ),\n              child: Icon(icon, color: iconColor, size: 24),\n            ),\n            const SizedBox(width: 16),\n            Expanded(\n              child: Column(\n                crossAxisAlignment: CrossAxisAlignment.start,\n                children: [\n                  Text(\n                    title,\n                    style: const TextStyle(\n                      fontSize: 16,\n                      fontWeight: FontWeight.w600,\n                      color: Colors.black87,\n                    ),\n                  ),\n                  const SizedBox(height: 2),\n                  Text(\n                    statusText,\n                    style: TextStyle(\n                      fontSize: 12,\n                      fontWeight: FontWeight.w500,\n                      color: textColor,\n                    ),\n                  ),\n                ],\n              ),\n            ),\n            Icon(Icons.chevron_right, color: Colors.grey.shade400),\n          ],\n        ),\n      ),\n    );\n  }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/account_support/documents.dart b/lib/account_support/documents.dart
--- a/lib/account_support/documents.dart	(revision 193a0cf807e454887b92c8ca71b23a28a1c31dd0)
+++ b/lib/account_support/documents.dart	(date 1771596682542)
@@ -146,6 +146,18 @@
         panimage: FFAppState().panImage,
         vehicleImage: FFAppState().vehicleImage,
         registrationImage: FFAppState().registrationImage,
+        insuranceImage: FFAppState().insuranceImage,
+        pollutionCertificateImage: FFAppState().pollutioncertificateImage,
+        vehicleName: FFAppState().vehicleMake,
+        vehicleModel: FFAppState().vehicleModel,
+        vehicleColor: FFAppState().vehicleColor.isNotEmpty ? FFAppState().vehicleColor : null,
+        licensePlate: FFAppState().licensePlate.isNotEmpty ? FFAppState().licensePlate : null,
+        registrationNumber: FFAppState().registrationNumber.isNotEmpty ? FFAppState().registrationNumber : null,
+        registrationDate: FFAppState().registrationDate.isNotEmpty ? FFAppState().registrationDate : null,
+        insuranceNumber: FFAppState().insuranceNumber.isNotEmpty ? FFAppState().insuranceNumber : null,
+        insuranceExpiryDate: FFAppState().insuranceExpiryDate.isNotEmpty ? FFAppState().insuranceExpiryDate : null,
+        pollutionExpiryDate: FFAppState().pollutionExpiryDate.isNotEmpty ? FFAppState().pollutionExpiryDate : null,
+        vehicleTypeId: FFAppState().adminVehicleId > 0 ? FFAppState().adminVehicleId : null,
       );
 
       if ((apiResult.succeeded) || apiResult.statusCode == 200) {
